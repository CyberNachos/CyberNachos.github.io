<!DOCTYPE html><html><head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Distilling GPT with PyTorch and Transformers - Cyber Nachos</title>
<style>*,:after,:before{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }::backdrop{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:rgba(59,130,246,.5);--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: ;--tw-contain-size: ;--tw-contain-layout: ;--tw-contain-paint: ;--tw-contain-style: }/*! tailwindcss v3.4.17 | MIT License | https://tailwindcss.com*/*,:after,:before{border:0 solid #e5e7eb;box-sizing:border-box}:after,:before{--tw-content:""}:host,html{line-height:1.5;-webkit-text-size-adjust:100%;font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;font-feature-settings:normal;font-variation-settings:normal;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-tap-highlight-color:transparent}body{line-height:inherit;margin:0}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-feature-settings:normal;font-size:1em;font-variation-settings:normal}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}button,input,optgroup,select,textarea{color:inherit;font-family:inherit;font-feature-settings:inherit;font-size:100%;font-variation-settings:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;margin:0;padding:0}button,select{text-transform:none}button,input:where([type=button]),input:where([type=reset]),input:where([type=submit]){-webkit-appearance:button;background-color:transparent;background-image:none}:-moz-focusring{outline:auto}:-moz-ui-invalid{box-shadow:none}progress{vertical-align:baseline}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}summary{display:list-item}blockquote,dd,dl,figure,h1,h2,h3,h4,h5,h6,hr,p,pre{margin:0}fieldset{margin:0}fieldset,legend{padding:0}menu,ol,ul{list-style:none;margin:0;padding:0}dialog{padding:0}textarea{resize:vertical}input::-moz-placeholder,textarea::-moz-placeholder{color:#9ca3af;opacity:1}input::placeholder,textarea::placeholder{color:#9ca3af;opacity:1}[role=button],button{cursor:pointer}:disabled{cursor:default}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}[hidden]:where(:not([hidden=until-found])){display:none}:root{--background:0 0% 100%;--foreground:222.2 84% 4.9%;--card:0 0% 100%;--card-foreground:222.2 84% 4.9%;--popover:0 0% 100%;--popover-foreground:222.2 84% 4.9%;--primary:221.2 83.2% 53.3%;--primary-foreground:210 40% 98%;--secondary:210 40% 96.1%;--secondary-foreground:222.2 47.4% 11.2%;--muted:210 40% 96.1%;--muted-foreground:215.4 16.3% 46.9%;--accent:210 40% 96.1%;--accent-foreground:222.2 47.4% 11.2%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 40% 98%;--border:214.3 31.8% 91.4%;--input:214.3 31.8% 91.4%;--ring:221.2 83.2% 53.3%;--radius:.5rem}.dark{--background:222.2 84% 4.9%;--foreground:210 40% 98%;--card:222.2 84% 4.9%;--card-foreground:210 40% 98%;--popover:222.2 84% 4.9%;--popover-foreground:210 40% 98%;--primary:217.2 91.2% 59.8%;--primary-foreground:222.2 47.4% 11.2%;--secondary:217.2 32.6% 17.5%;--secondary-foreground:210 40% 98%;--muted:217.2 32.6% 17.5%;--muted-foreground:215 20.2% 65.1%;--accent:217.2 32.6% 17.5%;--accent-foreground:210 40% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:210 40% 98%;--border:217.2 32.6% 17.5%;--input:217.2 32.6% 17.5%;--ring:224.3 76.3% 48%}*{border-color:hsl(var(--border))}body{background-color:hsl(var(--background));color:hsl(var(--foreground))}.container{margin-left:auto;margin-right:auto;padding-left:2rem;padding-right:2rem;width:100%}@media (min-width:1400px){.container{max-width:1400px}}.sr-only{height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px;clip:rect(0,0,0,0);border-width:0;white-space:nowrap}.pointer-events-none{pointer-events:none}.pointer-events-auto{pointer-events:auto}.visible{visibility:visible}.\!collapse{visibility:collapse!important}.collapse{visibility:collapse}.static{position:static}.fixed{position:fixed}.absolute{position:absolute}.relative{position:relative}.sticky{position:sticky}.inset-0{top:0;right:0;bottom:0;left:0}.inset-x-0{left:0;right:0}.inset-y-0{bottom:0;top:0}.-top-12{top:-3rem}.bottom-0{bottom:0}.left-0{left:0}.left-1\/2{left:50%}.right-0{right:0}.right-1{right:.25rem}.right-2{right:.5rem}.right-3{right:.75rem}.right-4{right:1rem}.top-0{top:0}.top-1{top:.25rem}.top-1\/2{top:50%}.top-2{top:.5rem}.top-3{top:.75rem}.top-4{top:1rem}.top-\[102px\]{top:102px}.top-\[60\%\]{top:60%}.top-\[90px\]{top:90px}.top-full{top:100%}.top-px{top:1px}.z-10{z-index:10}.z-30{z-index:30}.z-40{z-index:40}.z-50{z-index:50}.z-\[100\]{z-index:100}.z-\[1\]{z-index:1}.order-first{order:-9999}.order-last{order:9999}.col-span-2{grid-column:span 2/span 2}.m-0{margin:0}.-mx-1{margin-left:-.25rem;margin-right:-.25rem}.-mx-4{margin-left:-1rem;margin-right:-1rem}.mx-0\.5{margin-left:.125rem;margin-right:.125rem}.mx-2{margin-left:.5rem;margin-right:.5rem}.mx-3\.5{margin-left:.875rem;margin-right:.875rem}.mx-4{margin-left:1rem;margin-right:1rem}.mx-auto{margin-left:auto;margin-right:auto}.my-8{margin-bottom:2rem;margin-top:2rem}.-ml-2{margin-left:-.5rem}.mb-0{margin-bottom:0}.mb-1{margin-bottom:.25rem}.mb-2{margin-bottom:.5rem}.mb-3{margin-bottom:.75rem}.mb-4{margin-bottom:1rem}.mb-5{margin-bottom:1.25rem}.mb-6{margin-bottom:1.5rem}.mb-\[2px\]{margin-bottom:2px}.ml-1{margin-left:.25rem}.ml-2{margin-left:.5rem}.ml-3{margin-left:.75rem}.ml-4{margin-left:1rem}.ml-6{margin-left:1.5rem}.ml-auto{margin-left:auto}.mr-1{margin-right:.25rem}.mr-1\.5{margin-right:.375rem}.mr-2{margin-right:.5rem}.mr-3{margin-right:.75rem}.mr-4{margin-right:1rem}.mr-auto{margin-right:auto}.mt-0{margin-top:0}.mt-0\.5{margin-top:.125rem}.mt-1{margin-top:.25rem}.mt-1\.5{margin-top:.375rem}.mt-16{margin-top:4rem}.mt-2{margin-top:.5rem}.mt-3{margin-top:.75rem}.mt-4{margin-top:1rem}.block{display:block}.inline-block{display:inline-block}.inline{display:inline}.flex{display:flex}.inline-flex{display:inline-flex}.table{display:table}.grid{display:grid}.contents{display:contents}.hidden{display:none}.aspect-\[4\/3\]{aspect-ratio:4/3}.size-10{height:2.5rem;width:2.5rem}.size-16{height:4rem;width:4rem}.size-2{height:.5rem;width:.5rem}.size-3{height:.75rem;width:.75rem}.size-3\.5{height:.875rem;width:.875rem}.size-32{height:8rem;width:8rem}.size-4{height:1rem;width:1rem}.size-5{height:1.25rem;width:1.25rem}.size-6{height:1.5rem;width:1.5rem}.size-8{height:2rem;width:2rem}.size-full{height:100%;width:100%}.h-1\.5{height:.375rem}.h-10{height:2.5rem}.h-11{height:2.75rem}.h-12{height:3rem}.h-14{height:3.5rem}.h-2{height:.5rem}.h-2\.5{height:.625rem}.h-3{height:.75rem}.h-4{height:1rem}.h-48{height:12rem}.h-5{height:1.25rem}.h-6{height:1.5rem}.h-7{height:1.75rem}.h-8{height:2rem}.h-9{height:2.25rem}.h-\[--radix-navigation-menu-viewport-height\]{height:var(--radix-navigation-menu-viewport-height)}.h-\[calc\(100vh-3\.5rem\)\]{height:calc(100vh - 3.5rem)}.h-\[calc\(100vh-6\.5rem\)\]{height:calc(100vh - 6.5rem)}.h-full{height:100%}.h-px{height:1px}.h-svh{height:100svh}.max-h-screen{max-height:100vh}.min-h-4{min-height:1rem}.min-h-5{min-height:1.25rem}.min-h-6{min-height:1.5rem}.min-h-screen{min-height:100vh}.w-10{width:2.5rem}.w-2\.5{width:.625rem}.w-24{width:6rem}.w-3{width:.75rem}.w-3\/4{width:75%}.w-4{width:1rem}.w-44{width:11rem}.w-5{width:1.25rem}.w-6{width:1.5rem}.w-72{width:18rem}.w-8{width:2rem}.w-9{width:2.25rem}.w-\[200px\]{width:200px}.w-\[23rem\]{width:23rem}.w-\[250px\]{width:250px}.w-\[var\(--dropdown-width\)\]{width:var(--dropdown-width)}.w-auto{width:auto}.w-fit{width:-moz-fit-content;width:fit-content}.w-full{width:100%}.w-max{width:-moz-max-content;width:max-content}.w-px{width:1px}.min-w-0{min-width:0}.min-w-4{min-width:1rem}.min-w-5{min-width:1.25rem}.min-w-6{min-width:1.5rem}.max-w-2xl{max-width:42rem}.max-w-\[750px\]{max-width:750px}.max-w-\[980px\]{max-width:980px}.max-w-lg{max-width:32rem}.max-w-max{max-width:-moz-max-content;max-width:max-content}.max-w-md{max-width:28rem}.max-w-screen-2xl{max-width:1536px}.flex-1{flex:1 1 0%}.shrink-0{flex-shrink:0}.flex-grow{flex-grow:1}.basis-1\/3{flex-basis:33.333333%}.-translate-x-1\/2{--tw-translate-x:-50%}.-translate-x-1\/2,.-translate-y-1\/2{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.-translate-y-1\/2{--tw-translate-y:-50%}.-translate-y-4{--tw-translate-y:-1rem}.-translate-y-4,.translate-y-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-0{--tw-translate-y:0px}.translate-y-12{--tw-translate-y:3rem}.translate-y-12,.translate-y-8{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.translate-y-8{--tw-translate-y:2rem}.-rotate-90{--tw-rotate:-90deg}.-rotate-90,.rotate-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-0{--tw-rotate:0deg}.rotate-180{--tw-rotate:180deg}.rotate-180,.rotate-45{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.rotate-45{--tw-rotate:45deg}.rotate-90{--tw-rotate:90deg}.rotate-90,.scale-0{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.scale-0{--tw-scale-x:0;--tw-scale-y:0}.scale-100{--tw-scale-x:1;--tw-scale-y:1}.scale-100,.transform{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes bounce{0%,to{animation-timing-function:cubic-bezier(.8,0,1,1);transform:translateY(-25%)}50%{animation-timing-function:cubic-bezier(0,0,.2,1);transform:none}}.animate-bounce{animation:bounce 1s infinite}@keyframes pulse{50%{opacity:.5}}.animate-pulse{animation:pulse 2s cubic-bezier(.4,0,.6,1) infinite}@keyframes spin{to{transform:rotate(1turn)}}.animate-spin{animation:spin 1s linear infinite}.cursor-default{cursor:default}.cursor-pointer{cursor:pointer}.touch-none{touch-action:none}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.scroll-m-20{scroll-margin:5rem}.list-decimal{list-style-type:decimal}.list-disc{list-style-type:disc}.list-none{list-style-type:none}.grid-cols-1{grid-template-columns:repeat(1,minmax(0,1fr))}.grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.grid-cols-5{grid-template-columns:repeat(5,minmax(0,1fr))}.grid-cols-\[repeat\(auto-fit\,_minmax\(270px\,_1fr\)\)\]{grid-template-columns:repeat(auto-fit,minmax(270px,1fr))}.flex-row{flex-direction:row}.flex-col{flex-direction:column}.flex-col-reverse{flex-direction:column-reverse}.flex-wrap{flex-wrap:wrap}.place-items-center{place-items:center}.items-start{align-items:flex-start}.items-end{align-items:flex-end}.items-center{align-items:center}.justify-start{justify-content:flex-start}.justify-end{justify-content:flex-end}.justify-center{justify-content:center}.justify-between{justify-content:space-between}.gap-1{gap:.25rem}.gap-1\.5{gap:.375rem}.gap-2{gap:.5rem}.gap-3{gap:.75rem}.gap-4{gap:1rem}.gap-5{gap:1.25rem}.gap-6{gap:1.5rem}.gap-8{gap:2rem}.gap-x-1{-moz-column-gap:.25rem;column-gap:.25rem}.gap-y-1\.5{row-gap:.375rem}.gap-y-2{row-gap:.5rem}.space-x-2>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(.5rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(.5rem*var(--tw-space-x-reverse))}.space-x-4>:not([hidden])~:not([hidden]){--tw-space-x-reverse:0;margin-left:calc(1rem*(1 - var(--tw-space-x-reverse)));margin-right:calc(1rem*var(--tw-space-x-reverse))}.space-y-1>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.25rem*var(--tw-space-y-reverse));margin-top:calc(.25rem*(1 - var(--tw-space-y-reverse)))}.space-y-1\.5>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.375rem*var(--tw-space-y-reverse));margin-top:calc(.375rem*(1 - var(--tw-space-y-reverse)))}.space-y-10>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(2.5rem*var(--tw-space-y-reverse));margin-top:calc(2.5rem*(1 - var(--tw-space-y-reverse)))}.space-y-2>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.5rem*var(--tw-space-y-reverse));margin-top:calc(.5rem*(1 - var(--tw-space-y-reverse)))}.space-y-3>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(.75rem*var(--tw-space-y-reverse));margin-top:calc(.75rem*(1 - var(--tw-space-y-reverse)))}.space-y-4>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1rem*var(--tw-space-y-reverse));margin-top:calc(1rem*(1 - var(--tw-space-y-reverse)))}.space-y-6>:not([hidden])~:not([hidden]){--tw-space-y-reverse:0;margin-bottom:calc(1.5rem*var(--tw-space-y-reverse));margin-top:calc(1.5rem*(1 - var(--tw-space-y-reverse)))}.divide-x>:not([hidden])~:not([hidden]){--tw-divide-x-reverse:0;border-left-width:calc(1px*(1 - var(--tw-divide-x-reverse)));border-right-width:calc(1px*var(--tw-divide-x-reverse))}.divide-y>:not([hidden])~:not([hidden]){--tw-divide-y-reverse:0;border-bottom-width:calc(1px*var(--tw-divide-y-reverse));border-top-width:calc(1px*(1 - var(--tw-divide-y-reverse)))}.self-center{align-self:center}.overflow-hidden{overflow:hidden}.overflow-clip{overflow:clip}.overflow-x-auto{overflow-x:auto}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.truncate{overflow:hidden;text-overflow:ellipsis}.truncate,.whitespace-nowrap{white-space:nowrap}.text-nowrap{text-wrap:nowrap}.break-words{overflow-wrap:break-word}.rounded{border-radius:.25rem}.rounded-\[inherit\]{border-radius:inherit}.rounded-full{border-radius:9999px}.rounded-lg{border-radius:var(--radius)}.rounded-md{border-radius:calc(var(--radius) - 2px)}.rounded-none{border-radius:0}.rounded-sm{border-radius:calc(var(--radius) - 4px)}.rounded-t-none{border-top-left-radius:0;border-top-right-radius:0}.rounded-tl-sm{border-top-left-radius:calc(var(--radius) - 4px)}.border{border-width:1px}.border-2{border-width:2px}.border-b{border-bottom-width:1px}.border-b-2{border-bottom-width:2px}.border-l{border-left-width:1px}.border-l-2{border-left-width:2px}.border-r{border-right-width:1px}.border-t{border-top-width:1px}.border-t-2{border-top-width:2px}.border-none{border-style:none}.border-\[\#adfa1d\]{--tw-border-opacity:1;border-color:rgb(173 250 29/var(--tw-border-opacity,1))}.border-amber-200\/50{border-color:#fde68b80}.border-amber-500{--tw-border-opacity:1;border-color:rgb(245 158 11/var(--tw-border-opacity,1))}.border-amber-600{--tw-border-opacity:1;border-color:rgb(217 119 6/var(--tw-border-opacity,1))}.border-blue-700{--tw-border-opacity:1;border-color:rgb(29 78 216/var(--tw-border-opacity,1))}.border-border{border-color:hsl(var(--border))}.border-border\/30{border-color:hsl(var(--border)/.3)}.border-border\/40{border-color:hsl(var(--border)/.4)}.border-border\/50{border-color:hsl(var(--border)/.5)}.border-destructive{border-color:hsl(var(--destructive))}.border-destructive\/50{border-color:hsl(var(--destructive)/.5)}.border-green-500{--tw-border-opacity:1;border-color:rgb(34 197 94/var(--tw-border-opacity,1))}.border-green-600{--tw-border-opacity:1;border-color:rgb(22 163 74/var(--tw-border-opacity,1))}.border-input{border-color:hsl(var(--input))}.border-primary{border-color:hsl(var(--primary))}.border-primary\/20{border-color:hsl(var(--primary)/.2)}.border-primary\/30{border-color:hsl(var(--primary)/.3)}.border-red-500{--tw-border-opacity:1;border-color:rgb(239 68 68/var(--tw-border-opacity,1))}.border-red-600{--tw-border-opacity:1;border-color:rgb(220 38 38/var(--tw-border-opacity,1))}.border-sky-500{--tw-border-opacity:1;border-color:rgb(14 165 233/var(--tw-border-opacity,1))}.border-sky-600{--tw-border-opacity:1;border-color:rgb(2 132 199/var(--tw-border-opacity,1))}.border-transparent{border-color:transparent}.border-violet-600{--tw-border-opacity:1;border-color:rgb(124 58 237/var(--tw-border-opacity,1))}.border-b-transparent{border-bottom-color:transparent}.border-l-transparent{border-left-color:transparent}.border-t-transparent{border-top-color:transparent}.bg-\[\#adfa1d\]{--tw-bg-opacity:1;background-color:rgb(173 250 29/var(--tw-bg-opacity,1))}.bg-accent{background-color:hsl(var(--accent))}.bg-amber-500{--tw-bg-opacity:1;background-color:rgb(245 158 11/var(--tw-bg-opacity,1))}.bg-background{background-color:hsl(var(--background))}.bg-background\/80{background-color:hsl(var(--background)/.8)}.bg-black\/50{background-color:#00000080}.bg-black\/80{background-color:#000c}.bg-border{background-color:hsl(var(--border))}.bg-card{background-color:hsl(var(--card))}.bg-destructive{background-color:hsl(var(--destructive))}.bg-green-100{--tw-bg-opacity:1;background-color:rgb(220 252 231/var(--tw-bg-opacity,1))}.bg-green-500{--tw-bg-opacity:1;background-color:rgb(34 197 94/var(--tw-bg-opacity,1))}.bg-muted{background-color:hsl(var(--muted))}.bg-muted\/30{background-color:hsl(var(--muted)/.3)}.bg-muted\/40{background-color:hsl(var(--muted)/.4)}.bg-muted\/50{background-color:hsl(var(--muted)/.5)}.bg-popover{background-color:hsl(var(--popover))}.bg-primary{background-color:hsl(var(--primary))}.bg-primary\/10{background-color:hsl(var(--primary)/.1)}.bg-primary\/5{background-color:hsl(var(--primary)/.05)}.bg-primary\/80{background-color:hsl(var(--primary)/.8)}.bg-red-100{--tw-bg-opacity:1;background-color:rgb(254 226 226/var(--tw-bg-opacity,1))}.bg-red-500{--tw-bg-opacity:1;background-color:rgb(239 68 68/var(--tw-bg-opacity,1))}.bg-secondary{background-color:hsl(var(--secondary))}.bg-sky-500{--tw-bg-opacity:1;background-color:rgb(14 165 233/var(--tw-bg-opacity,1))}.bg-transparent{background-color:transparent}.bg-white{--tw-bg-opacity:1;background-color:rgb(255 255 255/var(--tw-bg-opacity,1))}.bg-white\/40{background-color:#fff6}.bg-zinc-950{--tw-bg-opacity:1;background-color:rgb(9 9 11/var(--tw-bg-opacity,1))}.bg-gradient-to-b{background-image:linear-gradient(to bottom,var(--tw-gradient-stops))}.bg-gradient-to-r{background-image:linear-gradient(to right,var(--tw-gradient-stops))}.from-amber-50{--tw-gradient-from:#fffbeb var(--tw-gradient-from-position);--tw-gradient-to:rgba(255,251,235,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-background{--tw-gradient-from:hsl(var(--background)) var(--tw-gradient-from-position);--tw-gradient-to:hsl(var(--background)/0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-muted{--tw-gradient-from:hsl(var(--muted)) var(--tw-gradient-from-position);--tw-gradient-to:hsl(var(--muted)/0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-primary{--tw-gradient-from:hsl(var(--primary)) var(--tw-gradient-from-position);--tw-gradient-to:hsl(var(--primary)/0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-primary\/10{--tw-gradient-from:hsl(var(--primary)/.1) var(--tw-gradient-from-position);--tw-gradient-to:hsl(var(--primary)/0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.from-primary\/5{--tw-gradient-from:hsl(var(--primary)/.05) var(--tw-gradient-from-position);--tw-gradient-to:hsl(var(--primary)/0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.to-amber-100\/50{--tw-gradient-to:hsla(48,96%,89%,.5) var(--tw-gradient-to-position)}.to-background{--tw-gradient-to:hsl(var(--background)) var(--tw-gradient-to-position)}.to-muted\/30{--tw-gradient-to:hsl(var(--muted)/.3) var(--tw-gradient-to-position)}.to-muted\/40{--tw-gradient-to:hsl(var(--muted)/.4) var(--tw-gradient-to-position)}.to-muted\/50{--tw-gradient-to:hsl(var(--muted)/.5) var(--tw-gradient-to-position)}.to-primary\/90{--tw-gradient-to:hsl(var(--primary)/.9) var(--tw-gradient-to-position)}.object-cover{-o-object-fit:cover;object-fit:cover}.object-\[50\%_53\%\]{-o-object-position:50% 53%;object-position:50% 53%}.object-center{-o-object-position:center;object-position:center}.\!p-2{padding:.5rem!important}.p-0{padding:0}.p-0\.5{padding:.125rem}.p-1{padding:.25rem}.p-1\.5{padding:.375rem}.p-16{padding:4rem}.p-2{padding:.5rem}.p-3{padding:.75rem}.p-4{padding:1rem}.p-5{padding:1.25rem}.p-6{padding:1.5rem}.p-px{padding:1px}.px-0\.5{padding-left:.125rem;padding-right:.125rem}.px-1{padding-left:.25rem;padding-right:.25rem}.px-1\.5{padding-left:.375rem;padding-right:.375rem}.px-2{padding-left:.5rem;padding-right:.5rem}.px-2\.5{padding-left:.625rem;padding-right:.625rem}.px-3{padding-left:.75rem;padding-right:.75rem}.px-4{padding-left:1rem;padding-right:1rem}.px-6{padding-left:1.5rem;padding-right:1.5rem}.px-8{padding-left:2rem;padding-right:2rem}.px-\[0\.3rem\]{padding-left:.3rem;padding-right:.3rem}.py-0\.5{padding-bottom:.125rem;padding-top:.125rem}.py-1{padding-bottom:.25rem;padding-top:.25rem}.py-1\.5{padding-bottom:.375rem;padding-top:.375rem}.py-2{padding-bottom:.5rem;padding-top:.5rem}.py-3{padding-bottom:.75rem;padding-top:.75rem}.py-4{padding-bottom:1rem;padding-top:1rem}.py-6{padding-bottom:1.5rem;padding-top:1.5rem}.py-8{padding-bottom:2rem;padding-top:2rem}.py-\[0\.2rem\]{padding-bottom:.2rem;padding-top:.2rem}.pb-2{padding-bottom:.5rem}.pb-3{padding-bottom:.75rem}.pb-4{padding-bottom:1rem}.pb-5{padding-bottom:1.25rem}.pl-2{padding-left:.5rem}.pl-3{padding-left:.75rem}.pl-4{padding-left:1rem}.pl-5{padding-left:1.25rem}.pl-6{padding-left:1.5rem}.pl-8{padding-left:2rem}.pr-0{padding-right:0}.pr-1\.5{padding-right:.375rem}.pr-3{padding-right:.75rem}.pr-6{padding-right:1.5rem}.pt-0{padding-top:0}.pt-1{padding-top:.25rem}.pt-2{padding-top:.5rem}.pt-4{padding-top:1rem}.pt-5{padding-top:1.25rem}.pt-6{padding-top:1.5rem}.text-left{text-align:left}.text-center{text-align:center}.text-right{text-align:right}.font-mono{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace}.font-sans{font-family:ui-sans-serif,system-ui,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-4xl{font-size:2.25rem;line-height:2.5rem}.text-5xl{font-size:3rem;line-height:1}.text-8xl{font-size:6rem;line-height:1}.text-\[10px\]{font-size:10px}.text-\[11px\]{font-size:11px}.text-\[12px\]{font-size:12px}.text-base{font-size:1rem;line-height:1.5rem}.text-lg{font-size:1.125rem;line-height:1.75rem}.text-sm{font-size:.875rem;line-height:1.25rem}.text-xl{font-size:1.25rem;line-height:1.75rem}.text-xs{font-size:.75rem;line-height:1rem}.font-bold{font-weight:700}.font-extrabold{font-weight:800}.font-light{font-weight:300}.font-medium{font-weight:500}.font-normal{font-weight:400}.font-semibold{font-weight:600}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.italic{font-style:italic}.leading-4{line-height:1rem}.leading-7{line-height:1.75rem}.leading-none{line-height:1}.leading-relaxed{line-height:1.625}.leading-tight{line-height:1.25}.tracking-tight{letter-spacing:-.025em}.tracking-tighter{letter-spacing:-.05em}.\!text-primary{color:hsl(var(--primary))!important}.text-accent-foreground{color:hsl(var(--accent-foreground))}.text-amber-500{--tw-text-opacity:1;color:rgb(245 158 11/var(--tw-text-opacity,1))}.text-amber-600{--tw-text-opacity:1;color:rgb(217 119 6/var(--tw-text-opacity,1))}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity,1))}.text-blue-700{--tw-text-opacity:1;color:rgb(29 78 216/var(--tw-text-opacity,1))}.text-card-foreground{color:hsl(var(--card-foreground))}.text-current{color:currentColor}.text-destructive{color:hsl(var(--destructive))}.text-destructive-foreground{color:hsl(var(--destructive-foreground))}.text-foreground{color:hsl(var(--foreground))}.text-foreground\/50{color:hsl(var(--foreground)/.5)}.text-foreground\/70{color:hsl(var(--foreground)/.7)}.text-foreground\/80{color:hsl(var(--foreground)/.8)}.text-gray-500{--tw-text-opacity:1;color:rgb(107 114 128/var(--tw-text-opacity,1))}.text-green-500{--tw-text-opacity:1;color:rgb(34 197 94/var(--tw-text-opacity,1))}.text-green-600{--tw-text-opacity:1;color:rgb(22 163 74/var(--tw-text-opacity,1))}.text-muted-foreground{color:hsl(var(--muted-foreground))}.text-muted-foreground\/80{color:hsl(var(--muted-foreground)/.8)}.text-popover-foreground{color:hsl(var(--popover-foreground))}.text-primary{color:hsl(var(--primary))}.text-primary-foreground{color:hsl(var(--primary-foreground))}.text-primary\/40{color:hsl(var(--primary)/.4)}.text-primary\/70{color:hsl(var(--primary)/.7)}.text-primary\/80{color:hsl(var(--primary)/.8)}.text-red-500{--tw-text-opacity:1;color:rgb(239 68 68/var(--tw-text-opacity,1))}.text-red-600{--tw-text-opacity:1;color:rgb(220 38 38/var(--tw-text-opacity,1))}.text-secondary-foreground{color:hsl(var(--secondary-foreground))}.text-sky-500{--tw-text-opacity:1;color:rgb(14 165 233/var(--tw-text-opacity,1))}.text-sky-600{--tw-text-opacity:1;color:rgb(2 132 199/var(--tw-text-opacity,1))}.text-violet-600{--tw-text-opacity:1;color:rgb(124 58 237/var(--tw-text-opacity,1))}.text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity,1))}.text-zinc-100{--tw-text-opacity:1;color:rgb(244 244 245/var(--tw-text-opacity,1))}.text-zinc-400{--tw-text-opacity:1;color:rgb(161 161 170/var(--tw-text-opacity,1))}.text-zinc-500{--tw-text-opacity:1;color:rgb(113 113 122/var(--tw-text-opacity,1))}.text-zinc-900{--tw-text-opacity:1;color:rgb(24 24 27/var(--tw-text-opacity,1))}.underline{text-decoration-line:underline}.no-underline{text-decoration-line:none}.underline-offset-4{text-underline-offset:4px}.opacity-0{opacity:0}.opacity-100{opacity:1}.opacity-50{opacity:.5}.opacity-70{opacity:.7}.opacity-90{opacity:.9}.shadow-inner{--tw-shadow:inset 0 2px 4px 0 rgba(0,0,0,.05);--tw-shadow-colored:inset 0 2px 4px 0 var(--tw-shadow-color)}.shadow-inner,.shadow-lg{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-lg{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.shadow-md{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.shadow-md,.shadow-none{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-none{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000}.shadow-sm{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color)}.shadow-sm,.shadow-xl{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.shadow-xl{--tw-shadow:0 20px 25px -5px rgba(0,0,0,.1),0 8px 10px -6px rgba(0,0,0,.1);--tw-shadow-colored:0 20px 25px -5px var(--tw-shadow-color),0 8px 10px -6px var(--tw-shadow-color)}.outline-none{outline:2px solid transparent;outline-offset:2px}.outline{outline-style:solid}.ring-offset-background{--tw-ring-offset-color:hsl(var(--background))}.filter{filter:var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow)}.backdrop-blur-lg{--tw-backdrop-blur:blur(16px);-webkit-backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia);backdrop-filter:var(--tw-backdrop-blur) var(--tw-backdrop-brightness) var(--tw-backdrop-contrast) var(--tw-backdrop-grayscale) var(--tw-backdrop-hue-rotate) var(--tw-backdrop-invert) var(--tw-backdrop-opacity) var(--tw-backdrop-saturate) var(--tw-backdrop-sepia)}.transition{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,-webkit-backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-all{transition-duration:.15s;transition-property:all;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-colors{transition-duration:.15s;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-none{transition-property:none}.transition-opacity{transition-duration:.15s;transition-property:opacity;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-shadow{transition-duration:.15s;transition-property:box-shadow;transition-timing-function:cubic-bezier(.4,0,.2,1)}.transition-transform{transition-duration:.15s;transition-property:transform;transition-timing-function:cubic-bezier(.4,0,.2,1)}.duration-200{transition-duration:.2s}.duration-300{transition-duration:.3s}.duration-500{transition-duration:.5s}.duration-700{transition-duration:.7s}.duration-75{transition-duration:75ms}.ease-in{transition-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{transition-timing-function:cubic-bezier(.4,0,.2,1)}.ease-out{transition-timing-function:cubic-bezier(0,0,.2,1)}@keyframes enter{0%{opacity:var(--tw-enter-opacity,1);transform:translate3d(var(--tw-enter-translate-x,0),var(--tw-enter-translate-y,0),0) scale3d(var(--tw-enter-scale,1),var(--tw-enter-scale,1),var(--tw-enter-scale,1)) rotate(var(--tw-enter-rotate,0))}}@keyframes exit{to{opacity:var(--tw-exit-opacity,1);transform:translate3d(var(--tw-exit-translate-x,0),var(--tw-exit-translate-y,0),0) scale3d(var(--tw-exit-scale,1),var(--tw-exit-scale,1),var(--tw-exit-scale,1)) rotate(var(--tw-exit-rotate,0))}}.duration-200{animation-duration:.2s}.duration-300{animation-duration:.3s}.duration-500{animation-duration:.5s}.duration-700{animation-duration:.7s}.duration-75{animation-duration:75ms}.ease-in{animation-timing-function:cubic-bezier(.4,0,1,1)}.ease-in-out{animation-timing-function:cubic-bezier(.4,0,.2,1)}.ease-out{animation-timing-function:cubic-bezier(0,0,.2,1)}.running{animation-play-state:running}.step{counter-increment:step}.step:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[counter-reset\:step\]{counter-reset:step}.file\:border-0::file-selector-button{border-width:0}.file\:bg-transparent::file-selector-button{background-color:transparent}.file\:text-sm::file-selector-button{font-size:.875rem;line-height:1.25rem}.file\:font-medium::file-selector-button{font-weight:500}.placeholder\:text-muted-foreground::-moz-placeholder{color:hsl(var(--muted-foreground))}.placeholder\:text-muted-foreground::placeholder{color:hsl(var(--muted-foreground))}.even\:bg-muted\/50:nth-child(2n){background-color:hsl(var(--muted)/.5)}.focus-within\:shadow-md:focus-within{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.hover\:scale-\[1\.01\]:hover{--tw-scale-x:1.01;--tw-scale-y:1.01}.hover\:scale-\[1\.01\]:hover,.hover\:scale-\[1\.02\]:hover{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.hover\:scale-\[1\.02\]:hover{--tw-scale-x:1.02;--tw-scale-y:1.02}.hover\:cursor-pointer:hover{cursor:pointer}.hover\:bg-\[\#adfa1d\]:hover{--tw-bg-opacity:1;background-color:rgb(173 250 29/var(--tw-bg-opacity,1))}.hover\:bg-accent:hover{background-color:hsl(var(--accent))}.hover\:bg-amber-400:hover{--tw-bg-opacity:1;background-color:rgb(251 191 36/var(--tw-bg-opacity,1))}.hover\:bg-destructive\/80:hover{background-color:hsl(var(--destructive)/.8)}.hover\:bg-destructive\/90:hover{background-color:hsl(var(--destructive)/.9)}.hover\:bg-green-400:hover{--tw-bg-opacity:1;background-color:rgb(74 222 128/var(--tw-bg-opacity,1))}.hover\:bg-muted:hover{background-color:hsl(var(--muted))}.hover\:bg-muted\/40:hover{background-color:hsl(var(--muted)/.4)}.hover\:bg-muted\/50:hover{background-color:hsl(var(--muted)/.5)}.hover\:bg-primary\/10:hover{background-color:hsl(var(--primary)/.1)}.hover\:bg-primary\/80:hover{background-color:hsl(var(--primary)/.8)}.hover\:bg-primary\/90:hover{background-color:hsl(var(--primary)/.9)}.hover\:bg-red-400:hover{--tw-bg-opacity:1;background-color:rgb(248 113 113/var(--tw-bg-opacity,1))}.hover\:bg-secondary:hover{background-color:hsl(var(--secondary))}.hover\:bg-secondary\/80:hover{background-color:hsl(var(--secondary)/.8)}.hover\:bg-sky-400:hover{--tw-bg-opacity:1;background-color:rgb(56 189 248/var(--tw-bg-opacity,1))}.hover\:from-primary\/90:hover{--tw-gradient-from:hsl(var(--primary)/.9) var(--tw-gradient-from-position);--tw-gradient-to:hsl(var(--primary)/0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.hover\:to-primary:hover{--tw-gradient-to:hsl(var(--primary)) var(--tw-gradient-to-position)}.hover\:text-accent-foreground:hover{color:hsl(var(--accent-foreground))}.hover\:text-foreground:hover{color:hsl(var(--foreground))}.hover\:text-primary:hover{color:hsl(var(--primary))}.hover\:underline:hover{text-decoration-line:underline}.hover\:opacity-100:hover{opacity:1}.hover\:shadow:hover{--tw-shadow:0 1px 3px 0 rgba(0,0,0,.1),0 1px 2px -1px rgba(0,0,0,.1);--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color)}.hover\:shadow-2xl:hover,.hover\:shadow:hover{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.hover\:shadow-2xl:hover{--tw-shadow:0 25px 50px -12px rgba(0,0,0,.25);--tw-shadow-colored:0 25px 50px -12px var(--tw-shadow-color)}.hover\:shadow-lg:hover{--tw-shadow:0 10px 15px -3px rgba(0,0,0,.1),0 4px 6px -4px rgba(0,0,0,.1);--tw-shadow-colored:0 10px 15px -3px var(--tw-shadow-color),0 4px 6px -4px var(--tw-shadow-color)}.hover\:shadow-lg:hover,.hover\:shadow-md:hover{box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.hover\:shadow-md:hover{--tw-shadow:0 4px 6px -1px rgba(0,0,0,.1),0 2px 4px -2px rgba(0,0,0,.1);--tw-shadow-colored:0 4px 6px -1px var(--tw-shadow-color),0 2px 4px -2px var(--tw-shadow-color)}.focus\:bg-accent:focus{background-color:hsl(var(--accent))}.focus\:text-accent-foreground:focus{color:hsl(var(--accent-foreground))}.focus\:opacity-100:focus{opacity:1}.focus\:outline-none:focus{outline:2px solid transparent;outline-offset:2px}.focus\:ring-1:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color)}.focus\:ring-1:focus,.focus\:ring-2:focus{box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus\:ring-2:focus{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color)}.focus\:ring-ring:focus{--tw-ring-color:hsl(var(--ring))}.focus\:ring-offset-2:focus{--tw-ring-offset-width:2px}.focus-visible\:outline-none:focus-visible{outline:2px solid transparent;outline-offset:2px}.focus-visible\:ring-2:focus-visible{--tw-ring-offset-shadow:var(--tw-ring-inset) 0 0 0 var(--tw-ring-offset-width) var(--tw-ring-offset-color);--tw-ring-shadow:var(--tw-ring-inset) 0 0 0 calc(2px + var(--tw-ring-offset-width)) var(--tw-ring-color);box-shadow:var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow,0 0 #0000)}.focus-visible\:ring-ring:focus-visible{--tw-ring-color:hsl(var(--ring))}.focus-visible\:ring-offset-2:focus-visible{--tw-ring-offset-width:2px}.active\:scale-\[0\.98\]:active{--tw-scale-x:.98;--tw-scale-y:.98;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.disabled\:pointer-events-none:disabled{pointer-events:none}.disabled\:cursor-not-allowed:disabled{cursor:not-allowed}.disabled\:opacity-50:disabled{opacity:.5}.group:hover .group-hover\:opacity-100{opacity:1}.group.destructive .group-\[\.destructive\]\:border-muted\/40{border-color:hsl(var(--muted)/.4)}.group.destructive .group-\[\.destructive\]\:text-red-300{--tw-text-opacity:1;color:rgb(252 165 165/var(--tw-text-opacity,1))}.group.destructive .group-\[\.destructive\]\:hover\:border-destructive\/30:hover{border-color:hsl(var(--destructive)/.3)}.group.destructive .group-\[\.destructive\]\:hover\:bg-destructive:hover{background-color:hsl(var(--destructive))}.group.destructive .group-\[\.destructive\]\:hover\:text-destructive-foreground:hover{color:hsl(var(--destructive-foreground))}.group.destructive .group-\[\.destructive\]\:hover\:text-red-50:hover{--tw-text-opacity:1;color:rgb(254 242 242/var(--tw-text-opacity,1))}.group.destructive .group-\[\.destructive\]\:focus\:ring-destructive:focus{--tw-ring-color:hsl(var(--destructive))}.group.destructive .group-\[\.destructive\]\:focus\:ring-red-400:focus{--tw-ring-opacity:1;--tw-ring-color:rgb(248 113 113/var(--tw-ring-opacity,1))}.group.destructive .group-\[\.destructive\]\:focus\:ring-offset-red-600:focus{--tw-ring-offset-color:#dc2626}.peer:disabled~.peer-disabled\:cursor-not-allowed{cursor:not-allowed}.peer:disabled~.peer-disabled\:opacity-70{opacity:.7}.group:has(div) .group-has-\[div\]\:mt-0{margin-top:0}.data-\[disabled\]\:pointer-events-none[data-disabled]{pointer-events:none}.data-\[swipe\=cancel\]\:translate-x-0[data-swipe=cancel]{--tw-translate-x:0px}.data-\[swipe\=cancel\]\:translate-x-0[data-swipe=cancel],.data-\[swipe\=end\]\:translate-x-\[var\(--radix-toast-swipe-end-x\)\][data-swipe=end]{transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.data-\[swipe\=end\]\:translate-x-\[var\(--radix-toast-swipe-end-x\)\][data-swipe=end]{--tw-translate-x:var(--radix-toast-swipe-end-x)}.data-\[swipe\=move\]\:translate-x-\[var\(--radix-toast-swipe-move-x\)\][data-swipe=move]{--tw-translate-x:var(--radix-toast-swipe-move-x);transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}@keyframes accordion-up{0%{height:var(--radix-accordion-content-height)}to{height:0}}.data-\[state\=closed\]\:animate-accordion-up[data-state=closed]{animation:accordion-up .2s ease-out}@keyframes collapsible-up{0%{height:var(--radix-collapsible-content-height)}to{height:0}}.data-\[state\=closed\]\:animate-collapsible-up[data-state=closed]{animation:collapsible-up .2s ease-in-out}@keyframes accordion-down{0%{height:0}to{height:var(--radix-accordion-content-height)}}.data-\[state\=open\]\:animate-accordion-down[data-state=open]{animation:accordion-down .2s ease-out}@keyframes collapsible-down{0%{height:0}to{height:var(--radix-collapsible-content-height)}}.data-\[state\=open\]\:animate-collapsible-down[data-state=open]{animation:collapsible-down .2s ease-in-out}.data-\[state\=active\]\:border-b-primary[data-state=active]{border-bottom-color:hsl(var(--primary))}.data-\[active\]\:bg-accent\/50[data-active]{background-color:hsl(var(--accent)/.5)}.data-\[highlighted\]\:bg-accent[data-highlighted]{background-color:hsl(var(--accent))}.data-\[state\=active\]\:bg-background[data-state=active]{background-color:hsl(var(--background))}.data-\[state\=checked\]\:bg-primary[data-state=checked]{background-color:hsl(var(--primary))}.data-\[state\=open\]\:bg-accent[data-state=open]{background-color:hsl(var(--accent))}.data-\[state\=open\]\:bg-accent\/50[data-state=open]{background-color:hsl(var(--accent)/.5)}.data-\[state\=open\]\:bg-secondary[data-state=open]{background-color:hsl(var(--secondary))}.data-\[state\=active\]\:text-foreground[data-state=active]{color:hsl(var(--foreground))}.data-\[state\=checked\]\:text-primary-foreground[data-state=checked]{color:hsl(var(--primary-foreground))}.data-\[state\=open\]\:text-muted-foreground[data-state=open]{color:hsl(var(--muted-foreground))}.data-\[disabled\]\:opacity-50[data-disabled]{opacity:.5}.data-\[state\=active\]\:shadow-none[data-state=active]{--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.data-\[state\=active\]\:shadow-sm[data-state=active]{--tw-shadow:0 1px 2px 0 rgba(0,0,0,.05);--tw-shadow-colored:0 1px 2px 0 var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.data-\[swipe\=move\]\:transition-none[data-swipe=move]{transition-property:none}.data-\[state\=closed\]\:duration-300[data-state=closed]{transition-duration:.3s}.data-\[state\=open\]\:duration-500[data-state=open]{transition-duration:.5s}.data-\[motion\^\=from-\]\:animate-in[data-motion^=from-],.data-\[state\=open\]\:animate-in[data-state=open],.data-\[state\=visible\]\:animate-in[data-state=visible]{animation-duration:.15s;animation-name:enter;--tw-enter-opacity:initial;--tw-enter-scale:initial;--tw-enter-rotate:initial;--tw-enter-translate-x:initial;--tw-enter-translate-y:initial}.data-\[motion\^\=to-\]\:animate-out[data-motion^=to-],.data-\[state\=closed\]\:animate-out[data-state=closed],.data-\[state\=hidden\]\:animate-out[data-state=hidden],.data-\[swipe\=end\]\:animate-out[data-swipe=end]{animation-duration:.15s;animation-name:exit;--tw-exit-opacity:initial;--tw-exit-scale:initial;--tw-exit-rotate:initial;--tw-exit-translate-x:initial;--tw-exit-translate-y:initial}.data-\[motion\^\=from-\]\:fade-in[data-motion^=from-]{--tw-enter-opacity:0}.data-\[motion\^\=to-\]\:fade-out[data-motion^=to-],.data-\[state\=closed\]\:fade-out-0[data-state=closed]{--tw-exit-opacity:0}.data-\[state\=closed\]\:fade-out-80[data-state=closed]{--tw-exit-opacity:.8}.data-\[state\=hidden\]\:fade-out[data-state=hidden]{--tw-exit-opacity:0}.data-\[state\=open\]\:fade-in-0[data-state=open],.data-\[state\=visible\]\:fade-in[data-state=visible]{--tw-enter-opacity:0}.data-\[state\=closed\]\:zoom-out-95[data-state=closed]{--tw-exit-scale:.95}.data-\[state\=open\]\:zoom-in-90[data-state=open]{--tw-enter-scale:.9}.data-\[state\=open\]\:zoom-in-95[data-state=open]{--tw-enter-scale:.95}.data-\[motion\=from-end\]\:slide-in-from-right-52[data-motion=from-end]{--tw-enter-translate-x:13rem}.data-\[motion\=from-start\]\:slide-in-from-left-52[data-motion=from-start]{--tw-enter-translate-x:-13rem}.data-\[motion\=to-end\]\:slide-out-to-right-52[data-motion=to-end]{--tw-exit-translate-x:13rem}.data-\[motion\=to-start\]\:slide-out-to-left-52[data-motion=to-start]{--tw-exit-translate-x:-13rem}.data-\[side\=bottom\]\:slide-in-from-top-2[data-side=bottom]{--tw-enter-translate-y:-.5rem}.data-\[side\=left\]\:slide-in-from-right-2[data-side=left]{--tw-enter-translate-x:.5rem}.data-\[side\=right\]\:slide-in-from-left-2[data-side=right]{--tw-enter-translate-x:-.5rem}.data-\[side\=top\]\:slide-in-from-bottom-2[data-side=top]{--tw-enter-translate-y:.5rem}.data-\[state\=closed\]\:slide-out-to-bottom[data-state=closed]{--tw-exit-translate-y:100%}.data-\[state\=closed\]\:slide-out-to-left[data-state=closed]{--tw-exit-translate-x:-100%}.data-\[state\=closed\]\:slide-out-to-left-1\/2[data-state=closed]{--tw-exit-translate-x:-50%}.data-\[state\=closed\]\:slide-out-to-right-full[data-state=closed],.data-\[state\=closed\]\:slide-out-to-right[data-state=closed]{--tw-exit-translate-x:100%}.data-\[state\=closed\]\:slide-out-to-top[data-state=closed]{--tw-exit-translate-y:-100%}.data-\[state\=closed\]\:slide-out-to-top-\[48\%\][data-state=closed]{--tw-exit-translate-y:-48%}.data-\[state\=open\]\:slide-in-from-bottom[data-state=open]{--tw-enter-translate-y:100%}.data-\[state\=open\]\:slide-in-from-left[data-state=open]{--tw-enter-translate-x:-100%}.data-\[state\=open\]\:slide-in-from-left-1\/2[data-state=open]{--tw-enter-translate-x:-50%}.data-\[state\=open\]\:slide-in-from-right[data-state=open]{--tw-enter-translate-x:100%}.data-\[state\=open\]\:slide-in-from-top[data-state=open]{--tw-enter-translate-y:-100%}.data-\[state\=open\]\:slide-in-from-top-\[48\%\][data-state=open]{--tw-enter-translate-y:-48%}.data-\[state\=open\]\:slide-in-from-top-full[data-state=open]{--tw-enter-translate-y:-100%}.data-\[state\=closed\]\:duration-300[data-state=closed]{animation-duration:.3s}.data-\[state\=open\]\:duration-500[data-state=open]{animation-duration:.5s}.group[data-state=open] .group-data-\[state\=open\]\:rotate-180{--tw-rotate:180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.dark\:block:is(.dark *){display:block}.dark\:hidden:is(.dark *){display:none}.dark\:-rotate-90:is(.dark *){--tw-rotate:-90deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.dark\:rotate-0:is(.dark *){--tw-rotate:0deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.dark\:scale-0:is(.dark *){--tw-scale-x:0;--tw-scale-y:0;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.dark\:scale-100:is(.dark *){--tw-scale-x:1;--tw-scale-y:1;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.dark\:border-amber-800\/30:is(.dark *){border-color:#92400e4d}.dark\:border-destructive:is(.dark *){border-color:hsl(var(--destructive))}.dark\:from-amber-950\/20:is(.dark *){--tw-gradient-from:rgba(69,26,3,.2) var(--tw-gradient-from-position);--tw-gradient-to:rgba(69,26,3,0) var(--tw-gradient-to-position);--tw-gradient-stops:var(--tw-gradient-from),var(--tw-gradient-to)}.dark\:to-amber-900\/10:is(.dark *){--tw-gradient-to:rgba(120,53,15,.1) var(--tw-gradient-to-position)}@media (min-width:640px){.sm\:bottom-0{bottom:0}.sm\:right-0{right:0}.sm\:top-auto{top:auto}.sm\:inline{display:inline}.sm\:hidden{display:none}.sm\:h-\[350px\]{height:350px}.sm\:max-w-sm{max-width:24rem}.sm\:flex-row{flex-direction:row}.sm\:flex-col{flex-direction:column}.sm\:justify-end{justify-content:flex-end}.sm\:gap-2\.5{gap:.625rem}.sm\:gap-x-2{-moz-column-gap:.5rem;column-gap:.5rem}.sm\:rounded-lg{border-radius:var(--radius)}.sm\:text-left{text-align:left}.sm\:text-xl{font-size:1.25rem;line-height:1.75rem}.data-\[state\=open\]\:sm\:slide-in-from-bottom-full[data-state=open]{--tw-enter-translate-y:100%}}@media (min-width:768px){.md\:absolute{position:absolute}.md\:sticky{position:sticky}.md\:top-\[60px\]{top:60px}.md\:order-last{order:9999}.md\:col-span-2{grid-column:span 2/span 2}.md\:block{display:block}.md\:flex{display:flex}.md\:grid{display:grid}.md\:hidden{display:none}.md\:h-24{height:6rem}.md\:w-40{width:10rem}.md\:w-\[--radix-navigation-menu-viewport-width\]{width:var(--radix-navigation-menu-viewport-width)}.md\:w-auto{width:auto}.md\:w-full{width:100%}.md\:max-w-\[420px\]{max-width:420px}.md\:grid-cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}.md\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.md\:grid-cols-\[220px_minmax\(0\,1fr\)\]{grid-template-columns:220px minmax(0,1fr)}.md\:flex-row{flex-direction:row}.md\:gap-6{gap:1.5rem}.md\:px-8{padding-left:2rem;padding-right:2rem}.md\:py-0{padding-bottom:0;padding-top:0}.md\:py-12{padding-bottom:3rem;padding-top:3rem}.md\:pb-10{padding-bottom:2.5rem}.md\:pb-8{padding-bottom:2rem}.md\:pr-4{padding-right:1rem}.md\:text-4xl{font-size:2.25rem;line-height:2.5rem}.md\:text-6xl{font-size:3.75rem;line-height:1}}@media (min-width:1024px){.lg\:mt-6{margin-top:1.5rem}.lg\:block{display:block}.lg\:flex{display:flex}.lg\:grid{display:grid}.lg\:hidden{display:none}.lg\:w-64{width:16rem}.lg\:flex-none{flex:none}.lg\:grid-cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}.lg\:grid-cols-\[1fr_220px\]{grid-template-columns:1fr 220px}.lg\:grid-cols-\[240px_minmax\(0\,1fr\)\]{grid-template-columns:240px minmax(0,1fr)}.lg\:flex-row{flex-direction:row}.lg\:flex-col{flex-direction:column}.lg\:gap-10{gap:2.5rem}.lg\:gap-14{gap:3.5rem}.lg\:border-b{border-bottom-width:1px}.lg\:border-b-0{border-bottom-width:0}.lg\:border-r{border-right-width:1px}.lg\:border-none{border-style:none}.lg\:py-12{padding-bottom:3rem;padding-top:3rem}.lg\:py-24{padding-bottom:6rem;padding-top:6rem}.lg\:py-6{padding-bottom:1.5rem;padding-top:1.5rem}.lg\:py-8{padding-bottom:2rem;padding-top:2rem}.lg\:pb-10{padding-bottom:2.5rem}.lg\:pb-20{padding-bottom:5rem}.lg\:text-center{text-align:center}.lg\:text-5xl{font-size:3rem;line-height:1}.lg\:leading-\[1\.1\]{line-height:1.1}}.\[\&\+div\]\:text-xs+div{font-size:.75rem;line-height:1rem}.\[\&\:not\(\:first-child\)\]\:mt-10:not(:first-child){margin-top:2.5rem}.\[\&\:not\(\:first-child\)\]\:mt-4:not(:first-child){margin-top:1rem}.\[\&\:not\(\:first-child\)\]\:mt-5:not(:first-child){margin-top:1.25rem}.\[\&\:not\(\:first-child\)\]\:mt-6:not(:first-child){margin-top:1.5rem}.\[\&\:not\(\:first-child\)\]\:mt-8:not(:first-child){margin-top:2rem}.\[\&\:not\(\:first-child\)\]\:pt-3:not(:first-child){padding-top:.75rem}.\[\&\:not\(\:first-child\)\]\:pt-4:not(:first-child){padding-top:1rem}.\[\&\:not\(\:last-child\)\]\:mb-12:not(:last-child){margin-bottom:3rem}.\[\&\:not\(\:last-child\)\]\:mb-5:not(:last-child){margin-bottom:1.25rem}.\[\&\:not\(\:last-child\)\]\:mb-6:not(:last-child){margin-bottom:1.5rem}.\[\&\:not\(\:last-child\)\]\:mb-8:not(:last-child){margin-bottom:2rem}.\[\&\>h1\]\:step>h1{counter-increment:step}.\[\&\>h1\]\:step>h1:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>h2\]\:step>h2{counter-increment:step}.\[\&\>h2\]\:step>h2:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>h3\]\:step>h3{counter-increment:step}.\[\&\>h3\]\:step>h3:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>h4\]\:step>h4{counter-increment:step}.\[\&\>h4\]\:step>h4:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>h5\]\:step>h5{counter-increment:step}.\[\&\>h5\]\:step>h5:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>h6\]\:step>h6{counter-increment:step}.\[\&\>h6\]\:step>h6:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>li\:not\(\:first-child\)\]\:mt-2>li:not(:first-child){margin-top:.5rem}.\[\&\>li\]\:step>li{counter-increment:step}.\[\&\>li\]\:step>li:before{align-items:center;background-color:hsl(var(--muted));border-color:hsl(var(--background));border-radius:9999px;border-width:4px;content:counter(step);display:inline-flex;font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1rem;font-weight:500;height:2.25rem;justify-content:center;line-height:1.5rem;margin-left:-50px;margin-top:-.25rem;position:absolute;text-align:center;text-indent:-1px;width:2.25rem}.\[\&\>ol\]\:\!mt-2>ol{margin-top:.5rem!important}.\[\&\>svg\+div\]\:translate-y-\[-3px\]>svg+div{--tw-translate-y:-3px;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\[\&\>svg\]\:absolute>svg{position:absolute}.\[\&\>svg\]\:left-4>svg{left:1rem}.\[\&\>svg\]\:top-4>svg{top:1rem}.\[\&\>svg\]\:size-3\.5>svg{height:.875rem;width:.875rem}.\[\&\>svg\]\:text-amber-600>svg{--tw-text-opacity:1;color:rgb(217 119 6/var(--tw-text-opacity,1))}.\[\&\>svg\]\:text-blue-700>svg{--tw-text-opacity:1;color:rgb(29 78 216/var(--tw-text-opacity,1))}.\[\&\>svg\]\:text-destructive>svg{color:hsl(var(--destructive))}.\[\&\>svg\]\:text-foreground>svg{color:hsl(var(--foreground))}.\[\&\>svg\]\:text-green-600>svg{--tw-text-opacity:1;color:rgb(22 163 74/var(--tw-text-opacity,1))}.\[\&\>svg\]\:text-red-600>svg{--tw-text-opacity:1;color:rgb(220 38 38/var(--tw-text-opacity,1))}.\[\&\>svg\]\:text-sky-600>svg{--tw-text-opacity:1;color:rgb(2 132 199/var(--tw-text-opacity,1))}.\[\&\>svg\]\:text-violet-600>svg{--tw-text-opacity:1;color:rgb(124 58 237/var(--tw-text-opacity,1))}.\[\&\>svg\~\*\]\:pl-7>svg~*{padding-left:1.75rem}.\[\&\>ul\]\:\!mt-2>ul{margin-top:.5rem!important}.\[\&\[align\=center\]\]\:text-center[align=center]{text-align:center}.\[\&\[align\=right\]\]\:text-right[align=right]{text-align:right}.\[\&\[data-state\=open\]\>svg\]\:rotate-180[data-state=open]>svg{--tw-rotate:180deg;transform:translate(var(--tw-translate-x),var(--tw-translate-y)) rotate(var(--tw-rotate)) skew(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y))}.\[\&_\[cmdk-group-heading\]\]\:px-2 [cmdk-group-heading]{padding-left:.5rem;padding-right:.5rem}.\[\&_\[cmdk-group-heading\]\]\:py-1\.5 [cmdk-group-heading]{padding-bottom:.375rem;padding-top:.375rem}.\[\&_\[cmdk-group-heading\]\]\:text-xs [cmdk-group-heading]{font-size:.75rem;line-height:1rem}.\[\&_\[cmdk-group-heading\]\]\:font-medium [cmdk-group-heading]{font-weight:500}.\[\&_\[cmdk-group-heading\]\]\:text-muted-foreground [cmdk-group-heading]{color:hsl(var(--muted-foreground))}.\[\&_p\]\:leading-relaxed p{line-height:1.625}</style>
<style>html{color-scheme:light}html.dark{color-scheme:dark}.theme-zinc{--background:0 0% 100%;--foreground:240 10% 3.9%;--muted:240 4.8% 95.9%;--muted-foreground:240 3.8% 46.1%;--popover:0 0% 100%;--popover-foreground:240 10% 3.9%;--card:0 0% 100%;--card-foreground:240 10% 3.9%;--border:240 5.9% 90%;--input:240 5.9% 90%;--primary:240 5.9% 10%;--primary-foreground:0 0% 98%;--secondary:240 4.8% 95.9%;--secondary-foreground:240 5.9% 10%;--accent:240 4.8% 95.9%;--accent-foreground:240 5.9% 10%;--destructive:0 84.2% 60.2%;--destructive-foreground:0 0% 98%;--ring:240 5.9% 10%;--radius:.5rem}.dark .theme-zinc{--background:240 10% 3.9%;--foreground:0 0% 98%;--muted:240 3.7% 15.9%;--muted-foreground:240 5% 64.9%;--popover:240 10% 3.9%;--popover-foreground:0 0% 98%;--card:240 10% 3.9%;--card-foreground:0 0% 98%;--border:240 3.7% 15.9%;--input:240 3.7% 15.9%;--primary:0 0% 98%;--primary-foreground:240 5.9% 10%;--secondary:240 3.7% 15.9%;--secondary-foreground:0 0% 98%;--accent:240 3.7% 15.9%;--accent-foreground:0 0% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:0 0% 98%;--ring:240 4.9% 83.9%}.theme-slate{--background:0 0% 100%;--foreground:222.2 84% 4.9%;--muted:210 40% 96.1%;--muted-foreground:215.4 16.3% 46.9%;--popover:0 0% 100%;--popover-foreground:222.2 84% 4.9%;--card:0 0% 100%;--card-foreground:222.2 84% 4.9%;--border:214.3 31.8% 91.4%;--input:214.3 31.8% 91.4%;--primary:222.2 47.4% 11.2%;--primary-foreground:210 40% 98%;--secondary:210 40% 96.1%;--secondary-foreground:222.2 47.4% 11.2%;--accent:210 40% 96.1%;--accent-foreground:222.2 47.4% 11.2%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 40% 98%;--ring:222.2 84% 4.9%;--radius:.5rem}.dark .theme-slate{--background:222.2 84% 4.9%;--foreground:210 40% 98%;--muted:217.2 32.6% 17.5%;--muted-foreground:215 20.2% 65.1%;--popover:222.2 84% 4.9%;--popover-foreground:210 40% 98%;--card:222.2 84% 4.9%;--card-foreground:210 40% 98%;--border:217.2 32.6% 17.5%;--input:217.2 32.6% 17.5%;--primary:210 40% 98%;--primary-foreground:222.2 47.4% 11.2%;--secondary:217.2 32.6% 17.5%;--secondary-foreground:210 40% 98%;--accent:217.2 32.6% 17.5%;--accent-foreground:210 40% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:210 40% 98%;--ring:212.7 26.8% 83.9}.theme-stone{--background:0 0% 100%;--foreground:20 14.3% 4.1%;--muted:60 4.8% 95.9%;--muted-foreground:25 5.3% 44.7%;--popover:0 0% 100%;--popover-foreground:20 14.3% 4.1%;--card:0 0% 100%;--card-foreground:20 14.3% 4.1%;--border:20 5.9% 90%;--input:20 5.9% 90%;--primary:24 9.8% 10%;--primary-foreground:60 9.1% 97.8%;--secondary:60 4.8% 95.9%;--secondary-foreground:24 9.8% 10%;--accent:60 4.8% 95.9%;--accent-foreground:24 9.8% 10%;--destructive:0 84.2% 60.2%;--destructive-foreground:60 9.1% 97.8%;--ring:20 14.3% 4.1%;--radius:.5rem}.dark .theme-stone{--background:20 14.3% 4.1%;--foreground:60 9.1% 97.8%;--muted:12 6.5% 15.1%;--muted-foreground:24 5.4% 63.9%;--popover:20 14.3% 4.1%;--popover-foreground:60 9.1% 97.8%;--card:20 14.3% 4.1%;--card-foreground:60 9.1% 97.8%;--border:12 6.5% 15.1%;--input:12 6.5% 15.1%;--primary:60 9.1% 97.8%;--primary-foreground:24 9.8% 10%;--secondary:12 6.5% 15.1%;--secondary-foreground:60 9.1% 97.8%;--accent:12 6.5% 15.1%;--accent-foreground:60 9.1% 97.8%;--destructive:0 62.8% 30.6%;--destructive-foreground:60 9.1% 97.8%;--ring:24 5.7% 82.9%}.theme-gray{--background:0 0% 100%;--foreground:224 71.4% 4.1%;--muted:220 14.3% 95.9%;--muted-foreground:220 8.9% 46.1%;--popover:0 0% 100%;--popover-foreground:224 71.4% 4.1%;--card:0 0% 100%;--card-foreground:224 71.4% 4.1%;--border:220 13% 91%;--input:220 13% 91%;--primary:220.9 39.3% 11%;--primary-foreground:210 20% 98%;--secondary:220 14.3% 95.9%;--secondary-foreground:220.9 39.3% 11%;--accent:220 14.3% 95.9%;--accent-foreground:220.9 39.3% 11%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 20% 98%;--ring:224 71.4% 4.1%;--radius:.5rem}.dark .theme-gray{--background:224 71.4% 4.1%;--foreground:210 20% 98%;--muted:215 27.9% 16.9%;--muted-foreground:217.9 10.6% 64.9%;--popover:224 71.4% 4.1%;--popover-foreground:210 20% 98%;--card:224 71.4% 4.1%;--card-foreground:210 20% 98%;--border:215 27.9% 16.9%;--input:215 27.9% 16.9%;--primary:210 20% 98%;--primary-foreground:220.9 39.3% 11%;--secondary:215 27.9% 16.9%;--secondary-foreground:210 20% 98%;--accent:215 27.9% 16.9%;--accent-foreground:210 20% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:210 20% 98%;--ring:216 12.2% 83.9%}.theme-neutral{--background:0 0% 100%;--foreground:0 0% 3.9%;--muted:0 0% 96.1%;--muted-foreground:0 0% 45.1%;--popover:0 0% 100%;--popover-foreground:0 0% 3.9%;--card:0 0% 100%;--card-foreground:0 0% 3.9%;--border:0 0% 89.8%;--input:0 0% 89.8%;--primary:0 0% 9%;--primary-foreground:0 0% 98%;--secondary:0 0% 96.1%;--secondary-foreground:0 0% 9%;--accent:0 0% 96.1%;--accent-foreground:0 0% 9%;--destructive:0 84.2% 60.2%;--destructive-foreground:0 0% 98%;--ring:0 0% 3.9%;--radius:.5rem}.dark .theme-neutral{--background:0 0% 3.9%;--foreground:0 0% 98%;--muted:0 0% 14.9%;--muted-foreground:0 0% 63.9%;--popover:0 0% 3.9%;--popover-foreground:0 0% 98%;--card:0 0% 3.9%;--card-foreground:0 0% 98%;--border:0 0% 14.9%;--input:0 0% 14.9%;--primary:0 0% 98%;--primary-foreground:0 0% 9%;--secondary:0 0% 14.9%;--secondary-foreground:0 0% 98%;--accent:0 0% 14.9%;--accent-foreground:0 0% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:0 0% 98%;--ring:0 0% 83.1%}.theme-red{--background:0 0% 100%;--foreground:0 0% 3.9%;--muted:0 0% 96.1%;--muted-foreground:0 0% 45.1%;--popover:0 0% 100%;--popover-foreground:0 0% 3.9%;--card:0 0% 100%;--card-foreground:0 0% 3.9%;--border:0 0% 89.8%;--input:0 0% 89.8%;--primary:0 72.2% 50.6%;--primary-foreground:0 85.7% 97.3%;--secondary:0 0% 96.1%;--secondary-foreground:0 0% 9%;--accent:0 0% 96.1%;--accent-foreground:0 0% 9%;--destructive:0 84.2% 60.2%;--destructive-foreground:0 0% 98%;--ring:0 72.2% 50.6%;--radius:.5rem}.dark .theme-red{--background:0 0% 3.9%;--foreground:0 0% 98%;--muted:0 0% 14.9%;--muted-foreground:0 0% 63.9%;--popover:0 0% 3.9%;--popover-foreground:0 0% 98%;--card:0 0% 3.9%;--card-foreground:0 0% 98%;--border:0 0% 14.9%;--input:0 0% 14.9%;--primary:0 72.2% 50.6%;--primary-foreground:0 85.7% 97.3%;--secondary:0 0% 14.9%;--secondary-foreground:0 0% 98%;--accent:0 0% 14.9%;--accent-foreground:0 0% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:0 0% 98%;--ring:0 72.2% 50.6%}.theme-rose{--background:0 0% 100%;--foreground:240 10% 3.9%;--muted:240 4.8% 95.9%;--muted-foreground:240 3.8% 46.1%;--popover:0 0% 100%;--popover-foreground:240 10% 3.9%;--card:0 0% 100%;--card-foreground:240 10% 3.9%;--border:240 5.9% 90%;--input:240 5.9% 90%;--primary:346.8 77.2% 49.8%;--primary-foreground:355.7 100% 97.3%;--secondary:240 4.8% 95.9%;--secondary-foreground:240 5.9% 10%;--accent:240 4.8% 95.9%;--accent-foreground:240 5.9% 10%;--destructive:0 84.2% 60.2%;--destructive-foreground:0 0% 98%;--ring:346.8 77.2% 49.8%;--radius:.5rem}.dark .theme-rose{--background:20 14.3% 4.1%;--foreground:0 0% 95%;--muted:0 0% 15%;--muted-foreground:240 5% 64.9%;--popover:0 0% 9%;--popover-foreground:0 0% 95%;--card:24 9.8% 10%;--card-foreground:0 0% 95%;--border:240 3.7% 15.9%;--input:240 3.7% 15.9%;--primary:346.8 77.2% 49.8%;--primary-foreground:355.7 100% 97.3%;--secondary:240 3.7% 15.9%;--secondary-foreground:0 0% 98%;--accent:12 6.5% 15.1%;--accent-foreground:0 0% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:0 85.7% 97.3%;--ring:346.8 77.2% 49.8%}.theme-orange{--background:0 0% 100%;--foreground:20 14.3% 4.1%;--muted:60 4.8% 95.9%;--muted-foreground:25 5.3% 44.7%;--popover:0 0% 100%;--popover-foreground:20 14.3% 4.1%;--card:0 0% 100%;--card-foreground:20 14.3% 4.1%;--border:20 5.9% 90%;--input:20 5.9% 90%;--primary:24.6 95% 53.1%;--primary-foreground:60 9.1% 97.8%;--secondary:60 4.8% 95.9%;--secondary-foreground:24 9.8% 10%;--accent:60 4.8% 95.9%;--accent-foreground:24 9.8% 10%;--destructive:0 84.2% 60.2%;--destructive-foreground:60 9.1% 97.8%;--ring:24.6 95% 53.1%;--radius:.5rem}.dark .theme-orange{--background:20 14.3% 4.1%;--foreground:60 9.1% 97.8%;--muted:12 6.5% 15.1%;--muted-foreground:24 5.4% 63.9%;--popover:20 14.3% 4.1%;--popover-foreground:60 9.1% 97.8%;--card:20 14.3% 4.1%;--card-foreground:60 9.1% 97.8%;--border:12 6.5% 15.1%;--input:12 6.5% 15.1%;--primary:20.5 90.2% 48.2%;--primary-foreground:60 9.1% 97.8%;--secondary:12 6.5% 15.1%;--secondary-foreground:60 9.1% 97.8%;--accent:12 6.5% 15.1%;--accent-foreground:60 9.1% 97.8%;--destructive:0 72.2% 50.6%;--destructive-foreground:60 9.1% 97.8%;--ring:20.5 90.2% 48.2%}.theme-green{--background:0 0% 100%;--foreground:240 10% 3.9%;--muted:240 4.8% 95.9%;--muted-foreground:240 3.8% 46.1%;--popover:0 0% 100%;--popover-foreground:240 10% 3.9%;--card:0 0% 100%;--card-foreground:240 10% 3.9%;--border:240 5.9% 90%;--input:240 5.9% 90%;--primary:142.1 76.2% 36.3%;--primary-foreground:355.7 100% 97.3%;--secondary:240 4.8% 95.9%;--secondary-foreground:240 5.9% 10%;--accent:240 4.8% 95.9%;--accent-foreground:240 5.9% 10%;--destructive:0 84.2% 60.2%;--destructive-foreground:0 0% 98%;--ring:142.1 76.2% 36.3%;--radius:.5rem}.dark .theme-green{--background:20 14.3% 4.1%;--foreground:0 0% 95%;--muted:0 0% 15%;--muted-foreground:240 5% 64.9%;--popover:0 0% 9%;--popover-foreground:0 0% 95%;--card:24 9.8% 10%;--card-foreground:0 0% 95%;--border:240 3.7% 15.9%;--input:240 3.7% 15.9%;--primary:142.1 70.6% 45.3%;--primary-foreground:144.9 80.4% 10%;--secondary:240 3.7% 15.9%;--secondary-foreground:0 0% 98%;--accent:12 6.5% 15.1%;--accent-foreground:0 0% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:0 85.7% 97.3%;--ring:142.4 71.8% 29.2%}.theme-blue{--background:0 0% 100%;--foreground:222.2 84% 4.9%;--muted:210 40% 96.1%;--muted-foreground:215.4 16.3% 46.9%;--popover:0 0% 100%;--popover-foreground:222.2 84% 4.9%;--card:0 0% 100%;--card-foreground:222.2 84% 4.9%;--border:214.3 31.8% 91.4%;--input:214.3 31.8% 91.4%;--primary:221.2 83.2% 53.3%;--primary-foreground:210 40% 98%;--secondary:210 40% 96.1%;--secondary-foreground:222.2 47.4% 11.2%;--accent:210 40% 96.1%;--accent-foreground:222.2 47.4% 11.2%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 40% 98%;--ring:221.2 83.2% 53.3%;--radius:.5rem}.dark .theme-blue{--background:222.2 84% 4.9%;--foreground:210 40% 98%;--muted:217.2 32.6% 17.5%;--muted-foreground:215 20.2% 65.1%;--popover:222.2 84% 4.9%;--popover-foreground:210 40% 98%;--card:222.2 84% 4.9%;--card-foreground:210 40% 98%;--border:217.2 32.6% 17.5%;--input:217.2 32.6% 17.5%;--primary:217.2 91.2% 59.8%;--primary-foreground:222.2 47.4% 11.2%;--secondary:217.2 32.6% 17.5%;--secondary-foreground:210 40% 98%;--accent:217.2 32.6% 17.5%;--accent-foreground:210 40% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:210 40% 98%;--ring:224.3 76.3% 48%}.theme-yellow{--background:0 0% 100%;--foreground:20 14.3% 4.1%;--muted:60 4.8% 95.9%;--muted-foreground:25 5.3% 44.7%;--popover:0 0% 100%;--popover-foreground:20 14.3% 4.1%;--card:0 0% 100%;--card-foreground:20 14.3% 4.1%;--border:20 5.9% 90%;--input:20 5.9% 90%;--primary:47.9 95.8% 53.1%;--primary-foreground:26 83.3% 14.1%;--secondary:60 4.8% 95.9%;--secondary-foreground:24 9.8% 10%;--accent:60 4.8% 95.9%;--accent-foreground:24 9.8% 10%;--destructive:0 84.2% 60.2%;--destructive-foreground:60 9.1% 97.8%;--ring:20 14.3% 4.1%;--radius:.5rem}.dark .theme-yellow{--background:20 14.3% 4.1%;--foreground:60 9.1% 97.8%;--muted:12 6.5% 15.1%;--muted-foreground:24 5.4% 63.9%;--popover:20 14.3% 4.1%;--popover-foreground:60 9.1% 97.8%;--card:20 14.3% 4.1%;--card-foreground:60 9.1% 97.8%;--border:12 6.5% 15.1%;--input:12 6.5% 15.1%;--primary:47.9 95.8% 53.1%;--primary-foreground:26 83.3% 14.1%;--secondary:12 6.5% 15.1%;--secondary-foreground:60 9.1% 97.8%;--accent:12 6.5% 15.1%;--accent-foreground:60 9.1% 97.8%;--destructive:0 62.8% 30.6%;--destructive-foreground:60 9.1% 97.8%;--ring:35.5 91.7% 32.9%}.theme-violet{--background:0 0% 100%;--foreground:224 71.4% 4.1%;--muted:220 14.3% 95.9%;--muted-foreground:220 8.9% 46.1%;--popover:0 0% 100%;--popover-foreground:224 71.4% 4.1%;--card:0 0% 100%;--card-foreground:224 71.4% 4.1%;--border:220 13% 91%;--input:220 13% 91%;--primary:262.1 83.3% 57.8%;--primary-foreground:210 20% 98%;--secondary:220 14.3% 95.9%;--secondary-foreground:220.9 39.3% 11%;--accent:220 14.3% 95.9%;--accent-foreground:220.9 39.3% 11%;--destructive:0 84.2% 60.2%;--destructive-foreground:210 20% 98%;--ring:262.1 83.3% 57.8%;--radius:.5rem}.dark .theme-violet{--background:224 71.4% 4.1%;--foreground:210 20% 98%;--muted:215 27.9% 16.9%;--muted-foreground:217.9 10.6% 64.9%;--popover:224 71.4% 4.1%;--popover-foreground:210 20% 98%;--card:224 71.4% 4.1%;--card-foreground:210 20% 98%;--border:215 27.9% 16.9%;--input:215 27.9% 16.9%;--primary:263.4 70% 50.4%;--primary-foreground:210 20% 98%;--secondary:215 27.9% 16.9%;--secondary-foreground:210 20% 98%;--accent:215 27.9% 16.9%;--accent-foreground:210 20% 98%;--destructive:0 62.8% 30.6%;--destructive-foreground:210 20% 98%;--ring:263.4 70% 50.4%}</style>
<style>.carbon-responsive-wrap{align-items:center!important;background-color:hsl(var(--background))!important;border-color:hsl(var(--border))!important;border-radius:var(--radius)!important;display:flex!important;padding:1rem!important}@media (min-width:1024px){.carbon-responsive-wrap{flex-direction:column!important;padding-bottom:1.5rem!important;padding-top:1.5rem!important}}.carbon-responsive-wrap .carbon-img{border-radius:.25rem!important;overflow:hidden!important}@media (min-width:1024px){.carbon-responsive-wrap .carbon-img{flex:none!important}}.carbon-responsive-wrap .carbon-text{color:hsl(var(--muted-foreground))!important;font-size:.875rem!important;line-height:1.25rem!important}@media (min-width:1024px){.carbon-responsive-wrap .carbon-text{flex:none!important;text-align:center!important}}#carbonads .carbon-poweredby{background-color:hsl(var(--background))!important;color:hsl(var(--muted-foreground))!important;display:block!important;font-size:10px!important;text-align:right!important;text-decoration-line:none!important;text-transform:uppercase!important}</style>
<style>.inline-code[data-v-7413e23b]:not(h1>code,h1>a>code,h2>a>code,h3>a>code,h4>a>code,h5>a>code,strong>a>code){font-size:.875rem;line-height:1.25rem}</style>
<style>pre code .line{display:block;min-height:1rem}</style>
<link rel="stylesheet" href="/_nuxt/entry.Y5sdK25x.css" crossorigin>
<link rel="stylesheet" href="/_nuxt/ProseCode.CkJZWfPY.css" crossorigin>
<style>:where(.i-lucide\:arrow-left){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m12 19l-7-7l7-7m7 7H5'/%3E%3C/svg%3E")}:where(.i-lucide\:arrow-right){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M5 12h14m-7-7l7 7l-7 7'/%3E%3C/svg%3E")}:where(.i-lucide\:arrow-up){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m5 12l7-7l7 7m-7 7V5'/%3E%3C/svg%3E")}:where(.i-lucide\:bot){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M12 8V4H8'/%3E%3Crect width='16' height='12' x='4' y='8' rx='2'/%3E%3Cpath d='M2 14h2m16 0h2m-7-1v2m-6-2v2'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:brain){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M12 5a3 3 0 1 0-5.997.125a4 4 0 0 0-2.526 5.77a4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z'/%3E%3Cpath d='M12 5a3 3 0 1 1 5.997.125a4 4 0 0 1 2.526 5.77a4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z'/%3E%3Cpath d='M15 13a4.5 4.5 0 0 1-3-4a4.5 4.5 0 0 1-3 4m8.599-6.5a3 3 0 0 0 .399-1.375m-11.995 0A3 3 0 0 0 6.401 6.5m-2.924 4.396a4 4 0 0 1 .585-.396m15.876 0a4 4 0 0 1 .585.396M6 18a4 4 0 0 1-1.967-.516m15.934 0A4 4 0 0 1 18 18'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:chevrons-up-down){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m7 15l5 5l5-5M7 9l5-5l5 5'/%3E%3C/svg%3E")}:where(.i-lucide\:copy){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Crect width='14' height='14' x='8' y='8' rx='2' ry='2'/%3E%3Cpath d='M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:database){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cellipse cx='12' cy='5' rx='9' ry='3'/%3E%3Cpath d='M3 5v14a9 3 0 0 0 18 0V5'/%3E%3Cpath d='M3 12a9 3 0 0 0 18 0'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:download){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4m4-5l5 5l5-5m-5 5V3'/%3E%3C/svg%3E")}:where(.i-lucide\:flag){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 15s1-1 4-1s5 2 8 2s4-1 4-1V3s-1 1-4 1s-5-2-8-2s-4 1-4 1zm0 7v-7'/%3E%3C/svg%3E")}:where(.i-lucide\:github){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5c.08-1.25-.27-2.48-1-3.5c.28-1.15.28-2.35 0-3.5c0 0-1 0-3 1.5c-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.4 5.4 0 0 0 4 9c0 3.5 3 5.5 6 5.5c-.39.49-.68 1.05-.85 1.65S8.93 17.38 9 18v4'/%3E%3Cpath d='M9 18c-4.51 2-5-2-7-2'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:hand){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Cpath d='M18 11V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2m0 4V4a2 2 0 0 0-2-2a2 2 0 0 0-2 2v2m0 4.5V6a2 2 0 0 0-2-2a2 2 0 0 0-2 2v8'/%3E%3Cpath d='M18 8a2 2 0 1 1 4 0v6a8 8 0 0 1-8 8h-2c-2.8 0-4.5-.86-5.99-2.34l-3.6-3.6a2 2 0 0 1 2.83-2.82L7 15'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-lucide\:menu){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 12h16M4 6h16M4 18h16'/%3E%3C/svg%3E")}:where(.i-lucide\:moon){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 3a6 6 0 0 0 9 9a9 9 0 1 1-9-9'/%3E%3C/svg%3E")}:where(.i-lucide\:paintbrush){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='m14.622 17.897l-10.68-2.913M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0zM9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15'/%3E%3C/svg%3E")}:where(.i-lucide\:sun){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cg fill='none' stroke='black' stroke-linecap='round' stroke-linejoin='round' stroke-width='2'%3E%3Ccircle cx='12' cy='12' r='4'/%3E%3Cpath d='M12 2v2m0 16v2M4.93 4.93l1.41 1.41m11.32 11.32l1.41 1.41M2 12h2m16 0h2M6.34 17.66l-1.41 1.41M19.07 4.93l-1.41 1.41'/%3E%3C/g%3E%3C/svg%3E")}:where(.i-material-symbols\:water-drop-outline){display:inline-block;width:1em;height:1em;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%;--svg:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' width='24' height='24'%3E%3Cpath fill='black' d='M12.275 19q.3-.025.513-.238T13 18.25q0-.35-.225-.562T12.2 17.5q-1.025.075-2.175-.562t-1.45-2.313q-.05-.275-.262-.45T7.825 14q-.35 0-.575.263t-.15.612q.425 2.275 2 3.25t3.175.875M12 22q-3.425 0-5.712-2.35T4 13.8q0-2.5 1.988-5.437T12 2q4.025 3.425 6.013 6.363T20 13.8q0 3.5-2.287 5.85T12 22m0-2q2.6 0 4.3-1.763T18 13.8q0-1.825-1.513-4.125T12 4.65Q9.025 7.375 7.513 9.675T6 13.8q0 2.675 1.7 4.438T12 20m0-8'/%3E%3C/svg%3E")}</style>
<link rel="preload" as="fetch" crossorigin="anonymous" href="/tutorial-llms/distilling-gpt-with-pytorch-and-transformers/_payload.json?24ab5227-b949-4975-8094-887b2c84ea55">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C7j17IRV.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CyQDfaXn.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/bNW2v16J.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DKWA3baR.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/PsOAZ8eW.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C7xt5nRh.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CN53zf1N.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/6UurnMEc.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BbjudPQF.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CLIBiAXB.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CA4y_Fyj.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/B7toWlS9.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/DbIATBfm.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/-3gD0Q7m.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Cl801SEx.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/Bq6OFfQP.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/WMTg_7Ki.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CZ07cSls.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/QvWBzIne.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/BgFDL6Xm.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/CmoTKk0Z.js">
<link rel="modulepreload" as="script" crossorigin href="/_nuxt/C5D6stIC.js">
<link rel="preload" as="fetch" fetchpriority="low" crossorigin="anonymous" href="/_nuxt/builds/meta/24ab5227-b949-4975-8094-887b2c84ea55.json">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/GWyod6Ne.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/CQF6mwq8.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/bNaE6FFb.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/Cevy56y0.js">
<link rel="prefetch" as="script" crossorigin href="/_nuxt/DKp7k9Ww.js">
<meta property="og:image" content="https://cybernachos.github.io/__og-image__/static/tutorial-llms/distilling-gpt-with-pytorch-and-transformers/og.png">
<meta property="og:image:type" content="image/png">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://cybernachos.github.io/__og-image__/static/tutorial-llms/distilling-gpt-with-pytorch-and-transformers/og.png">
<meta name="twitter:image:src" content="https://cybernachos.github.io/__og-image__/static/tutorial-llms/distilling-gpt-with-pytorch-and-transformers/og.png">
<meta property="og:image:width" content="1200">
<meta name="twitter:image:width" content="1200">
<meta property="og:image:height" content="600">
<meta name="twitter:image:height" content="600">
<meta name="description" content="A step-by-step tutorial demonstrating how to distill GPT models using the PyTorch and Hugging Face Transformers libraries.">
<meta property="og:description" content="A step-by-step tutorial demonstrating how to distill GPT models using the PyTorch and Hugging Face Transformers libraries.">
<meta property="og:title" content="Distilling GPT with PyTorch and Transformers">
<script type="module" src="/_nuxt/C7j17IRV.js" crossorigin></script><script>"use strict";(()=>{const t=window,e=document.documentElement,c=["dark","light"],n=getStorageValue("localStorage","nuxt-color-mode")||"system";let i=n==="system"?u():n;const r=e.getAttribute("data-color-mode-forced");r&&(i=r),l(i),t["__NUXT_COLOR_MODE__"]={preference:n,value:i,getColorScheme:u,addColorScheme:l,removeColorScheme:d};function l(o){const s=""+o+"",a="";e.classList?e.classList.add(s):e.className+=" "+s,a&&e.setAttribute("data-"+a,o)}function d(o){const s=""+o+"",a="";e.classList?e.classList.remove(s):e.className=e.className.replace(new RegExp(s,"g"),""),a&&e.removeAttribute("data-"+a)}function f(o){return t.matchMedia("(prefers-color-scheme"+o+")")}function u(){if(t.matchMedia&&f("").media!=="not all"){for(const o of c)if(f(":"+o).matches)return o}return"light"}})();function getStorageValue(t,e){switch(t){case"localStorage":return window.localStorage.getItem(e);case"sessionStorage":return window.sessionStorage.getItem(e);case"cookie":return getCookie(e);default:return null}}function getCookie(t){const c=("; "+window.document.cookie).split("; "+t+"=");if(c.length===2)return c.pop()?.split(";").shift()}</script></head><body  class="theme-zinc" style="--radius:0.5rem"><div id="__nuxt"><!--[--><div class="nuxt-loading-indicator z-100 bg-primary/80" style="position:fixed;top:0;right:0;left:0;pointer-events:none;width:auto;height:3px;opacity:0;background-size:Infinity% auto;transform:scaleX(0%);transform-origin:left;transition:transform 0.1s, height 0.4s, opacity 0.4s;z-index:999999;"></div><!----><header class="sticky top-0 z-40 bg-background/80 backdrop-blur-lg"><div class="container max-w-screen-2xl flex h-14 items-center justify-between gap-2 px-4 md:px-8"><div class="hidden flex-1 md:flex"><a href="/" class="flex"><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" data-nuxt-img srcset="/_ipx/_/transparent-logo.svg 1x, /_ipx/_/transparent-logo.svg 2x" class="h-7 dark:hidden" src="/_ipx/_/transparent-logo.svg"><img onerror="this.setAttribute(&#39;data-error&#39;, 1)" data-nuxt-img srcset="/_ipx/_/transparent-logo.svg 1x, /_ipx/_/transparent-logo.svg 2x" class="hidden h-7 dark:block" src="/_ipx/_/transparent-logo.svg"><span class="ml-3 self-center font-bold">Cyber Nachos</span></a></div><!--[--><!--[--><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground size-10 md:hidden" type="button" aria-haspopup="dialog" aria-expanded="false" data-state="closed"><!--[--><span class="iconify i-lucide:menu" aria-hidden="true" style="font-size:18px;"></span><!--]--></button><!----><!--]--><!--]--><!----><nav aria-label="Main" data-orientation="horizontal" dir="ltr" data-radix-navigation-menu class="relative z-10 max-w-max items-center justify-center hidden flex-1 lg:flex"><!--[--><!--[--><div style="position:relative;"><ul class="group flex flex-1 list-none items-center justify-center gap-x-1" data-orientation="horizontal"><!--[--><!--]--></ul></div><!--]--><div class="absolute left-0 top-full flex justify-center"><!----></div><!--]--></nav><div class="flex flex-1 justify-end gap-2"><a href="/promptrobot" class=""><button class="items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground rounded-md px-3 flex gap-2 h-8 mt-1"><!--[--> Prompt Robotics <!--]--></button></a><!--[--><!--[--><button class="inline-flex items-center justify-center whitespace-nowrap text-sm ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent px-4 py-2 h-8 w-full self-center rounded-md pr-1.5 font-normal text-muted-foreground hover:text-accent-foreground md:w-40 lg:w-64"><!--[--><span class="mr-auto overflow-hidden">Search...</span><kbd class="pointer-events-none inline-flex h-5 select-none items-center gap-1 rounded border border-border bg-muted font-sans font-medium min-h-5 text-[11px] h-5 px-1 ml-auto hidden md:block"><!--[--><span class="text-xs">⌘</span>K <!--]--></kbd><!--]--></button><!--]--><!--[--><!--[--><!----><!--]--><!--]--><!--]--><div class="flex"><!----><!--[--><!--[--><!--[--><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground size-10" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls data-state="closed"><!--[--><span class="iconify i-lucide:paintbrush" aria-hidden="true" style="font-size:16px;"></span><!--]--></button><!----><!--]--><!--]--><!--]--><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground size-10"><!--[--><span class="iconify i-lucide:sun rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0" aria-hidden="true" style="font-size:18px;"></span><span class="iconify i-lucide:moon absolute rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100" aria-hidden="true" style="font-size:18px;"></span><span class="sr-only">Toggle theme</span><!--]--></button><!--[--><a href="https://github.com/CyberNachos" rel="noopener noreferrer" target="_blank"><button class="items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground size-10 flex gap-2"><!--[--><span class="iconify i-lucide:github" aria-hidden="true" style="font-size:18px;"></span><!--]--></button></a><!--]--></div></div></div><!----></header><div class="min-h-screen border-b"><div class="container md:grid-cols-[220px_minmax(0,1fr)] lg:grid-cols-[240px_minmax(0,1fr)] flex-1 items-start px-4 md:grid md:gap-6 md:px-8 lg:gap-10"><aside class="fixed top-[102px] z-30 -ml-2 hidden h-[calc(100vh-3.5rem)] w-full shrink-0 overflow-y-auto md:sticky md:top-[60px] md:block"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative h-full overflow-hidden py-6 pr-6 text-sm md:pr-4" orientation="vertical"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><!----><!----><!----><ul class="flex flex-col gap-1 py-1 pt-1"><!--[--><li><a href="/cybernachos" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:hand min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Cyber Nachos</span><!--[--><!--]--><!--]--></a></li><li><div><!--[--><div class="h-8 mt-2 flex items-center gap-2 rounded-md px-2 text-xs font-semibold text-foreground/70 outline-none"><!--[--><!----><span class="truncate text-nowrap">Published Products</span><!--[--><!--]--><!--]--></div><ul class="flex flex-col gap-1 py-1"><!--[--><li><a href="/published/cybernachos-gpt" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:brain min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Cyber Nachos GPT</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></div></li><li><div><!--[--><div class="h-8 mt-2 flex items-center gap-2 rounded-md px-2 text-xs font-semibold text-foreground/70 outline-none"><!--[--><!----><span class="truncate text-nowrap">Tutorial Isaac Lab</span><!--[--><!--]--><!--]--></div><ul class="flex flex-col gap-1 py-1"><!--[--><li><a href="/tutorial-isaaclab/introduction" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:bot min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Introduction</span><!--[--><!--]--><!--]--></a></li><li><a href="/tutorial-isaaclab/installation" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:download min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Installation Guide</span><!--[--><!--]--><!--]--></a></li><li><a href="/tutorial-isaaclab/getting-started" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:flag min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Getting Started</span><!--[--><!--]--><!--]--></a></li><li><a href="/tutorial-isaaclab/enable-fluid" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-material-symbols:water-drop-outline min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Enabling fluid simulation</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></div></li><li><div><!--[--><div class="h-8 mt-2 flex items-center gap-2 rounded-md px-2 text-xs font-semibold text-foreground/70 outline-none"><!--[--><!----><span class="truncate text-nowrap">Tutorial LLMs</span><!--[--><!--]--><!--]--></div><ul class="flex flex-col gap-1 py-1"><!--[--><li><a aria-current="page" href="/tutorial-llms/distilling-gpt-with-pytorch-and-transformers" class="router-link-active router-link-exact-active flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary bg-muted !text-primary h-8"><!--[--><span class="iconify i-lucide:brain min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Distilling GPT with PyTorch and Transformers</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></div></li><li><div><!--[--><div class="h-8 mt-2 flex items-center gap-2 rounded-md px-2 text-xs font-semibold text-foreground/70 outline-none"><!--[--><!----><span class="truncate text-nowrap">Published Research Papers</span><!--[--><!--]--><!--]--></div><ul class="flex flex-col gap-1 py-1"><!--[--><li><a href="/published-research/real-time-dexterous" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:bot min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Real-time Dexterous Telemanipulation</span><!--[--><!--]--><!--]--></a></li><li><a href="/published-research/hallucination" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:brain min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Hallucination Prevention in LLMs</span><!--[--><!--]--><!--]--></a></li><li><a href="/published-research/ai-anchor" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:brain min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">AI Anchor Framework</span><!--[--><!--]--><!--]--></a></li><li><a href="/published-research/ai-productivity" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:brain min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">AI as the Cognitive Engine of Productivity</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></div></li><li><div><!--[--><div class="h-8 mt-2 flex items-center gap-2 rounded-md px-2 text-xs font-semibold text-foreground/70 outline-none"><!--[--><!----><span class="truncate text-nowrap">Robotics Overview</span><!--[--><!--]--><!--]--></div><ul class="flex flex-col gap-1 py-1"><!--[--><li><a href="/robotics-overview/robotics-datasets" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:database min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Robotics Dataset Comparison</span><!--[--><!--]--><!--]--></a></li><li><a href="/robotics-overview/robotics-models" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:bot min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">General-Purpose Robot Models Analysis</span><!--[--><!--]--><!--]--></a></li><li><a href="/robotics-overview/wheel-based-robots" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:bot min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Wheel-Based Humanoid Robots</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></div></li><li><div><!--[--><div class="h-8 mt-2 flex items-center gap-2 rounded-md px-2 text-xs font-semibold text-foreground/70 outline-none"><!--[--><!----><span class="truncate text-nowrap">Posts</span><!--[--><!--]--><!--]--></div><ul class="flex flex-col gap-1 py-1"><!--[--><li><a href="/posts/robotic-sociology" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><span class="iconify i-lucide:bot min-w-4" aria-hidden="true" style="font-size:16px;"></span><span class="truncate text-nowrap">Robotic Sociology: Human-Robot Interaction and the Emergence of Machine Social Structures</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--></div></li><li><a href="/promptrobot" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><!----><span class="truncate text-nowrap">Promptrobot</span><!--[--><!--]--><!--]--></a></li><li><a href="/terms" class="flex items-center gap-2 rounded-md p-2 text-sm text-foreground/80 hover:bg-muted hover:text-primary h-8"><!--[--><!----><span class="truncate text-nowrap">Terms of Service &amp; User Agreement</span><!--[--><!--]--><!--]--></a></li><!--]--></ul><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></aside><!--[--><main class="lg:grid lg:grid-cols-[1fr_220px] lg:gap-14 lg:py-8 relative py-6"><div class="mx-auto w-full min-w-0"><!----><div class="mb-6"><h1 class="scroll-m-20 text-4xl font-extrabold tracking-tight lg:text-5xl"><!--[-->Distilling GPT with PyTorch and Transformers<!--]--></h1><p class="pt-1 text-lg text-muted-foreground"></p><!----><!----></div><div class="docs-content"><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->This tutorial explains how to distill GPT2 into a smaller <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->distilgpt2<!--]--></code> model. The entire pipeline includes:<!--]--></p><ol class="ml-6 list-decimal [&amp;:not(:first-child)]:mt-6 [&amp;:not(:last-child)]:mb-6 [&amp;&gt;li:not(:first-child)]:mt-2"><!--[--><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Setting up a stable training environment.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Loading teacher (<code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->gpt2<!--]--></code>) and student (<code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->distilgpt2<!--]--></code>) models.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Using data augmentation (if desired).<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Applying improved preprocessing steps.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Implementing label smoothing.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Using a custom distillation loss function.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Training and evaluating the distilled model.<!--]--></li><!--]--></ol><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Throughout the tutorial, you&#39;ll see how to train the student model using teacher outputs (knowledge distillation) while also retaining some direct supervision from ground-truth labels (hard loss). This balance is configured with a parameter <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->alpha<!--]--></code>.<!--]--></p><h2 id="prerequisites" class="scroll-m-20 border-b pb-2 text-3xl font-semibold tracking-tight transition-colors [&amp;:not(:first-child)]:mt-10"><a href="#prerequisites"><!--[-->Prerequisites<!--]--></a></h2><ul class="ml-6 list-disc [&amp;:not(:first-child)]:mt-6 [&amp;:not(:last-child)]:mb-6 [&amp;&gt;li:not(:first-child)]:mt-2"><!--[--><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[--><a href="https://pytorch.org/" rel="nofollow" class="font-semibold underline underline-offset-4"><!--[-->PyTorch<!--]--></a> (for building and training neural networks)<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[--><a href="https://github.com/huggingface/transformers" rel="nofollow" class="font-semibold underline underline-offset-4"><!--[-->Hugging Face Transformers<!--]--></a> (for pretrained transformer models)<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[--><a href="https://huggingface.co/docs/datasets/" rel="nofollow" class="font-semibold underline underline-offset-4"><!--[-->Datasets<!--]--></a> (to load and process datasets)<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Basic familiarity with Python and deep learning concepts<!--]--></li><!--]--></ul><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Ensure you have installed these packages before proceeding:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-bash shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">pip</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> install</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> torch</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> transformers</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> datasets
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><h2 id="full-code" class="scroll-m-20 border-b pb-2 text-3xl font-semibold tracking-tight transition-colors [&amp;:not(:first-child)]:mt-10"><a href="#full-code"><!--[-->Full Code<!--]--></a></h2><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Below is the complete code for the distillation workflow. You can save it in a file named <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->Distill_GPT.py<!--]--></code> (or any name you prefer) and run it. Comments in the code are partly in Chinese, but each section is explained in English below the code blocks.<!--]--></p><div data-state="closed" class="space-y-2"><!--[--><!--[--><div class="flex items-center justify-between space-x-4"><h4 class="text-sm font-semibold"><!--[--><!--]--> Click to expand the code</h4><button class="inline-flex items-center justify-center whitespace-nowrap text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground h-9 rounded-md w-9 p-0" type="button" aria-controls aria-expanded="false" data-state="closed"><!--[--><span class="iconify i-lucide:chevrons-up-down" aria-hidden="true" style=""></span><span class="sr-only">Toggle</span><!--]--></button></div><div class="overflow-hidden transition-all data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down space-y-2" id="radix-vue-collapsible-content-v-20-9-0" data-state="closed" hidden style="--radix-collapsible-content-height:0px;--radix-collapsible-content-width:0px;"><!----></div><!--]--><!--]--></div><h2 id="explanation-of-key-steps" class="scroll-m-20 border-b pb-2 text-3xl font-semibold tracking-tight transition-colors [&amp;:not(:first-child)]:mt-10"><a href="#explanation-of-key-steps"><!--[-->Explanation of Key Steps<!--]--></a></h2><h3 id="_1-device-setup" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_1-device-setup"><!--[-->1. Device Setup<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We detect whether a GPU is available using <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->torch.cuda.is_available()<!--]--></code>:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">device </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> torch.device(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;cuda&quot;</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583"> if</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> torch.cuda.is_available() </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">else</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> &quot;cpu&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->This ensures our model will train on GPU if available, otherwise on CPU.<!--]--></p><h3 id="_2-choosing-stable-base-models" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_2-choosing-stable-base-models"><!--[-->2. Choosing Stable Base Models<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We define the teacher and student models:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">teacher_model_name </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> &quot;gpt2&quot;
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">student_model_name </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF"> &quot;distilgpt2&quot;
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Feel free to switch them to other models (like GPT-Neo or GPT-J) if you wish, as long as they match a causal language modeling architecture.<!--]--></p><h3 id="_3-loading-models-in-fp32-adjusting-dropout" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_3-loading-models-in-fp32-adjusting-dropout"><!--[-->3. Loading Models in FP32 &amp; Adjusting Dropout<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We load both teacher and student in FP32 for more stable training. We also increase the dropout for the student model to reduce overfitting:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">teacher_model </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> AutoModelForCausalLM.from_pretrained(
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    teacher_model_name, 
</span></span><span class="line" line="3"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    device_map</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;auto&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, 
</span></span><span class="line" line="4"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    torch_dtype</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">torch.float32
</span></span><span class="line" line="5"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">).eval()
</span></span><span class="line" line="6"><span emptylineplaceholder="true">
</span></span><span class="line" line="7"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">student_model </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> AutoModelForCausalLM.from_pretrained(
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    student_model_name, 
</span></span><span class="line" line="9"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    device_map</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;auto&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, 
</span></span><span class="line" line="10"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    torch_dtype</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">torch.float32
</span></span><span class="line" line="11"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="12"><span style="--shiki-default:#6A737D;--shiki-dark:#6A737D"># Increase dropout
</span></span><span class="line" line="13"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">student_model.config.attn_pdrop </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF"> 0.1
</span></span><span class="line" line="14"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">...
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><h3 id="_4-loading-the-tokenizer" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_4-loading-the-tokenizer"><!--[-->4. Loading the Tokenizer<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We use the same tokenizer as our teacher model for consistency:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">tokenizer </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> AutoTokenizer.from_pretrained(teacher_model_name)
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">tokenizer.pad_token </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> tokenizer.eos_token
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We set <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->pad_token<!--]--></code> to <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->eos_token<!--]--></code> to ensure all sequences are padded consistently.<!--]--></p><h3 id="_5-data-augmentation" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_5-data-augmentation"><!--[-->5. Data Augmentation<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Here, you can optionally include text augmentation techniques (synonym replacements, random insertions, etc.). Currently, this function returns the original text.<!--]--></p><h3 id="_6-improved-data-preprocessing" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_6-improved-data-preprocessing"><!--[-->6. Improved Data Preprocessing<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We perform minimal text cleaning and tokenization:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0"> tokenize_function</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">(examples):
</span></span><span class="line" line="2"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    ...
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    tokenized </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> tokenizer(
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">        processed_texts, 
</span></span><span class="line" line="5"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">        truncation</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">True</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, 
</span></span><span class="line" line="6"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">        max_length</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">128</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, 
</span></span><span class="line" line="7"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">        padding</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;max_length&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, 
</span></span><span class="line" line="8"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">        return_tensors</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;pt&quot;
</span></span><span class="line" line="9"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    )
</span></span><span class="line" line="10"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    ...
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We remove texts that are too short (less than 10 characters). This helps avoid training with trivial examples.<!--]--></p><h3 id="_7-loading-splitting-the-openwebtext-dataset" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_7-loading-splitting-the-openwebtext-dataset"><!--[-->7. Loading &amp; Splitting the OpenWebText Dataset<!--]--></a></h3><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">dataset </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> load_dataset(</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;openwebtext&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">dataset </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> dataset[</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;train&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">].train_test_split(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">test_size</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">0.1</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->The dataset is split into training (90%) and testing (10%). We then map our <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->tokenize_function<!--]--></code> to tokenize the entire dataset.<!--]--></p><h3 id="_8-dataloader-configuration" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_8-dataloader-configuration"><!--[-->8. DataLoader Configuration<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We create PyTorch DataLoaders for both training and testing, defining a custom <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->collate_fn<!--]--></code> that moves tensors to the correct device:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0"> collate_fn</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">(batch):
</span></span><span class="line" line="2"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    ...
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">train_loader </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> DataLoader(</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, </span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">collate_fn</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">collate_fn)
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><h3 id="_9-label-smoothing" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_9-label-smoothing"><!--[-->9. Label Smoothing<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->A custom class <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->LabelSmoothingCrossEntropy<!--]--></code> is implemented to mitigate overconfidence in predictions. We replace the typical cross-entropy loss with label smoothing:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">class</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0"> LabelSmoothingCrossEntropy</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">(</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">nn</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">.</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0">Module</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    ...
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">label_smoothing_loss_fn </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> LabelSmoothingCrossEntropy(</span><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">smoothing</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">0.1</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><h3 id="_10-improved-distillation-loss-function" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_10-improved-distillation-loss-function"><!--[-->10. Improved Distillation Loss Function<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->The <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->distillation_loss<!--]--></code> function calculates:<!--]--></p><ol class="ml-6 list-decimal [&amp;:not(:first-child)]:mt-6 [&amp;:not(:last-child)]:mb-6 [&amp;&gt;li:not(:first-child)]:mt-2"><!--[--><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[--><strong class="font-semibold"><!--[-->Hard Loss<!--]--></strong>: computed via label smoothing (<code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->label_smoothing_loss_fn<!--]--></code>).<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[--><strong class="font-semibold"><!--[-->Soft Loss<!--]--></strong>: a Kullback-Leibler divergence between teacher and student logits, scaled by a <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->temperature<!--]--></code>.<!--]--></li><!--]--></ol><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0"> distillation_loss</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">(student_outputs, teacher_outputs, labels, temperature</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">3.0</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, alpha</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">0.7</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    ...
</span></span><span class="line" line="3"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">    return</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> alpha </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> hard_loss </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">+</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> (</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">1</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583"> -</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> alpha) </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">*</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> soft_loss
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->The parameter <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->alpha<!--]--></code> balances between hard and soft losses.<!--]--></p><h3 id="_11-training-loop" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_11-training-loop"><!--[-->11. Training Loop<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We define <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->train_student<!--]--></code> to run through multiple epochs of training:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">def</span><span style="--shiki-default:#6F42C1;--shiki-dark:#B392F0"> train_student</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">(student_model, teacher_model, train_loader, epochs</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">3</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, lr</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">3e-6</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, output_dir</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;distilled_model&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">):
</span></span><span class="line" line="2"><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">    ...
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->During each batch:<!--]--></p><ol class="ml-6 list-decimal [&amp;:not(:first-child)]:mt-6 [&amp;:not(:last-child)]:mb-6 [&amp;&gt;li:not(:first-child)]:mt-2"><!--[--><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->The teacher model generates logits.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->The student model generates logits.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->We compute the distillation loss and backpropagate.<!--]--></li><!--]--></ol><h3 id="_12-model-evaluation" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_12-model-evaluation"><!--[-->12. Model Evaluation<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We generate text from both teacher and student models on the test set using:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">model.generate(</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">...</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We collect a few samples to compare their outputs.<!--]--></p><h3 id="_13-running-the-training" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_13-running-the-training"><!--[-->13. Running the Training<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Here, we call <code class="inline-code relative rounded bg-muted px-[0.3rem] py-[0.2rem] font-mono" data-v-7413e23b><!--[-->train_student(...)<!--]--></code> with the desired parameters:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">trained_model </span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8"> train_student(
</span></span><span class="line" line="2"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    student_model,
</span></span><span class="line" line="3"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    teacher_model,
</span></span><span class="line" line="4"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">    train_loader,
</span></span><span class="line" line="5"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    epochs</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">2</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">, 
</span></span><span class="line" line="6"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    lr</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#005CC5;--shiki-dark:#79B8FF">3e-6</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">,
</span></span><span class="line" line="7"><span style="--shiki-default:#E36209;--shiki-dark:#FFAB70">    output_dir</span><span style="--shiki-default:#D73A49;--shiki-dark:#F97583">=</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">output_model_dir
</span></span><span class="line" line="8"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">)
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Adjust epochs or learning rate as needed.<!--]--></p><h3 id="_14-saving-the-final-model" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_14-saving-the-final-model"><!--[-->14. Saving the Final Model<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We save the student model&#39;s final state dictionary:<!--]--></p><div class="rounded-lg border bg-card text-card-foreground shadow-sm relative overflow-hidden [&amp;:not(:first-child)]:mt-5 [&amp;:not(:last-child)]:mb-5"><!--[--><!----><span class="absolute right-3 top-3 z-10"><div class="flex"><div><span class="iconify i-lucide:copy block cursor-pointer self-center text-muted-foreground hover:text-primary" aria-hidden="true" style=""></span></div></div></span><div class="bg-muted/30"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="overflow-x-auto py-3 text-sm inline-copy"><!--[--><pre class="language-python shiki shiki-themes github-light github-dark" style=""><!--[--><code><span class="line" line="1"><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">torch.save(trained_model.state_dict(), os.path.join(output_model_dir, </span><span style="--shiki-default:#032F62;--shiki-dark:#9ECBFF">&quot;final_distilled_model.pt&quot;</span><span style="--shiki-default:#24292E;--shiki-dark:#E1E4E8">))
</span></span></code><!--]--></pre><!--]--></div><!----><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div><!--]--></div><h3 id="_15-16-comparison-and-saving-outputs" class="scroll-m-20 text-2xl font-semibold tracking-tight [&amp;:not(:first-child)]:mt-8"><a href="#_15-16-comparison-and-saving-outputs"><!--[-->15-16. Comparison and Saving Outputs<!--]--></a></h3><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->We generate a few samples from both teacher and student and write them to a text file to visually compare performance.<!--]--></p><h2 id="conclusion" class="scroll-m-20 border-b pb-2 text-3xl font-semibold tracking-tight transition-colors [&amp;:not(:first-child)]:mt-10"><a href="#conclusion"><!--[-->Conclusion<!--]--></a></h2><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->You have now completed a step-by-step guide for distilling a GPT model (GPT2) into a smaller student (DistilGPT2). This approach balances teacher-derived knowledge (soft labels) with the original ground truth (hard labels) to produce a more compact yet capable model.<!--]--></p><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Feel free to modify:<!--]--></p><ul class="ml-6 list-disc [&amp;:not(:first-child)]:mt-6 [&amp;:not(:last-child)]:mb-6 [&amp;&gt;li:not(:first-child)]:mt-2"><!--[--><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->The data augmentation logic.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->The temperature and alpha parameters in the distillation loss.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->The dropout rates.<!--]--></li><li class="[&amp;&gt;ol]:!mt-2 [&amp;&gt;ul]:!mt-2"><!--[-->Other hyperparameters (batch size, learning rate, epochs, etc.).<!--]--></li><!--]--></ul><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Experiment with these settings to find the best trade-off between performance and model size. Good luck distilling!<!--]--></p><style>html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}</style></div><div class="mt-16"><div class="mb-6 flex w-full items-center justify-between"><!----><div class="w-fit"><button class="inline-flex items-center justify-center whitespace-nowrap rounded-md ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 underline-offset-4 hover:underline h-10 px-4 py-2 text-sm font-semibold text-primary"><!--[--><div class="flex items-center gap-2"><span class="iconify i-lucide:arrow-up" aria-hidden="true" style="font-size:16px;"></span><span>Back to Top</span></div><!--]--></button></div><div class="text-sm text-gray-500"> Last modified on: Aprl 6, 2025</div></div><div class="border-t pt-6 lg:flex lg:flex-row"><a href="/tutorial-isaaclab/enable-fluid" class="basis-1/3"><div class="mb-4 space-y-2 rounded-lg border p-4 transition-all hover:bg-muted/50"><div class="flex flex-row gap-3"><div class="flex size-6 min-w-6"><span class="iconify i-lucide:arrow-left mx-auto self-center" aria-hidden="true" style="font-size:20px;"></span></div><span class="space-y-2 self-center"><div class="text-lg font-semibold">Enabling fluid simulation</div><div class="text-sm text-muted-foreground">A guide to enable fluid simulation in Isaac Lab for reinforcement learning training.</div></span><!----></div></div></a><span class="flex-1"></span><a href="/published-research/real-time-dexterous" class="basis-1/3"><div class="mb-4 space-y-2 rounded-lg border p-4 transition-all hover:bg-muted/50"><div class="flex flex-row gap-3"><!----><span class="space-y-2 self-center"><div class="text-lg font-semibold">Real-time Dexterous Telemanipulation</div><div class="text-sm text-muted-foreground">Real-time Dexterous Telemanipulation with an End-Effect-Oriented Learning-based Approach</div></span><div class="ml-auto flex size-6 min-w-6"><span class="iconify i-lucide:arrow-right mx-auto self-center" aria-hidden="true" style="font-size:20px;"></span></div></div></div></a></div><div class="flex"><!----></div></div></div><div class="hidden text-sm lg:block"><div class="sticky top-[90px] h-[calc(100vh-3.5rem)] overflow-hidden"><div dir="ltr" style="position:relative;--radix-scroll-area-corner-width:0px;--radix-scroll-area-corner-height:0px;" class="relative overflow-hidden z-30 hidden h-[calc(100vh-6.5rem)] overflow-y-auto md:block lg:block" orientation="vertical"><!--[--><!--[--><div data-radix-scroll-area-viewport style="overflow-x:hidden;overflow-y:hidden;" class="size-full rounded-[inherit]" tabindex="0"><div style=""><!--[--><!--[--><div class="flex h-[calc(100vh-6.5rem)] flex-col"><div><p class="mb-2 text-base font-semibold">On This Page</p><ul class=""><!--[--><li class="pt-2"><a href="#prerequisites" class="text-muted-foreground transition-all hover:text-primary">Prerequisites</a><!----></li><li class="pt-2"><a href="#full-code" class="text-muted-foreground transition-all hover:text-primary">Full Code</a><!----></li><li class="pt-2"><a href="#explanation-of-key-steps" class="text-muted-foreground transition-all hover:text-primary">Explanation of Key Steps</a><ul class="pl-4"><!--[--><li class="pt-2"><a href="#_1-device-setup" class="text-muted-foreground transition-all hover:text-primary">1. Device Setup</a><!----></li><li class="pt-2"><a href="#_2-choosing-stable-base-models" class="text-muted-foreground transition-all hover:text-primary">2. Choosing Stable Base Models</a><!----></li><li class="pt-2"><a href="#_3-loading-models-in-fp32-adjusting-dropout" class="text-muted-foreground transition-all hover:text-primary">3. Loading Models in FP32 &amp; Adjusting Dropout</a><!----></li><li class="pt-2"><a href="#_4-loading-the-tokenizer" class="text-muted-foreground transition-all hover:text-primary">4. Loading the Tokenizer</a><!----></li><li class="pt-2"><a href="#_5-data-augmentation" class="text-muted-foreground transition-all hover:text-primary">5. Data Augmentation</a><!----></li><li class="pt-2"><a href="#_6-improved-data-preprocessing" class="text-muted-foreground transition-all hover:text-primary">6. Improved Data Preprocessing</a><!----></li><li class="pt-2"><a href="#_7-loading-splitting-the-openwebtext-dataset" class="text-muted-foreground transition-all hover:text-primary">7. Loading &amp; Splitting the OpenWebText Dataset</a><!----></li><li class="pt-2"><a href="#_8-dataloader-configuration" class="text-muted-foreground transition-all hover:text-primary">8. DataLoader Configuration</a><!----></li><li class="pt-2"><a href="#_9-label-smoothing" class="text-muted-foreground transition-all hover:text-primary">9. Label Smoothing</a><!----></li><li class="pt-2"><a href="#_10-improved-distillation-loss-function" class="text-muted-foreground transition-all hover:text-primary">10. Improved Distillation Loss Function</a><!----></li><li class="pt-2"><a href="#_11-training-loop" class="text-muted-foreground transition-all hover:text-primary">11. Training Loop</a><!----></li><li class="pt-2"><a href="#_12-model-evaluation" class="text-muted-foreground transition-all hover:text-primary">12. Model Evaluation</a><!----></li><li class="pt-2"><a href="#_13-running-the-training" class="text-muted-foreground transition-all hover:text-primary">13. Running the Training</a><!----></li><li class="pt-2"><a href="#_14-saving-the-final-model" class="text-muted-foreground transition-all hover:text-primary">14. Saving the Final Model</a><!----></li><li class="pt-2"><a href="#_15-16-comparison-and-saving-outputs" class="text-muted-foreground transition-all hover:text-primary">15-16. Comparison and Saving Outputs</a><!----></li><!--]--></ul></li><li class="pt-2"><a href="#conclusion" class="text-muted-foreground transition-all hover:text-primary">Conclusion</a><!----></li><!--]--></ul><div class="pt-5 text-muted-foreground"><!--[--><!--]--></div></div><div class="flex-grow"></div><!----></div><!--]--><!--]--></div></div><style> /* Hide scrollbars cross-browser and enable momentum scroll for touch devices */ [data-radix-scroll-area-viewport] { scrollbar-width:none; -ms-overflow-style:none; -webkit-overflow-scrolling:touch; } [data-radix-scroll-area-viewport]::-webkit-scrollbar { display:none; } </style><!--]--><!----><!----><!--]--></div></div></div></main><!--]--></div></div><!--[--><!--[--><!--[--><!--]--><div role="region" aria-label="Notifications (F8)" tabindex="-1" style="pointer-events:none;"><!--[--><!----><ol tabindex="-1" class="fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]"><!--[--><!--]--></ol><!----><!--]--></div><!--]--><!--]--><footer class="py-6 text-muted-foreground md:px-8 md:py-0"><div class="container flex flex-col items-center justify-between gap-2 md:h-24 md:flex-row"><!--[--><div class="text-sm"><p class="leading-7 [&amp;:not(:first-child)]:mt-6"><!--[-->Copyright © 2025<!--]--></p></div><!--]--><span class="flex-1"></span><!--[--><a href="https://github.com/CyberNachos" rel="noopener noreferrer" target="_blank"><button class="items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground size-10 flex gap-2"><!--[--><span class="iconify i-lucide:github" aria-hidden="true" style="font-size:20px;"></span><!----><!--]--></button></a><!--]--></div></footer><!--]--></div><div id="teleports"></div>
<script type="application/json" data-nuxt-data="nuxt-app" data-ssr="true" id="__NUXT_DATA__" data-src="/tutorial-llms/distilling-gpt-with-pytorch-and-transformers/_payload.json?24ab5227-b949-4975-8094-887b2c84ea55">[{"state":1,"once":6633,"_errors":6634,"serverRendered":5,"path":11,"prerenderedAt":6637},["Reactive",2],{"$scolor-mode":3,"$sdd-pages":7,"$sdd-surrounds":6524,"$sdd-globals":6548,"$sdd-navigation":6550,"$sdocs-collapsed-map":6624,"$ssite-config":6625},{"preference":4,"value":4,"unknown":5,"forced":6},"system",true,false,["ShallowRef",8],["ShallowReactive",9],{"/tutorial-llms/distilling-gpt-with-pytorch-and-transformers":10},{"_path":11,"_dir":12,"_draft":6,"_partial":6,"_locale":13,"title":14,"description":15,"icon":16,"lastModified":17,"body":18,"_type":6517,"_id":6518,"_source":6519,"_file":6520,"_stem":6521,"_extension":6522,"layout":6523},"/tutorial-llms/distilling-gpt-with-pytorch-and-transformers","tutorial-llms","","Distilling GPT with PyTorch and Transformers","A step-by-step tutorial demonstrating how to distill GPT models using the PyTorch and Hugging Face Transformers libraries.","lucide:brain","Aprl 6, 2025",{"type":19,"children":20,"toc":6495},"root",[21,38,93,106,113,160,165,208,214,227,5140,5146,5153,5166,5212,5217,5223,5228,5265,5270,5276,5281,5455,5461,5466,5503,5524,5530,5535,5541,5546,5685,5690,5696,5765,5778,5784,5797,5864,5870,5883,5959,5965,5978,6016,6116,6128,6134,6147,6212,6217,6235,6241,6246,6269,6274,6280,6293,6396,6401,6407,6412,6434,6440,6445,6451,6456,6461,6484,6489],{"type":22,"tag":23,"props":24,"children":25},"element","p",{},[26,29,36],{"type":27,"value":28},"text","This tutorial explains how to distill GPT2 into a smaller ",{"type":22,"tag":30,"props":31,"children":33},"code",{"className":32},[],[34],{"type":27,"value":35},"distilgpt2",{"type":27,"value":37}," model. The entire pipeline includes:",{"type":22,"tag":39,"props":40,"children":41},"ol",{},[42,48,68,73,78,83,88],{"type":22,"tag":43,"props":44,"children":45},"li",{},[46],{"type":27,"value":47},"Setting up a stable training environment.",{"type":22,"tag":43,"props":49,"children":50},{},[51,53,59,61,66],{"type":27,"value":52},"Loading teacher (",{"type":22,"tag":30,"props":54,"children":56},{"className":55},[],[57],{"type":27,"value":58},"gpt2",{"type":27,"value":60},") and student (",{"type":22,"tag":30,"props":62,"children":64},{"className":63},[],[65],{"type":27,"value":35},{"type":27,"value":67},") models.",{"type":22,"tag":43,"props":69,"children":70},{},[71],{"type":27,"value":72},"Using data augmentation (if desired).",{"type":22,"tag":43,"props":74,"children":75},{},[76],{"type":27,"value":77},"Applying improved preprocessing steps.",{"type":22,"tag":43,"props":79,"children":80},{},[81],{"type":27,"value":82},"Implementing label smoothing.",{"type":22,"tag":43,"props":84,"children":85},{},[86],{"type":27,"value":87},"Using a custom distillation loss function.",{"type":22,"tag":43,"props":89,"children":90},{},[91],{"type":27,"value":92},"Training and evaluating the distilled model.",{"type":22,"tag":23,"props":94,"children":95},{},[96,98,104],{"type":27,"value":97},"Throughout the tutorial, you'll see how to train the student model using teacher outputs (knowledge distillation) while also retaining some direct supervision from ground-truth labels (hard loss). This balance is configured with a parameter ",{"type":22,"tag":30,"props":99,"children":101},{"className":100},[],[102],{"type":27,"value":103},"alpha",{"type":27,"value":105},".",{"type":22,"tag":107,"props":108,"children":110},"h2",{"id":109},"prerequisites",[111],{"type":27,"value":112},"Prerequisites",{"type":22,"tag":114,"props":115,"children":116},"ul",{},[117,131,143,155],{"type":22,"tag":43,"props":118,"children":119},{},[120,129],{"type":22,"tag":121,"props":122,"children":126},"a",{"href":123,"rel":124},"https://pytorch.org/",[125],"nofollow",[127],{"type":27,"value":128},"PyTorch",{"type":27,"value":130}," (for building and training neural networks)",{"type":22,"tag":43,"props":132,"children":133},{},[134,141],{"type":22,"tag":121,"props":135,"children":138},{"href":136,"rel":137},"https://github.com/huggingface/transformers",[125],[139],{"type":27,"value":140},"Hugging Face Transformers",{"type":27,"value":142}," (for pretrained transformer models)",{"type":22,"tag":43,"props":144,"children":145},{},[146,153],{"type":22,"tag":121,"props":147,"children":150},{"href":148,"rel":149},"https://huggingface.co/docs/datasets/",[125],[151],{"type":27,"value":152},"Datasets",{"type":27,"value":154}," (to load and process datasets)",{"type":22,"tag":43,"props":156,"children":157},{},[158],{"type":27,"value":159},"Basic familiarity with Python and deep learning concepts",{"type":22,"tag":23,"props":161,"children":162},{},[163],{"type":27,"value":164},"Ensure you have installed these packages before proceeding:",{"type":22,"tag":166,"props":167,"children":171},"pre",{"className":168,"code":169,"language":170,"meta":13,"style":13},"language-bash shiki shiki-themes github-light github-dark","pip install torch transformers datasets\n","bash",[172],{"type":22,"tag":30,"props":173,"children":174},{"__ignoreMap":13},[175],{"type":22,"tag":176,"props":177,"children":180},"span",{"class":178,"line":179},"line",1,[181,187,193,198,203],{"type":22,"tag":176,"props":182,"children":184},{"style":183},"--shiki-default:#6F42C1;--shiki-dark:#B392F0",[185],{"type":27,"value":186},"pip",{"type":22,"tag":176,"props":188,"children":190},{"style":189},"--shiki-default:#032F62;--shiki-dark:#9ECBFF",[191],{"type":27,"value":192}," install",{"type":22,"tag":176,"props":194,"children":195},{"style":189},[196],{"type":27,"value":197}," torch",{"type":22,"tag":176,"props":199,"children":200},{"style":189},[201],{"type":27,"value":202}," transformers",{"type":22,"tag":176,"props":204,"children":205},{"style":189},[206],{"type":27,"value":207}," datasets\n",{"type":22,"tag":107,"props":209,"children":211},{"id":210},"full-code",[212],{"type":27,"value":213},"Full Code",{"type":22,"tag":23,"props":215,"children":216},{},[217,219,225],{"type":27,"value":218},"Below is the complete code for the distillation workflow. You can save it in a file named ",{"type":22,"tag":30,"props":220,"children":222},{"className":221},[],[223],{"type":27,"value":224},"Distill_GPT.py",{"type":27,"value":226}," (or any name you prefer) and run it. Comments in the code are partly in Chinese, but each section is explained in English below the code blocks.",{"type":22,"tag":228,"props":229,"children":232},"collapsible",{"title":230,"variant":231},"Click to expand the code","card",[233],{"type":22,"tag":166,"props":234,"children":238},{"className":235,"code":236,"language":237,"meta":13,"style":13},"language-python shiki shiki-themes github-light github-dark","import os\nimport torch\nimport torch.nn as nn\nimport torch.optim as optim\nfrom transformers import AutoModelForCausalLM, AutoTokenizer\nfrom datasets import load_dataset\nfrom torch.utils.data import DataLoader\n\n# ======================\n# 1. Set the device\n# ======================\ndevice = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n\n# ======================\n# 2. Use stable base models\n# ======================\nteacher_model_name = \"gpt2\"\nstudent_model_name = \"distilgpt2\"\n\n# ======================\n# 3. Load models in FP32 for stability and adjust dropout in the student model\n# ======================\nteacher_model = AutoModelForCausalLM.from_pretrained(\n    teacher_model_name,\n    device_map=\"auto\",\n    torch_dtype=torch.float32\n).eval()\n\nstudent_model = AutoModelForCausalLM.from_pretrained(\n    student_model_name,\n    device_map=\"auto\",\n    torch_dtype=torch.float32\n)\n# Increase regularization to reduce mode collapse risk\nstudent_model.config.attn_pdrop = 0.1\nstudent_model.config.embd_pdrop = 0.1\nstudent_model.config.resid_pdrop = 0.1\nstudent_model.train()\n\n# ======================\n# 4.Load tokenizer\n# ======================\ntokenizer = AutoTokenizer.from_pretrained(teacher_model_name)\ntokenizer.pad_token = tokenizer.eos_token\n\n# ======================\n# 5. Data augmentation interface\n# ======================\ndef data_augmentation(text: str) -> str:\n    # Currently returns the original text; \n    # you can add more complex augmentation logic here\n    return text\n\n# ======================\n# 6. Improved data preprocessing\n# ======================\ndef tokenize_function(examples):\n    processed_texts = []\n    for text in examples[\"text\"]:\n        # Data augmentation\n        text_aug = data_augmentation(text)\n        cleaned = text_aug.strip()\n        # Filter out very short texts\n        if len(cleaned) > 10:\n            processed_texts.append(cleaned)\n    # In case none of the texts remain\n    if not processed_texts:\n        processed_texts = [\"[EMPTY]\"] * len(examples[\"text\"])\n    tokenized = tokenizer(\n        processed_texts,\n        truncation=True,\n        max_length=128,\n        padding=\"max_length\",\n        return_tensors=\"pt\"\n    )\n    return {key: value.tolist() for key, value in tokenized.items()}\n\n# ======================\n# 7. Load a larger dataset - openwebtext, then split into train/test\n# ======================\ndataset = load_dataset(\"openwebtext\")\ndataset = dataset[\"train\"].train_test_split(test_size=0.1)\n\ntokenized_datasets = dataset.map(\n    tokenize_function,\n    batched=True,\n    batch_size=8,\n    remove_columns=[\"text\"],\n    load_from_cache_file=False,\n    keep_in_memory=True,\n    num_proc=4\n)\n\n# ======================\n# 8. Configure the data loader\n# ======================\ndef collate_fn(batch):\n    input_ids = torch.tensor([ex[\"input_ids\"] for ex in batch], dtype=torch.long).to(device)\n    attention_mask = torch.tensor([ex[\"attention_mask\"] for ex in batch], dtype=torch.long).to(device)\n    return {\n        \"input_ids\": input_ids,\n        \"attention_mask\": attention_mask\n    }\n\ntrain_loader = DataLoader(\n    tokenized_datasets[\"train\"],\n    batch_size=8,\n    shuffle=True,\n    collate_fn=collate_fn\n)\n\ntest_loader = DataLoader(\n    tokenized_datasets[\"test\"],\n    batch_size=1,\n    collate_fn=collate_fn\n)\n\n# ======================\n# 9. Implementation of Label Smoothing\n# ======================\nclass LabelSmoothingCrossEntropy(nn.Module):\n    def __init__(self, smoothing=0.1):\n        \"\"\"\n        :param smoothing: Smoothing factor, typically in [0, 1)\n        \"\"\"\n        super(LabelSmoothingCrossEntropy, self).__init__()\n        self.smoothing = smoothing\n        self.log_softmax = nn.LogSoftmax(dim=-1)\n\n    def forward(self, logits, target):\n        with torch.no_grad():\n            pad_mask = (target == -100)\n            target = target.clone()\n            target[pad_mask] = 0\n        log_probs = self.log_softmax(logits)\n        nll_loss = -log_probs.gather(dim=-1, index=target.unsqueeze(1)).squeeze(1)\n        smooth_loss = -log_probs.mean(dim=-1)\n        nll_loss[pad_mask] = 0.0\n        smooth_loss[pad_mask] = 0.0\n        loss = (1.0 - self.smoothing) * nll_loss + self.smoothing * smooth_loss\n        return loss.mean()\n\nlabel_smoothing_loss_fn = LabelSmoothingCrossEntropy(smoothing=0.1)\n\n# ======================\n# 10. Improved distillation loss function\n# ======================\ndef distillation_loss(student_outputs, teacher_outputs, labels, temperature=3.0, alpha=0.7):\n    student_logits = student_outputs.logits\n    teacher_logits = teacher_outputs.logits.detach()\n    labels = labels.to(student_logits.device)\n\n    # Hard loss from label smoothing\n    hard_loss = label_smoothing_loss_fn(\n        student_logits.view(-1, student_logits.size(-1)),\n        labels.view(-1)\n    )\n    # Soft loss from teacher logits\n    soft_loss = nn.KLDivLoss(reduction='batchmean')(\n        nn.functional.log_softmax(student_logits / temperature, dim=-1),\n        nn.functional.softmax(teacher_logits / temperature, dim=-1)\n    ) * (temperature ** 2)\n\n    return alpha * hard_loss + (1 - alpha) * soft_loss\n\n# ======================\n# 11. Enhanced training loop\n# ======================\ndef train_student(student_model, teacher_model, train_loader, epochs=3, lr=3e-6, output_dir=\"distilled_model\"):\n    optimizer = optim.AdamW(student_model.parameters(), lr=lr, weight_decay=0.01)\n    os.makedirs(output_dir, exist_ok=True)\n\n    for epoch in range(epochs):\n        student_model.train()\n        total_loss = 0.0\n        for batch_idx, batch in enumerate(train_loader):\n            inputs = batch[\"input_ids\"]\n            attention_mask = batch[\"attention_mask\"]\n            labels = inputs.clone()\n            labels[labels == tokenizer.pad_token_id] = -100\n\n            optimizer.zero_grad()\n            with torch.no_grad():\n                teacher_outputs = teacher_model(input_ids=inputs, attention_mask=attention_mask)\n            student_outputs = student_model(input_ids=inputs, attention_mask=attention_mask)\n\n            loss = distillation_loss(student_outputs, teacher_outputs, labels)\n            loss.backward()\n            optimizer.step()\n\n            total_loss += loss.item()\n            # Print progress occasionally\n            if batch_idx % 100000 == 0 and batch_idx > 0:\n                print(f\"Epoch {epoch+1} | Batch {batch_idx} | Average Loss: {total_loss / (batch_idx + 1):.4f}\")\n\n        print(f\"Epoch {epoch+1} Complete | Average Loss: {total_loss / len(train_loader):.4f}\")\n    print(\"Training complete!\")\n    return student_model\n\n# ======================\n# 12. Model evaluation\n# ======================\ndef evaluate_model(model, test_loader, num_samples=3):\n    model.eval()\n    results = []\n    with torch.no_grad():\n        for i, batch in enumerate(test_loader):\n            if i >= num_samples:\n                break\n            inputs = batch[\"input_ids\"]\n            attention_mask = batch[\"attention_mask\"]\n            output = model.generate(\n                inputs,\n                attention_mask=attention_mask,\n                max_new_tokens=50,\n                pad_token_id=tokenizer.eos_token_id,\n                do_sample=True,\n                temperature=0.7,\n                top_k=50,\n                top_p=0.9\n            )\n            decoded = tokenizer.decode(output[0], skip_special_tokens=True)\n            results.append(decoded)\n    return results\n\n# ======================\n# 13. Run the training\n# ======================\noutput_model_dir = \"distilled_model_output_OpenWeb\"\ntrained_model = train_student(\n    student_model,\n    teacher_model,\n    train_loader,\n    epochs=2,  # Adjust epochs as needed\n    lr=3e-6,\n    output_dir=output_model_dir\n)\n\n# ======================\n# 14. Save the final model\n# ======================\ntorch.save(trained_model.state_dict(), os.path.join(output_model_dir, \"final_distilled_model.pt\"))\n\n# ======================\n# 15. Comparison Evaluation\n# ======================\nprint(\"\\nTeacher Model Generation Samples:\")\nteacher_results = evaluate_model(teacher_model, test_loader)\n\nprint(\"\\nStudent Model Generation Samples:\")\nstudent_results = evaluate_model(trained_model, test_loader)\n\n# ======================\n# 16. Save comparison results\n# ======================\ncomparison_file_path = os.path.join(output_model_dir, \"generation_comparison.txt\")\nwith open(comparison_file_path, \"w\", encoding=\"utf-8\") as f:\n    f.write(\"=== Teacher Model Generation ===\\n\")\n    f.write(\"\\n\".join(teacher_results))\n    f.write(\"\\n\\n=== Student Model Generation ===\\n\")\n    f.write(\"\\n\".join(student_results))\n\nprint(f\"\\nTraining and evaluation complete! Comparison saved to {comparison_file_path}\")\nprint(f\"Model files saved in {output_model_dir}\")\n","python",[239],{"type":22,"tag":30,"props":240,"children":241},{"__ignoreMap":13},[242,257,270,293,315,338,360,382,391,401,410,418,467,475,483,492,500,518,536,544,552,561,569,587,596,620,638,647,655,672,681,701,717,725,734,753,770,787,796,804,812,821,829,847,865,873,881,890,898,936,945,954,968,976,984,993,1001,1019,1037,1071,1080,1098,1116,1125,1158,1167,1176,1195,1246,1264,1273,1295,1317,1339,1357,1366,1398,1406,1414,1423,1431,1458,1503,1511,1529,1538,1559,1581,1608,1630,1651,1669,1677,1685,1693,1702,1710,1728,1787,1841,1854,1868,1882,1891,1899,1917,1934,1954,1975,1993,2001,2009,2026,2043,2064,2080,2088,2096,2104,2113,2121,2159,2190,2199,2208,2216,2250,2273,2313,2321,2339,2353,2390,2408,2426,2449,2519,2557,2575,2592,2659,2673,2681,2716,2724,2732,2741,2749,2794,2812,2830,2848,2856,2865,2883,2919,2940,2948,2957,2994,3030,3063,3095,3103,3155,3163,3171,3180,3188,3247,3297,3323,3331,3358,3367,3384,3412,3439,3464,3482,3513,3521,3530,3543,3589,3631,3639,3657,3666,3675,3683,3702,3711,3766,3882,3890,3969,3991,4004,4012,4020,4029,4037,4067,4076,4093,4106,4132,4155,4164,4188,4212,4230,4239,4257,4279,4297,4318,4339,4360,4378,4387,4432,4441,4454,4462,4470,4479,4487,4505,4523,4532,4541,4550,4578,4599,4617,4625,4633,4641,4650,4658,4677,4685,4693,4702,4710,4741,4759,4767,4796,4814,4822,4830,4839,4847,4874,4930,4956,4981,5015,5040,5048,5098],{"type":22,"tag":176,"props":243,"children":244},{"class":178,"line":179},[245,251],{"type":22,"tag":176,"props":246,"children":248},{"style":247},"--shiki-default:#D73A49;--shiki-dark:#F97583",[249],{"type":27,"value":250},"import",{"type":22,"tag":176,"props":252,"children":254},{"style":253},"--shiki-default:#24292E;--shiki-dark:#E1E4E8",[255],{"type":27,"value":256}," os\n",{"type":22,"tag":176,"props":258,"children":260},{"class":178,"line":259},2,[261,265],{"type":22,"tag":176,"props":262,"children":263},{"style":247},[264],{"type":27,"value":250},{"type":22,"tag":176,"props":266,"children":267},{"style":253},[268],{"type":27,"value":269}," torch\n",{"type":22,"tag":176,"props":271,"children":273},{"class":178,"line":272},3,[274,278,283,288],{"type":22,"tag":176,"props":275,"children":276},{"style":247},[277],{"type":27,"value":250},{"type":22,"tag":176,"props":279,"children":280},{"style":253},[281],{"type":27,"value":282}," torch.nn ",{"type":22,"tag":176,"props":284,"children":285},{"style":247},[286],{"type":27,"value":287},"as",{"type":22,"tag":176,"props":289,"children":290},{"style":253},[291],{"type":27,"value":292}," nn\n",{"type":22,"tag":176,"props":294,"children":296},{"class":178,"line":295},4,[297,301,306,310],{"type":22,"tag":176,"props":298,"children":299},{"style":247},[300],{"type":27,"value":250},{"type":22,"tag":176,"props":302,"children":303},{"style":253},[304],{"type":27,"value":305}," torch.optim ",{"type":22,"tag":176,"props":307,"children":308},{"style":247},[309],{"type":27,"value":287},{"type":22,"tag":176,"props":311,"children":312},{"style":253},[313],{"type":27,"value":314}," optim\n",{"type":22,"tag":176,"props":316,"children":318},{"class":178,"line":317},5,[319,324,329,333],{"type":22,"tag":176,"props":320,"children":321},{"style":247},[322],{"type":27,"value":323},"from",{"type":22,"tag":176,"props":325,"children":326},{"style":253},[327],{"type":27,"value":328}," transformers ",{"type":22,"tag":176,"props":330,"children":331},{"style":247},[332],{"type":27,"value":250},{"type":22,"tag":176,"props":334,"children":335},{"style":253},[336],{"type":27,"value":337}," AutoModelForCausalLM, AutoTokenizer\n",{"type":22,"tag":176,"props":339,"children":341},{"class":178,"line":340},6,[342,346,351,355],{"type":22,"tag":176,"props":343,"children":344},{"style":247},[345],{"type":27,"value":323},{"type":22,"tag":176,"props":347,"children":348},{"style":253},[349],{"type":27,"value":350}," datasets ",{"type":22,"tag":176,"props":352,"children":353},{"style":247},[354],{"type":27,"value":250},{"type":22,"tag":176,"props":356,"children":357},{"style":253},[358],{"type":27,"value":359}," load_dataset\n",{"type":22,"tag":176,"props":361,"children":363},{"class":178,"line":362},7,[364,368,373,377],{"type":22,"tag":176,"props":365,"children":366},{"style":247},[367],{"type":27,"value":323},{"type":22,"tag":176,"props":369,"children":370},{"style":253},[371],{"type":27,"value":372}," torch.utils.data ",{"type":22,"tag":176,"props":374,"children":375},{"style":247},[376],{"type":27,"value":250},{"type":22,"tag":176,"props":378,"children":379},{"style":253},[380],{"type":27,"value":381}," DataLoader\n",{"type":22,"tag":176,"props":383,"children":385},{"class":178,"line":384},8,[386],{"type":22,"tag":176,"props":387,"children":388},{"emptyLinePlaceholder":5},[389],{"type":27,"value":390},"\n",{"type":22,"tag":176,"props":392,"children":394},{"class":178,"line":393},9,[395],{"type":22,"tag":176,"props":396,"children":398},{"style":397},"--shiki-default:#6A737D;--shiki-dark:#6A737D",[399],{"type":27,"value":400},"# ======================\n",{"type":22,"tag":176,"props":402,"children":404},{"class":178,"line":403},10,[405],{"type":22,"tag":176,"props":406,"children":407},{"style":397},[408],{"type":27,"value":409},"# 1. Set the device\n",{"type":22,"tag":176,"props":411,"children":413},{"class":178,"line":412},11,[414],{"type":22,"tag":176,"props":415,"children":416},{"style":397},[417],{"type":27,"value":400},{"type":22,"tag":176,"props":419,"children":421},{"class":178,"line":420},12,[422,427,432,437,442,447,452,457,462],{"type":22,"tag":176,"props":423,"children":424},{"style":253},[425],{"type":27,"value":426},"device ",{"type":22,"tag":176,"props":428,"children":429},{"style":247},[430],{"type":27,"value":431},"=",{"type":22,"tag":176,"props":433,"children":434},{"style":253},[435],{"type":27,"value":436}," torch.device(",{"type":22,"tag":176,"props":438,"children":439},{"style":189},[440],{"type":27,"value":441},"\"cuda\"",{"type":22,"tag":176,"props":443,"children":444},{"style":247},[445],{"type":27,"value":446}," if",{"type":22,"tag":176,"props":448,"children":449},{"style":253},[450],{"type":27,"value":451}," torch.cuda.is_available() ",{"type":22,"tag":176,"props":453,"children":454},{"style":247},[455],{"type":27,"value":456},"else",{"type":22,"tag":176,"props":458,"children":459},{"style":189},[460],{"type":27,"value":461}," \"cpu\"",{"type":22,"tag":176,"props":463,"children":464},{"style":253},[465],{"type":27,"value":466},")\n",{"type":22,"tag":176,"props":468,"children":470},{"class":178,"line":469},13,[471],{"type":22,"tag":176,"props":472,"children":473},{"emptyLinePlaceholder":5},[474],{"type":27,"value":390},{"type":22,"tag":176,"props":476,"children":478},{"class":178,"line":477},14,[479],{"type":22,"tag":176,"props":480,"children":481},{"style":397},[482],{"type":27,"value":400},{"type":22,"tag":176,"props":484,"children":486},{"class":178,"line":485},15,[487],{"type":22,"tag":176,"props":488,"children":489},{"style":397},[490],{"type":27,"value":491},"# 2. Use stable base models\n",{"type":22,"tag":176,"props":493,"children":495},{"class":178,"line":494},16,[496],{"type":22,"tag":176,"props":497,"children":498},{"style":397},[499],{"type":27,"value":400},{"type":22,"tag":176,"props":501,"children":503},{"class":178,"line":502},17,[504,509,513],{"type":22,"tag":176,"props":505,"children":506},{"style":253},[507],{"type":27,"value":508},"teacher_model_name ",{"type":22,"tag":176,"props":510,"children":511},{"style":247},[512],{"type":27,"value":431},{"type":22,"tag":176,"props":514,"children":515},{"style":189},[516],{"type":27,"value":517}," \"gpt2\"\n",{"type":22,"tag":176,"props":519,"children":521},{"class":178,"line":520},18,[522,527,531],{"type":22,"tag":176,"props":523,"children":524},{"style":253},[525],{"type":27,"value":526},"student_model_name ",{"type":22,"tag":176,"props":528,"children":529},{"style":247},[530],{"type":27,"value":431},{"type":22,"tag":176,"props":532,"children":533},{"style":189},[534],{"type":27,"value":535}," \"distilgpt2\"\n",{"type":22,"tag":176,"props":537,"children":539},{"class":178,"line":538},19,[540],{"type":22,"tag":176,"props":541,"children":542},{"emptyLinePlaceholder":5},[543],{"type":27,"value":390},{"type":22,"tag":176,"props":545,"children":547},{"class":178,"line":546},20,[548],{"type":22,"tag":176,"props":549,"children":550},{"style":397},[551],{"type":27,"value":400},{"type":22,"tag":176,"props":553,"children":555},{"class":178,"line":554},21,[556],{"type":22,"tag":176,"props":557,"children":558},{"style":397},[559],{"type":27,"value":560},"# 3. Load models in FP32 for stability and adjust dropout in the student model\n",{"type":22,"tag":176,"props":562,"children":564},{"class":178,"line":563},22,[565],{"type":22,"tag":176,"props":566,"children":567},{"style":397},[568],{"type":27,"value":400},{"type":22,"tag":176,"props":570,"children":572},{"class":178,"line":571},23,[573,578,582],{"type":22,"tag":176,"props":574,"children":575},{"style":253},[576],{"type":27,"value":577},"teacher_model ",{"type":22,"tag":176,"props":579,"children":580},{"style":247},[581],{"type":27,"value":431},{"type":22,"tag":176,"props":583,"children":584},{"style":253},[585],{"type":27,"value":586}," AutoModelForCausalLM.from_pretrained(\n",{"type":22,"tag":176,"props":588,"children":590},{"class":178,"line":589},24,[591],{"type":22,"tag":176,"props":592,"children":593},{"style":253},[594],{"type":27,"value":595},"    teacher_model_name,\n",{"type":22,"tag":176,"props":597,"children":599},{"class":178,"line":598},25,[600,606,610,615],{"type":22,"tag":176,"props":601,"children":603},{"style":602},"--shiki-default:#E36209;--shiki-dark:#FFAB70",[604],{"type":27,"value":605},"    device_map",{"type":22,"tag":176,"props":607,"children":608},{"style":247},[609],{"type":27,"value":431},{"type":22,"tag":176,"props":611,"children":612},{"style":189},[613],{"type":27,"value":614},"\"auto\"",{"type":22,"tag":176,"props":616,"children":617},{"style":253},[618],{"type":27,"value":619},",\n",{"type":22,"tag":176,"props":621,"children":623},{"class":178,"line":622},26,[624,629,633],{"type":22,"tag":176,"props":625,"children":626},{"style":602},[627],{"type":27,"value":628},"    torch_dtype",{"type":22,"tag":176,"props":630,"children":631},{"style":247},[632],{"type":27,"value":431},{"type":22,"tag":176,"props":634,"children":635},{"style":253},[636],{"type":27,"value":637},"torch.float32\n",{"type":22,"tag":176,"props":639,"children":641},{"class":178,"line":640},27,[642],{"type":22,"tag":176,"props":643,"children":644},{"style":253},[645],{"type":27,"value":646},").eval()\n",{"type":22,"tag":176,"props":648,"children":650},{"class":178,"line":649},28,[651],{"type":22,"tag":176,"props":652,"children":653},{"emptyLinePlaceholder":5},[654],{"type":27,"value":390},{"type":22,"tag":176,"props":656,"children":658},{"class":178,"line":657},29,[659,664,668],{"type":22,"tag":176,"props":660,"children":661},{"style":253},[662],{"type":27,"value":663},"student_model ",{"type":22,"tag":176,"props":665,"children":666},{"style":247},[667],{"type":27,"value":431},{"type":22,"tag":176,"props":669,"children":670},{"style":253},[671],{"type":27,"value":586},{"type":22,"tag":176,"props":673,"children":675},{"class":178,"line":674},30,[676],{"type":22,"tag":176,"props":677,"children":678},{"style":253},[679],{"type":27,"value":680},"    student_model_name,\n",{"type":22,"tag":176,"props":682,"children":684},{"class":178,"line":683},31,[685,689,693,697],{"type":22,"tag":176,"props":686,"children":687},{"style":602},[688],{"type":27,"value":605},{"type":22,"tag":176,"props":690,"children":691},{"style":247},[692],{"type":27,"value":431},{"type":22,"tag":176,"props":694,"children":695},{"style":189},[696],{"type":27,"value":614},{"type":22,"tag":176,"props":698,"children":699},{"style":253},[700],{"type":27,"value":619},{"type":22,"tag":176,"props":702,"children":704},{"class":178,"line":703},32,[705,709,713],{"type":22,"tag":176,"props":706,"children":707},{"style":602},[708],{"type":27,"value":628},{"type":22,"tag":176,"props":710,"children":711},{"style":247},[712],{"type":27,"value":431},{"type":22,"tag":176,"props":714,"children":715},{"style":253},[716],{"type":27,"value":637},{"type":22,"tag":176,"props":718,"children":720},{"class":178,"line":719},33,[721],{"type":22,"tag":176,"props":722,"children":723},{"style":253},[724],{"type":27,"value":466},{"type":22,"tag":176,"props":726,"children":728},{"class":178,"line":727},34,[729],{"type":22,"tag":176,"props":730,"children":731},{"style":397},[732],{"type":27,"value":733},"# Increase regularization to reduce mode collapse risk\n",{"type":22,"tag":176,"props":735,"children":737},{"class":178,"line":736},35,[738,743,747],{"type":22,"tag":176,"props":739,"children":740},{"style":253},[741],{"type":27,"value":742},"student_model.config.attn_pdrop ",{"type":22,"tag":176,"props":744,"children":745},{"style":247},[746],{"type":27,"value":431},{"type":22,"tag":176,"props":748,"children":750},{"style":749},"--shiki-default:#005CC5;--shiki-dark:#79B8FF",[751],{"type":27,"value":752}," 0.1\n",{"type":22,"tag":176,"props":754,"children":756},{"class":178,"line":755},36,[757,762,766],{"type":22,"tag":176,"props":758,"children":759},{"style":253},[760],{"type":27,"value":761},"student_model.config.embd_pdrop ",{"type":22,"tag":176,"props":763,"children":764},{"style":247},[765],{"type":27,"value":431},{"type":22,"tag":176,"props":767,"children":768},{"style":749},[769],{"type":27,"value":752},{"type":22,"tag":176,"props":771,"children":773},{"class":178,"line":772},37,[774,779,783],{"type":22,"tag":176,"props":775,"children":776},{"style":253},[777],{"type":27,"value":778},"student_model.config.resid_pdrop ",{"type":22,"tag":176,"props":780,"children":781},{"style":247},[782],{"type":27,"value":431},{"type":22,"tag":176,"props":784,"children":785},{"style":749},[786],{"type":27,"value":752},{"type":22,"tag":176,"props":788,"children":790},{"class":178,"line":789},38,[791],{"type":22,"tag":176,"props":792,"children":793},{"style":253},[794],{"type":27,"value":795},"student_model.train()\n",{"type":22,"tag":176,"props":797,"children":799},{"class":178,"line":798},39,[800],{"type":22,"tag":176,"props":801,"children":802},{"emptyLinePlaceholder":5},[803],{"type":27,"value":390},{"type":22,"tag":176,"props":805,"children":807},{"class":178,"line":806},40,[808],{"type":22,"tag":176,"props":809,"children":810},{"style":397},[811],{"type":27,"value":400},{"type":22,"tag":176,"props":813,"children":815},{"class":178,"line":814},41,[816],{"type":22,"tag":176,"props":817,"children":818},{"style":397},[819],{"type":27,"value":820},"# 4.Load tokenizer\n",{"type":22,"tag":176,"props":822,"children":824},{"class":178,"line":823},42,[825],{"type":22,"tag":176,"props":826,"children":827},{"style":397},[828],{"type":27,"value":400},{"type":22,"tag":176,"props":830,"children":832},{"class":178,"line":831},43,[833,838,842],{"type":22,"tag":176,"props":834,"children":835},{"style":253},[836],{"type":27,"value":837},"tokenizer ",{"type":22,"tag":176,"props":839,"children":840},{"style":247},[841],{"type":27,"value":431},{"type":22,"tag":176,"props":843,"children":844},{"style":253},[845],{"type":27,"value":846}," AutoTokenizer.from_pretrained(teacher_model_name)\n",{"type":22,"tag":176,"props":848,"children":850},{"class":178,"line":849},44,[851,856,860],{"type":22,"tag":176,"props":852,"children":853},{"style":253},[854],{"type":27,"value":855},"tokenizer.pad_token ",{"type":22,"tag":176,"props":857,"children":858},{"style":247},[859],{"type":27,"value":431},{"type":22,"tag":176,"props":861,"children":862},{"style":253},[863],{"type":27,"value":864}," tokenizer.eos_token\n",{"type":22,"tag":176,"props":866,"children":868},{"class":178,"line":867},45,[869],{"type":22,"tag":176,"props":870,"children":871},{"emptyLinePlaceholder":5},[872],{"type":27,"value":390},{"type":22,"tag":176,"props":874,"children":876},{"class":178,"line":875},46,[877],{"type":22,"tag":176,"props":878,"children":879},{"style":397},[880],{"type":27,"value":400},{"type":22,"tag":176,"props":882,"children":884},{"class":178,"line":883},47,[885],{"type":22,"tag":176,"props":886,"children":887},{"style":397},[888],{"type":27,"value":889},"# 5. Data augmentation interface\n",{"type":22,"tag":176,"props":891,"children":893},{"class":178,"line":892},48,[894],{"type":22,"tag":176,"props":895,"children":896},{"style":397},[897],{"type":27,"value":400},{"type":22,"tag":176,"props":899,"children":901},{"class":178,"line":900},49,[902,907,912,917,922,927,931],{"type":22,"tag":176,"props":903,"children":904},{"style":247},[905],{"type":27,"value":906},"def",{"type":22,"tag":176,"props":908,"children":909},{"style":183},[910],{"type":27,"value":911}," data_augmentation",{"type":22,"tag":176,"props":913,"children":914},{"style":253},[915],{"type":27,"value":916},"(text: ",{"type":22,"tag":176,"props":918,"children":919},{"style":749},[920],{"type":27,"value":921},"str",{"type":22,"tag":176,"props":923,"children":924},{"style":253},[925],{"type":27,"value":926},") -> ",{"type":22,"tag":176,"props":928,"children":929},{"style":749},[930],{"type":27,"value":921},{"type":22,"tag":176,"props":932,"children":933},{"style":253},[934],{"type":27,"value":935},":\n",{"type":22,"tag":176,"props":937,"children":939},{"class":178,"line":938},50,[940],{"type":22,"tag":176,"props":941,"children":942},{"style":397},[943],{"type":27,"value":944},"    # Currently returns the original text; \n",{"type":22,"tag":176,"props":946,"children":948},{"class":178,"line":947},51,[949],{"type":22,"tag":176,"props":950,"children":951},{"style":397},[952],{"type":27,"value":953},"    # you can add more complex augmentation logic here\n",{"type":22,"tag":176,"props":955,"children":957},{"class":178,"line":956},52,[958,963],{"type":22,"tag":176,"props":959,"children":960},{"style":247},[961],{"type":27,"value":962},"    return",{"type":22,"tag":176,"props":964,"children":965},{"style":253},[966],{"type":27,"value":967}," text\n",{"type":22,"tag":176,"props":969,"children":971},{"class":178,"line":970},53,[972],{"type":22,"tag":176,"props":973,"children":974},{"emptyLinePlaceholder":5},[975],{"type":27,"value":390},{"type":22,"tag":176,"props":977,"children":979},{"class":178,"line":978},54,[980],{"type":22,"tag":176,"props":981,"children":982},{"style":397},[983],{"type":27,"value":400},{"type":22,"tag":176,"props":985,"children":987},{"class":178,"line":986},55,[988],{"type":22,"tag":176,"props":989,"children":990},{"style":397},[991],{"type":27,"value":992},"# 6. Improved data preprocessing\n",{"type":22,"tag":176,"props":994,"children":996},{"class":178,"line":995},56,[997],{"type":22,"tag":176,"props":998,"children":999},{"style":397},[1000],{"type":27,"value":400},{"type":22,"tag":176,"props":1002,"children":1004},{"class":178,"line":1003},57,[1005,1009,1014],{"type":22,"tag":176,"props":1006,"children":1007},{"style":247},[1008],{"type":27,"value":906},{"type":22,"tag":176,"props":1010,"children":1011},{"style":183},[1012],{"type":27,"value":1013}," tokenize_function",{"type":22,"tag":176,"props":1015,"children":1016},{"style":253},[1017],{"type":27,"value":1018},"(examples):\n",{"type":22,"tag":176,"props":1020,"children":1022},{"class":178,"line":1021},58,[1023,1028,1032],{"type":22,"tag":176,"props":1024,"children":1025},{"style":253},[1026],{"type":27,"value":1027},"    processed_texts ",{"type":22,"tag":176,"props":1029,"children":1030},{"style":247},[1031],{"type":27,"value":431},{"type":22,"tag":176,"props":1033,"children":1034},{"style":253},[1035],{"type":27,"value":1036}," []\n",{"type":22,"tag":176,"props":1038,"children":1040},{"class":178,"line":1039},59,[1041,1046,1051,1056,1061,1066],{"type":22,"tag":176,"props":1042,"children":1043},{"style":247},[1044],{"type":27,"value":1045},"    for",{"type":22,"tag":176,"props":1047,"children":1048},{"style":253},[1049],{"type":27,"value":1050}," text ",{"type":22,"tag":176,"props":1052,"children":1053},{"style":247},[1054],{"type":27,"value":1055},"in",{"type":22,"tag":176,"props":1057,"children":1058},{"style":253},[1059],{"type":27,"value":1060}," examples[",{"type":22,"tag":176,"props":1062,"children":1063},{"style":189},[1064],{"type":27,"value":1065},"\"text\"",{"type":22,"tag":176,"props":1067,"children":1068},{"style":253},[1069],{"type":27,"value":1070},"]:\n",{"type":22,"tag":176,"props":1072,"children":1074},{"class":178,"line":1073},60,[1075],{"type":22,"tag":176,"props":1076,"children":1077},{"style":397},[1078],{"type":27,"value":1079},"        # Data augmentation\n",{"type":22,"tag":176,"props":1081,"children":1083},{"class":178,"line":1082},61,[1084,1089,1093],{"type":22,"tag":176,"props":1085,"children":1086},{"style":253},[1087],{"type":27,"value":1088},"        text_aug ",{"type":22,"tag":176,"props":1090,"children":1091},{"style":247},[1092],{"type":27,"value":431},{"type":22,"tag":176,"props":1094,"children":1095},{"style":253},[1096],{"type":27,"value":1097}," data_augmentation(text)\n",{"type":22,"tag":176,"props":1099,"children":1101},{"class":178,"line":1100},62,[1102,1107,1111],{"type":22,"tag":176,"props":1103,"children":1104},{"style":253},[1105],{"type":27,"value":1106},"        cleaned ",{"type":22,"tag":176,"props":1108,"children":1109},{"style":247},[1110],{"type":27,"value":431},{"type":22,"tag":176,"props":1112,"children":1113},{"style":253},[1114],{"type":27,"value":1115}," text_aug.strip()\n",{"type":22,"tag":176,"props":1117,"children":1119},{"class":178,"line":1118},63,[1120],{"type":22,"tag":176,"props":1121,"children":1122},{"style":397},[1123],{"type":27,"value":1124},"        # Filter out very short texts\n",{"type":22,"tag":176,"props":1126,"children":1128},{"class":178,"line":1127},64,[1129,1134,1139,1144,1149,1154],{"type":22,"tag":176,"props":1130,"children":1131},{"style":247},[1132],{"type":27,"value":1133},"        if",{"type":22,"tag":176,"props":1135,"children":1136},{"style":749},[1137],{"type":27,"value":1138}," len",{"type":22,"tag":176,"props":1140,"children":1141},{"style":253},[1142],{"type":27,"value":1143},"(cleaned) ",{"type":22,"tag":176,"props":1145,"children":1146},{"style":247},[1147],{"type":27,"value":1148},">",{"type":22,"tag":176,"props":1150,"children":1151},{"style":749},[1152],{"type":27,"value":1153}," 10",{"type":22,"tag":176,"props":1155,"children":1156},{"style":253},[1157],{"type":27,"value":935},{"type":22,"tag":176,"props":1159,"children":1161},{"class":178,"line":1160},65,[1162],{"type":22,"tag":176,"props":1163,"children":1164},{"style":253},[1165],{"type":27,"value":1166},"            processed_texts.append(cleaned)\n",{"type":22,"tag":176,"props":1168,"children":1170},{"class":178,"line":1169},66,[1171],{"type":22,"tag":176,"props":1172,"children":1173},{"style":397},[1174],{"type":27,"value":1175},"    # In case none of the texts remain\n",{"type":22,"tag":176,"props":1177,"children":1179},{"class":178,"line":1178},67,[1180,1185,1190],{"type":22,"tag":176,"props":1181,"children":1182},{"style":247},[1183],{"type":27,"value":1184},"    if",{"type":22,"tag":176,"props":1186,"children":1187},{"style":247},[1188],{"type":27,"value":1189}," not",{"type":22,"tag":176,"props":1191,"children":1192},{"style":253},[1193],{"type":27,"value":1194}," processed_texts:\n",{"type":22,"tag":176,"props":1196,"children":1198},{"class":178,"line":1197},68,[1199,1204,1208,1213,1218,1223,1228,1232,1237,1241],{"type":22,"tag":176,"props":1200,"children":1201},{"style":253},[1202],{"type":27,"value":1203},"        processed_texts ",{"type":22,"tag":176,"props":1205,"children":1206},{"style":247},[1207],{"type":27,"value":431},{"type":22,"tag":176,"props":1209,"children":1210},{"style":253},[1211],{"type":27,"value":1212}," [",{"type":22,"tag":176,"props":1214,"children":1215},{"style":189},[1216],{"type":27,"value":1217},"\"[EMPTY]\"",{"type":22,"tag":176,"props":1219,"children":1220},{"style":253},[1221],{"type":27,"value":1222},"] ",{"type":22,"tag":176,"props":1224,"children":1225},{"style":247},[1226],{"type":27,"value":1227},"*",{"type":22,"tag":176,"props":1229,"children":1230},{"style":749},[1231],{"type":27,"value":1138},{"type":22,"tag":176,"props":1233,"children":1234},{"style":253},[1235],{"type":27,"value":1236},"(examples[",{"type":22,"tag":176,"props":1238,"children":1239},{"style":189},[1240],{"type":27,"value":1065},{"type":22,"tag":176,"props":1242,"children":1243},{"style":253},[1244],{"type":27,"value":1245},"])\n",{"type":22,"tag":176,"props":1247,"children":1249},{"class":178,"line":1248},69,[1250,1255,1259],{"type":22,"tag":176,"props":1251,"children":1252},{"style":253},[1253],{"type":27,"value":1254},"    tokenized ",{"type":22,"tag":176,"props":1256,"children":1257},{"style":247},[1258],{"type":27,"value":431},{"type":22,"tag":176,"props":1260,"children":1261},{"style":253},[1262],{"type":27,"value":1263}," tokenizer(\n",{"type":22,"tag":176,"props":1265,"children":1267},{"class":178,"line":1266},70,[1268],{"type":22,"tag":176,"props":1269,"children":1270},{"style":253},[1271],{"type":27,"value":1272},"        processed_texts,\n",{"type":22,"tag":176,"props":1274,"children":1276},{"class":178,"line":1275},71,[1277,1282,1286,1291],{"type":22,"tag":176,"props":1278,"children":1279},{"style":602},[1280],{"type":27,"value":1281},"        truncation",{"type":22,"tag":176,"props":1283,"children":1284},{"style":247},[1285],{"type":27,"value":431},{"type":22,"tag":176,"props":1287,"children":1288},{"style":749},[1289],{"type":27,"value":1290},"True",{"type":22,"tag":176,"props":1292,"children":1293},{"style":253},[1294],{"type":27,"value":619},{"type":22,"tag":176,"props":1296,"children":1298},{"class":178,"line":1297},72,[1299,1304,1308,1313],{"type":22,"tag":176,"props":1300,"children":1301},{"style":602},[1302],{"type":27,"value":1303},"        max_length",{"type":22,"tag":176,"props":1305,"children":1306},{"style":247},[1307],{"type":27,"value":431},{"type":22,"tag":176,"props":1309,"children":1310},{"style":749},[1311],{"type":27,"value":1312},"128",{"type":22,"tag":176,"props":1314,"children":1315},{"style":253},[1316],{"type":27,"value":619},{"type":22,"tag":176,"props":1318,"children":1320},{"class":178,"line":1319},73,[1321,1326,1330,1335],{"type":22,"tag":176,"props":1322,"children":1323},{"style":602},[1324],{"type":27,"value":1325},"        padding",{"type":22,"tag":176,"props":1327,"children":1328},{"style":247},[1329],{"type":27,"value":431},{"type":22,"tag":176,"props":1331,"children":1332},{"style":189},[1333],{"type":27,"value":1334},"\"max_length\"",{"type":22,"tag":176,"props":1336,"children":1337},{"style":253},[1338],{"type":27,"value":619},{"type":22,"tag":176,"props":1340,"children":1342},{"class":178,"line":1341},74,[1343,1348,1352],{"type":22,"tag":176,"props":1344,"children":1345},{"style":602},[1346],{"type":27,"value":1347},"        return_tensors",{"type":22,"tag":176,"props":1349,"children":1350},{"style":247},[1351],{"type":27,"value":431},{"type":22,"tag":176,"props":1353,"children":1354},{"style":189},[1355],{"type":27,"value":1356},"\"pt\"\n",{"type":22,"tag":176,"props":1358,"children":1360},{"class":178,"line":1359},75,[1361],{"type":22,"tag":176,"props":1362,"children":1363},{"style":253},[1364],{"type":27,"value":1365},"    )\n",{"type":22,"tag":176,"props":1367,"children":1369},{"class":178,"line":1368},76,[1370,1374,1379,1384,1389,1393],{"type":22,"tag":176,"props":1371,"children":1372},{"style":247},[1373],{"type":27,"value":962},{"type":22,"tag":176,"props":1375,"children":1376},{"style":253},[1377],{"type":27,"value":1378}," {key: value.tolist() ",{"type":22,"tag":176,"props":1380,"children":1381},{"style":247},[1382],{"type":27,"value":1383},"for",{"type":22,"tag":176,"props":1385,"children":1386},{"style":253},[1387],{"type":27,"value":1388}," key, value ",{"type":22,"tag":176,"props":1390,"children":1391},{"style":247},[1392],{"type":27,"value":1055},{"type":22,"tag":176,"props":1394,"children":1395},{"style":253},[1396],{"type":27,"value":1397}," tokenized.items()}\n",{"type":22,"tag":176,"props":1399,"children":1401},{"class":178,"line":1400},77,[1402],{"type":22,"tag":176,"props":1403,"children":1404},{"emptyLinePlaceholder":5},[1405],{"type":27,"value":390},{"type":22,"tag":176,"props":1407,"children":1409},{"class":178,"line":1408},78,[1410],{"type":22,"tag":176,"props":1411,"children":1412},{"style":397},[1413],{"type":27,"value":400},{"type":22,"tag":176,"props":1415,"children":1417},{"class":178,"line":1416},79,[1418],{"type":22,"tag":176,"props":1419,"children":1420},{"style":397},[1421],{"type":27,"value":1422},"# 7. Load a larger dataset - openwebtext, then split into train/test\n",{"type":22,"tag":176,"props":1424,"children":1426},{"class":178,"line":1425},80,[1427],{"type":22,"tag":176,"props":1428,"children":1429},{"style":397},[1430],{"type":27,"value":400},{"type":22,"tag":176,"props":1432,"children":1434},{"class":178,"line":1433},81,[1435,1440,1444,1449,1454],{"type":22,"tag":176,"props":1436,"children":1437},{"style":253},[1438],{"type":27,"value":1439},"dataset ",{"type":22,"tag":176,"props":1441,"children":1442},{"style":247},[1443],{"type":27,"value":431},{"type":22,"tag":176,"props":1445,"children":1446},{"style":253},[1447],{"type":27,"value":1448}," load_dataset(",{"type":22,"tag":176,"props":1450,"children":1451},{"style":189},[1452],{"type":27,"value":1453},"\"openwebtext\"",{"type":22,"tag":176,"props":1455,"children":1456},{"style":253},[1457],{"type":27,"value":466},{"type":22,"tag":176,"props":1459,"children":1461},{"class":178,"line":1460},82,[1462,1466,1470,1475,1480,1485,1490,1494,1499],{"type":22,"tag":176,"props":1463,"children":1464},{"style":253},[1465],{"type":27,"value":1439},{"type":22,"tag":176,"props":1467,"children":1468},{"style":247},[1469],{"type":27,"value":431},{"type":22,"tag":176,"props":1471,"children":1472},{"style":253},[1473],{"type":27,"value":1474}," dataset[",{"type":22,"tag":176,"props":1476,"children":1477},{"style":189},[1478],{"type":27,"value":1479},"\"train\"",{"type":22,"tag":176,"props":1481,"children":1482},{"style":253},[1483],{"type":27,"value":1484},"].train_test_split(",{"type":22,"tag":176,"props":1486,"children":1487},{"style":602},[1488],{"type":27,"value":1489},"test_size",{"type":22,"tag":176,"props":1491,"children":1492},{"style":247},[1493],{"type":27,"value":431},{"type":22,"tag":176,"props":1495,"children":1496},{"style":749},[1497],{"type":27,"value":1498},"0.1",{"type":22,"tag":176,"props":1500,"children":1501},{"style":253},[1502],{"type":27,"value":466},{"type":22,"tag":176,"props":1504,"children":1506},{"class":178,"line":1505},83,[1507],{"type":22,"tag":176,"props":1508,"children":1509},{"emptyLinePlaceholder":5},[1510],{"type":27,"value":390},{"type":22,"tag":176,"props":1512,"children":1514},{"class":178,"line":1513},84,[1515,1520,1524],{"type":22,"tag":176,"props":1516,"children":1517},{"style":253},[1518],{"type":27,"value":1519},"tokenized_datasets ",{"type":22,"tag":176,"props":1521,"children":1522},{"style":247},[1523],{"type":27,"value":431},{"type":22,"tag":176,"props":1525,"children":1526},{"style":253},[1527],{"type":27,"value":1528}," dataset.map(\n",{"type":22,"tag":176,"props":1530,"children":1532},{"class":178,"line":1531},85,[1533],{"type":22,"tag":176,"props":1534,"children":1535},{"style":253},[1536],{"type":27,"value":1537},"    tokenize_function,\n",{"type":22,"tag":176,"props":1539,"children":1541},{"class":178,"line":1540},86,[1542,1547,1551,1555],{"type":22,"tag":176,"props":1543,"children":1544},{"style":602},[1545],{"type":27,"value":1546},"    batched",{"type":22,"tag":176,"props":1548,"children":1549},{"style":247},[1550],{"type":27,"value":431},{"type":22,"tag":176,"props":1552,"children":1553},{"style":749},[1554],{"type":27,"value":1290},{"type":22,"tag":176,"props":1556,"children":1557},{"style":253},[1558],{"type":27,"value":619},{"type":22,"tag":176,"props":1560,"children":1562},{"class":178,"line":1561},87,[1563,1568,1572,1577],{"type":22,"tag":176,"props":1564,"children":1565},{"style":602},[1566],{"type":27,"value":1567},"    batch_size",{"type":22,"tag":176,"props":1569,"children":1570},{"style":247},[1571],{"type":27,"value":431},{"type":22,"tag":176,"props":1573,"children":1574},{"style":749},[1575],{"type":27,"value":1576},"8",{"type":22,"tag":176,"props":1578,"children":1579},{"style":253},[1580],{"type":27,"value":619},{"type":22,"tag":176,"props":1582,"children":1584},{"class":178,"line":1583},88,[1585,1590,1594,1599,1603],{"type":22,"tag":176,"props":1586,"children":1587},{"style":602},[1588],{"type":27,"value":1589},"    remove_columns",{"type":22,"tag":176,"props":1591,"children":1592},{"style":247},[1593],{"type":27,"value":431},{"type":22,"tag":176,"props":1595,"children":1596},{"style":253},[1597],{"type":27,"value":1598},"[",{"type":22,"tag":176,"props":1600,"children":1601},{"style":189},[1602],{"type":27,"value":1065},{"type":22,"tag":176,"props":1604,"children":1605},{"style":253},[1606],{"type":27,"value":1607},"],\n",{"type":22,"tag":176,"props":1609,"children":1611},{"class":178,"line":1610},89,[1612,1617,1621,1626],{"type":22,"tag":176,"props":1613,"children":1614},{"style":602},[1615],{"type":27,"value":1616},"    load_from_cache_file",{"type":22,"tag":176,"props":1618,"children":1619},{"style":247},[1620],{"type":27,"value":431},{"type":22,"tag":176,"props":1622,"children":1623},{"style":749},[1624],{"type":27,"value":1625},"False",{"type":22,"tag":176,"props":1627,"children":1628},{"style":253},[1629],{"type":27,"value":619},{"type":22,"tag":176,"props":1631,"children":1633},{"class":178,"line":1632},90,[1634,1639,1643,1647],{"type":22,"tag":176,"props":1635,"children":1636},{"style":602},[1637],{"type":27,"value":1638},"    keep_in_memory",{"type":22,"tag":176,"props":1640,"children":1641},{"style":247},[1642],{"type":27,"value":431},{"type":22,"tag":176,"props":1644,"children":1645},{"style":749},[1646],{"type":27,"value":1290},{"type":22,"tag":176,"props":1648,"children":1649},{"style":253},[1650],{"type":27,"value":619},{"type":22,"tag":176,"props":1652,"children":1654},{"class":178,"line":1653},91,[1655,1660,1664],{"type":22,"tag":176,"props":1656,"children":1657},{"style":602},[1658],{"type":27,"value":1659},"    num_proc",{"type":22,"tag":176,"props":1661,"children":1662},{"style":247},[1663],{"type":27,"value":431},{"type":22,"tag":176,"props":1665,"children":1666},{"style":749},[1667],{"type":27,"value":1668},"4\n",{"type":22,"tag":176,"props":1670,"children":1672},{"class":178,"line":1671},92,[1673],{"type":22,"tag":176,"props":1674,"children":1675},{"style":253},[1676],{"type":27,"value":466},{"type":22,"tag":176,"props":1678,"children":1680},{"class":178,"line":1679},93,[1681],{"type":22,"tag":176,"props":1682,"children":1683},{"emptyLinePlaceholder":5},[1684],{"type":27,"value":390},{"type":22,"tag":176,"props":1686,"children":1688},{"class":178,"line":1687},94,[1689],{"type":22,"tag":176,"props":1690,"children":1691},{"style":397},[1692],{"type":27,"value":400},{"type":22,"tag":176,"props":1694,"children":1696},{"class":178,"line":1695},95,[1697],{"type":22,"tag":176,"props":1698,"children":1699},{"style":397},[1700],{"type":27,"value":1701},"# 8. Configure the data loader\n",{"type":22,"tag":176,"props":1703,"children":1705},{"class":178,"line":1704},96,[1706],{"type":22,"tag":176,"props":1707,"children":1708},{"style":397},[1709],{"type":27,"value":400},{"type":22,"tag":176,"props":1711,"children":1713},{"class":178,"line":1712},97,[1714,1718,1723],{"type":22,"tag":176,"props":1715,"children":1716},{"style":247},[1717],{"type":27,"value":906},{"type":22,"tag":176,"props":1719,"children":1720},{"style":183},[1721],{"type":27,"value":1722}," collate_fn",{"type":22,"tag":176,"props":1724,"children":1725},{"style":253},[1726],{"type":27,"value":1727},"(batch):\n",{"type":22,"tag":176,"props":1729,"children":1731},{"class":178,"line":1730},98,[1732,1737,1741,1746,1751,1755,1759,1764,1768,1773,1778,1782],{"type":22,"tag":176,"props":1733,"children":1734},{"style":253},[1735],{"type":27,"value":1736},"    input_ids ",{"type":22,"tag":176,"props":1738,"children":1739},{"style":247},[1740],{"type":27,"value":431},{"type":22,"tag":176,"props":1742,"children":1743},{"style":253},[1744],{"type":27,"value":1745}," torch.tensor([ex[",{"type":22,"tag":176,"props":1747,"children":1748},{"style":189},[1749],{"type":27,"value":1750},"\"input_ids\"",{"type":22,"tag":176,"props":1752,"children":1753},{"style":253},[1754],{"type":27,"value":1222},{"type":22,"tag":176,"props":1756,"children":1757},{"style":247},[1758],{"type":27,"value":1383},{"type":22,"tag":176,"props":1760,"children":1761},{"style":253},[1762],{"type":27,"value":1763}," ex ",{"type":22,"tag":176,"props":1765,"children":1766},{"style":247},[1767],{"type":27,"value":1055},{"type":22,"tag":176,"props":1769,"children":1770},{"style":253},[1771],{"type":27,"value":1772}," batch], ",{"type":22,"tag":176,"props":1774,"children":1775},{"style":602},[1776],{"type":27,"value":1777},"dtype",{"type":22,"tag":176,"props":1779,"children":1780},{"style":247},[1781],{"type":27,"value":431},{"type":22,"tag":176,"props":1783,"children":1784},{"style":253},[1785],{"type":27,"value":1786},"torch.long).to(device)\n",{"type":22,"tag":176,"props":1788,"children":1790},{"class":178,"line":1789},99,[1791,1796,1800,1804,1809,1813,1817,1821,1825,1829,1833,1837],{"type":22,"tag":176,"props":1792,"children":1793},{"style":253},[1794],{"type":27,"value":1795},"    attention_mask ",{"type":22,"tag":176,"props":1797,"children":1798},{"style":247},[1799],{"type":27,"value":431},{"type":22,"tag":176,"props":1801,"children":1802},{"style":253},[1803],{"type":27,"value":1745},{"type":22,"tag":176,"props":1805,"children":1806},{"style":189},[1807],{"type":27,"value":1808},"\"attention_mask\"",{"type":22,"tag":176,"props":1810,"children":1811},{"style":253},[1812],{"type":27,"value":1222},{"type":22,"tag":176,"props":1814,"children":1815},{"style":247},[1816],{"type":27,"value":1383},{"type":22,"tag":176,"props":1818,"children":1819},{"style":253},[1820],{"type":27,"value":1763},{"type":22,"tag":176,"props":1822,"children":1823},{"style":247},[1824],{"type":27,"value":1055},{"type":22,"tag":176,"props":1826,"children":1827},{"style":253},[1828],{"type":27,"value":1772},{"type":22,"tag":176,"props":1830,"children":1831},{"style":602},[1832],{"type":27,"value":1777},{"type":22,"tag":176,"props":1834,"children":1835},{"style":247},[1836],{"type":27,"value":431},{"type":22,"tag":176,"props":1838,"children":1839},{"style":253},[1840],{"type":27,"value":1786},{"type":22,"tag":176,"props":1842,"children":1844},{"class":178,"line":1843},100,[1845,1849],{"type":22,"tag":176,"props":1846,"children":1847},{"style":247},[1848],{"type":27,"value":962},{"type":22,"tag":176,"props":1850,"children":1851},{"style":253},[1852],{"type":27,"value":1853}," {\n",{"type":22,"tag":176,"props":1855,"children":1857},{"class":178,"line":1856},101,[1858,1863],{"type":22,"tag":176,"props":1859,"children":1860},{"style":189},[1861],{"type":27,"value":1862},"        \"input_ids\"",{"type":22,"tag":176,"props":1864,"children":1865},{"style":253},[1866],{"type":27,"value":1867},": input_ids,\n",{"type":22,"tag":176,"props":1869,"children":1871},{"class":178,"line":1870},102,[1872,1877],{"type":22,"tag":176,"props":1873,"children":1874},{"style":189},[1875],{"type":27,"value":1876},"        \"attention_mask\"",{"type":22,"tag":176,"props":1878,"children":1879},{"style":253},[1880],{"type":27,"value":1881},": attention_mask\n",{"type":22,"tag":176,"props":1883,"children":1885},{"class":178,"line":1884},103,[1886],{"type":22,"tag":176,"props":1887,"children":1888},{"style":253},[1889],{"type":27,"value":1890},"    }\n",{"type":22,"tag":176,"props":1892,"children":1894},{"class":178,"line":1893},104,[1895],{"type":22,"tag":176,"props":1896,"children":1897},{"emptyLinePlaceholder":5},[1898],{"type":27,"value":390},{"type":22,"tag":176,"props":1900,"children":1902},{"class":178,"line":1901},105,[1903,1908,1912],{"type":22,"tag":176,"props":1904,"children":1905},{"style":253},[1906],{"type":27,"value":1907},"train_loader ",{"type":22,"tag":176,"props":1909,"children":1910},{"style":247},[1911],{"type":27,"value":431},{"type":22,"tag":176,"props":1913,"children":1914},{"style":253},[1915],{"type":27,"value":1916}," DataLoader(\n",{"type":22,"tag":176,"props":1918,"children":1920},{"class":178,"line":1919},106,[1921,1926,1930],{"type":22,"tag":176,"props":1922,"children":1923},{"style":253},[1924],{"type":27,"value":1925},"    tokenized_datasets[",{"type":22,"tag":176,"props":1927,"children":1928},{"style":189},[1929],{"type":27,"value":1479},{"type":22,"tag":176,"props":1931,"children":1932},{"style":253},[1933],{"type":27,"value":1607},{"type":22,"tag":176,"props":1935,"children":1937},{"class":178,"line":1936},107,[1938,1942,1946,1950],{"type":22,"tag":176,"props":1939,"children":1940},{"style":602},[1941],{"type":27,"value":1567},{"type":22,"tag":176,"props":1943,"children":1944},{"style":247},[1945],{"type":27,"value":431},{"type":22,"tag":176,"props":1947,"children":1948},{"style":749},[1949],{"type":27,"value":1576},{"type":22,"tag":176,"props":1951,"children":1952},{"style":253},[1953],{"type":27,"value":619},{"type":22,"tag":176,"props":1955,"children":1957},{"class":178,"line":1956},108,[1958,1963,1967,1971],{"type":22,"tag":176,"props":1959,"children":1960},{"style":602},[1961],{"type":27,"value":1962},"    shuffle",{"type":22,"tag":176,"props":1964,"children":1965},{"style":247},[1966],{"type":27,"value":431},{"type":22,"tag":176,"props":1968,"children":1969},{"style":749},[1970],{"type":27,"value":1290},{"type":22,"tag":176,"props":1972,"children":1973},{"style":253},[1974],{"type":27,"value":619},{"type":22,"tag":176,"props":1976,"children":1978},{"class":178,"line":1977},109,[1979,1984,1988],{"type":22,"tag":176,"props":1980,"children":1981},{"style":602},[1982],{"type":27,"value":1983},"    collate_fn",{"type":22,"tag":176,"props":1985,"children":1986},{"style":247},[1987],{"type":27,"value":431},{"type":22,"tag":176,"props":1989,"children":1990},{"style":253},[1991],{"type":27,"value":1992},"collate_fn\n",{"type":22,"tag":176,"props":1994,"children":1996},{"class":178,"line":1995},110,[1997],{"type":22,"tag":176,"props":1998,"children":1999},{"style":253},[2000],{"type":27,"value":466},{"type":22,"tag":176,"props":2002,"children":2004},{"class":178,"line":2003},111,[2005],{"type":22,"tag":176,"props":2006,"children":2007},{"emptyLinePlaceholder":5},[2008],{"type":27,"value":390},{"type":22,"tag":176,"props":2010,"children":2012},{"class":178,"line":2011},112,[2013,2018,2022],{"type":22,"tag":176,"props":2014,"children":2015},{"style":253},[2016],{"type":27,"value":2017},"test_loader ",{"type":22,"tag":176,"props":2019,"children":2020},{"style":247},[2021],{"type":27,"value":431},{"type":22,"tag":176,"props":2023,"children":2024},{"style":253},[2025],{"type":27,"value":1916},{"type":22,"tag":176,"props":2027,"children":2029},{"class":178,"line":2028},113,[2030,2034,2039],{"type":22,"tag":176,"props":2031,"children":2032},{"style":253},[2033],{"type":27,"value":1925},{"type":22,"tag":176,"props":2035,"children":2036},{"style":189},[2037],{"type":27,"value":2038},"\"test\"",{"type":22,"tag":176,"props":2040,"children":2041},{"style":253},[2042],{"type":27,"value":1607},{"type":22,"tag":176,"props":2044,"children":2046},{"class":178,"line":2045},114,[2047,2051,2055,2060],{"type":22,"tag":176,"props":2048,"children":2049},{"style":602},[2050],{"type":27,"value":1567},{"type":22,"tag":176,"props":2052,"children":2053},{"style":247},[2054],{"type":27,"value":431},{"type":22,"tag":176,"props":2056,"children":2057},{"style":749},[2058],{"type":27,"value":2059},"1",{"type":22,"tag":176,"props":2061,"children":2062},{"style":253},[2063],{"type":27,"value":619},{"type":22,"tag":176,"props":2065,"children":2067},{"class":178,"line":2066},115,[2068,2072,2076],{"type":22,"tag":176,"props":2069,"children":2070},{"style":602},[2071],{"type":27,"value":1983},{"type":22,"tag":176,"props":2073,"children":2074},{"style":247},[2075],{"type":27,"value":431},{"type":22,"tag":176,"props":2077,"children":2078},{"style":253},[2079],{"type":27,"value":1992},{"type":22,"tag":176,"props":2081,"children":2083},{"class":178,"line":2082},116,[2084],{"type":22,"tag":176,"props":2085,"children":2086},{"style":253},[2087],{"type":27,"value":466},{"type":22,"tag":176,"props":2089,"children":2091},{"class":178,"line":2090},117,[2092],{"type":22,"tag":176,"props":2093,"children":2094},{"emptyLinePlaceholder":5},[2095],{"type":27,"value":390},{"type":22,"tag":176,"props":2097,"children":2099},{"class":178,"line":2098},118,[2100],{"type":22,"tag":176,"props":2101,"children":2102},{"style":397},[2103],{"type":27,"value":400},{"type":22,"tag":176,"props":2105,"children":2107},{"class":178,"line":2106},119,[2108],{"type":22,"tag":176,"props":2109,"children":2110},{"style":397},[2111],{"type":27,"value":2112},"# 9. Implementation of Label Smoothing\n",{"type":22,"tag":176,"props":2114,"children":2116},{"class":178,"line":2115},120,[2117],{"type":22,"tag":176,"props":2118,"children":2119},{"style":397},[2120],{"type":27,"value":400},{"type":22,"tag":176,"props":2122,"children":2124},{"class":178,"line":2123},121,[2125,2130,2135,2140,2145,2149,2154],{"type":22,"tag":176,"props":2126,"children":2127},{"style":247},[2128],{"type":27,"value":2129},"class",{"type":22,"tag":176,"props":2131,"children":2132},{"style":183},[2133],{"type":27,"value":2134}," LabelSmoothingCrossEntropy",{"type":22,"tag":176,"props":2136,"children":2137},{"style":253},[2138],{"type":27,"value":2139},"(",{"type":22,"tag":176,"props":2141,"children":2142},{"style":183},[2143],{"type":27,"value":2144},"nn",{"type":22,"tag":176,"props":2146,"children":2147},{"style":253},[2148],{"type":27,"value":105},{"type":22,"tag":176,"props":2150,"children":2151},{"style":183},[2152],{"type":27,"value":2153},"Module",{"type":22,"tag":176,"props":2155,"children":2156},{"style":253},[2157],{"type":27,"value":2158},"):\n",{"type":22,"tag":176,"props":2160,"children":2162},{"class":178,"line":2161},122,[2163,2168,2173,2178,2182,2186],{"type":22,"tag":176,"props":2164,"children":2165},{"style":247},[2166],{"type":27,"value":2167},"    def",{"type":22,"tag":176,"props":2169,"children":2170},{"style":749},[2171],{"type":27,"value":2172}," __init__",{"type":22,"tag":176,"props":2174,"children":2175},{"style":253},[2176],{"type":27,"value":2177},"(self, smoothing",{"type":22,"tag":176,"props":2179,"children":2180},{"style":247},[2181],{"type":27,"value":431},{"type":22,"tag":176,"props":2183,"children":2184},{"style":749},[2185],{"type":27,"value":1498},{"type":22,"tag":176,"props":2187,"children":2188},{"style":253},[2189],{"type":27,"value":2158},{"type":22,"tag":176,"props":2191,"children":2193},{"class":178,"line":2192},123,[2194],{"type":22,"tag":176,"props":2195,"children":2196},{"style":189},[2197],{"type":27,"value":2198},"        \"\"\"\n",{"type":22,"tag":176,"props":2200,"children":2202},{"class":178,"line":2201},124,[2203],{"type":22,"tag":176,"props":2204,"children":2205},{"style":189},[2206],{"type":27,"value":2207},"        :param smoothing: Smoothing factor, typically in [0, 1)\n",{"type":22,"tag":176,"props":2209,"children":2211},{"class":178,"line":2210},125,[2212],{"type":22,"tag":176,"props":2213,"children":2214},{"style":189},[2215],{"type":27,"value":2198},{"type":22,"tag":176,"props":2217,"children":2219},{"class":178,"line":2218},126,[2220,2225,2230,2235,2240,2245],{"type":22,"tag":176,"props":2221,"children":2222},{"style":749},[2223],{"type":27,"value":2224},"        super",{"type":22,"tag":176,"props":2226,"children":2227},{"style":253},[2228],{"type":27,"value":2229},"(LabelSmoothingCrossEntropy, ",{"type":22,"tag":176,"props":2231,"children":2232},{"style":749},[2233],{"type":27,"value":2234},"self",{"type":22,"tag":176,"props":2236,"children":2237},{"style":253},[2238],{"type":27,"value":2239},").",{"type":22,"tag":176,"props":2241,"children":2242},{"style":749},[2243],{"type":27,"value":2244},"__init__",{"type":22,"tag":176,"props":2246,"children":2247},{"style":253},[2248],{"type":27,"value":2249},"()\n",{"type":22,"tag":176,"props":2251,"children":2253},{"class":178,"line":2252},127,[2254,2259,2264,2268],{"type":22,"tag":176,"props":2255,"children":2256},{"style":749},[2257],{"type":27,"value":2258},"        self",{"type":22,"tag":176,"props":2260,"children":2261},{"style":253},[2262],{"type":27,"value":2263},".smoothing ",{"type":22,"tag":176,"props":2265,"children":2266},{"style":247},[2267],{"type":27,"value":431},{"type":22,"tag":176,"props":2269,"children":2270},{"style":253},[2271],{"type":27,"value":2272}," smoothing\n",{"type":22,"tag":176,"props":2274,"children":2276},{"class":178,"line":2275},128,[2277,2281,2286,2290,2295,2300,2305,2309],{"type":22,"tag":176,"props":2278,"children":2279},{"style":749},[2280],{"type":27,"value":2258},{"type":22,"tag":176,"props":2282,"children":2283},{"style":253},[2284],{"type":27,"value":2285},".log_softmax ",{"type":22,"tag":176,"props":2287,"children":2288},{"style":247},[2289],{"type":27,"value":431},{"type":22,"tag":176,"props":2291,"children":2292},{"style":253},[2293],{"type":27,"value":2294}," nn.LogSoftmax(",{"type":22,"tag":176,"props":2296,"children":2297},{"style":602},[2298],{"type":27,"value":2299},"dim",{"type":22,"tag":176,"props":2301,"children":2302},{"style":247},[2303],{"type":27,"value":2304},"=-",{"type":22,"tag":176,"props":2306,"children":2307},{"style":749},[2308],{"type":27,"value":2059},{"type":22,"tag":176,"props":2310,"children":2311},{"style":253},[2312],{"type":27,"value":466},{"type":22,"tag":176,"props":2314,"children":2316},{"class":178,"line":2315},129,[2317],{"type":22,"tag":176,"props":2318,"children":2319},{"emptyLinePlaceholder":5},[2320],{"type":27,"value":390},{"type":22,"tag":176,"props":2322,"children":2324},{"class":178,"line":2323},130,[2325,2329,2334],{"type":22,"tag":176,"props":2326,"children":2327},{"style":247},[2328],{"type":27,"value":2167},{"type":22,"tag":176,"props":2330,"children":2331},{"style":183},[2332],{"type":27,"value":2333}," forward",{"type":22,"tag":176,"props":2335,"children":2336},{"style":253},[2337],{"type":27,"value":2338},"(self, logits, target):\n",{"type":22,"tag":176,"props":2340,"children":2342},{"class":178,"line":2341},131,[2343,2348],{"type":22,"tag":176,"props":2344,"children":2345},{"style":247},[2346],{"type":27,"value":2347},"        with",{"type":22,"tag":176,"props":2349,"children":2350},{"style":253},[2351],{"type":27,"value":2352}," torch.no_grad():\n",{"type":22,"tag":176,"props":2354,"children":2356},{"class":178,"line":2355},132,[2357,2362,2366,2371,2376,2381,2386],{"type":22,"tag":176,"props":2358,"children":2359},{"style":253},[2360],{"type":27,"value":2361},"            pad_mask ",{"type":22,"tag":176,"props":2363,"children":2364},{"style":247},[2365],{"type":27,"value":431},{"type":22,"tag":176,"props":2367,"children":2368},{"style":253},[2369],{"type":27,"value":2370}," (target ",{"type":22,"tag":176,"props":2372,"children":2373},{"style":247},[2374],{"type":27,"value":2375},"==",{"type":22,"tag":176,"props":2377,"children":2378},{"style":247},[2379],{"type":27,"value":2380}," -",{"type":22,"tag":176,"props":2382,"children":2383},{"style":749},[2384],{"type":27,"value":2385},"100",{"type":22,"tag":176,"props":2387,"children":2388},{"style":253},[2389],{"type":27,"value":466},{"type":22,"tag":176,"props":2391,"children":2393},{"class":178,"line":2392},133,[2394,2399,2403],{"type":22,"tag":176,"props":2395,"children":2396},{"style":253},[2397],{"type":27,"value":2398},"            target ",{"type":22,"tag":176,"props":2400,"children":2401},{"style":247},[2402],{"type":27,"value":431},{"type":22,"tag":176,"props":2404,"children":2405},{"style":253},[2406],{"type":27,"value":2407}," target.clone()\n",{"type":22,"tag":176,"props":2409,"children":2411},{"class":178,"line":2410},134,[2412,2417,2421],{"type":22,"tag":176,"props":2413,"children":2414},{"style":253},[2415],{"type":27,"value":2416},"            target[pad_mask] ",{"type":22,"tag":176,"props":2418,"children":2419},{"style":247},[2420],{"type":27,"value":431},{"type":22,"tag":176,"props":2422,"children":2423},{"style":749},[2424],{"type":27,"value":2425}," 0\n",{"type":22,"tag":176,"props":2427,"children":2429},{"class":178,"line":2428},135,[2430,2435,2439,2444],{"type":22,"tag":176,"props":2431,"children":2432},{"style":253},[2433],{"type":27,"value":2434},"        log_probs ",{"type":22,"tag":176,"props":2436,"children":2437},{"style":247},[2438],{"type":27,"value":431},{"type":22,"tag":176,"props":2440,"children":2441},{"style":749},[2442],{"type":27,"value":2443}," self",{"type":22,"tag":176,"props":2445,"children":2446},{"style":253},[2447],{"type":27,"value":2448},".log_softmax(logits)\n",{"type":22,"tag":176,"props":2450,"children":2452},{"class":178,"line":2451},136,[2453,2458,2462,2466,2471,2475,2479,2483,2488,2493,2497,2502,2506,2511,2515],{"type":22,"tag":176,"props":2454,"children":2455},{"style":253},[2456],{"type":27,"value":2457},"        nll_loss ",{"type":22,"tag":176,"props":2459,"children":2460},{"style":247},[2461],{"type":27,"value":431},{"type":22,"tag":176,"props":2463,"children":2464},{"style":247},[2465],{"type":27,"value":2380},{"type":22,"tag":176,"props":2467,"children":2468},{"style":253},[2469],{"type":27,"value":2470},"log_probs.gather(",{"type":22,"tag":176,"props":2472,"children":2473},{"style":602},[2474],{"type":27,"value":2299},{"type":22,"tag":176,"props":2476,"children":2477},{"style":247},[2478],{"type":27,"value":2304},{"type":22,"tag":176,"props":2480,"children":2481},{"style":749},[2482],{"type":27,"value":2059},{"type":22,"tag":176,"props":2484,"children":2485},{"style":253},[2486],{"type":27,"value":2487},", ",{"type":22,"tag":176,"props":2489,"children":2490},{"style":602},[2491],{"type":27,"value":2492},"index",{"type":22,"tag":176,"props":2494,"children":2495},{"style":247},[2496],{"type":27,"value":431},{"type":22,"tag":176,"props":2498,"children":2499},{"style":253},[2500],{"type":27,"value":2501},"target.unsqueeze(",{"type":22,"tag":176,"props":2503,"children":2504},{"style":749},[2505],{"type":27,"value":2059},{"type":22,"tag":176,"props":2507,"children":2508},{"style":253},[2509],{"type":27,"value":2510},")).squeeze(",{"type":22,"tag":176,"props":2512,"children":2513},{"style":749},[2514],{"type":27,"value":2059},{"type":22,"tag":176,"props":2516,"children":2517},{"style":253},[2518],{"type":27,"value":466},{"type":22,"tag":176,"props":2520,"children":2522},{"class":178,"line":2521},137,[2523,2528,2532,2536,2541,2545,2549,2553],{"type":22,"tag":176,"props":2524,"children":2525},{"style":253},[2526],{"type":27,"value":2527},"        smooth_loss ",{"type":22,"tag":176,"props":2529,"children":2530},{"style":247},[2531],{"type":27,"value":431},{"type":22,"tag":176,"props":2533,"children":2534},{"style":247},[2535],{"type":27,"value":2380},{"type":22,"tag":176,"props":2537,"children":2538},{"style":253},[2539],{"type":27,"value":2540},"log_probs.mean(",{"type":22,"tag":176,"props":2542,"children":2543},{"style":602},[2544],{"type":27,"value":2299},{"type":22,"tag":176,"props":2546,"children":2547},{"style":247},[2548],{"type":27,"value":2304},{"type":22,"tag":176,"props":2550,"children":2551},{"style":749},[2552],{"type":27,"value":2059},{"type":22,"tag":176,"props":2554,"children":2555},{"style":253},[2556],{"type":27,"value":466},{"type":22,"tag":176,"props":2558,"children":2560},{"class":178,"line":2559},138,[2561,2566,2570],{"type":22,"tag":176,"props":2562,"children":2563},{"style":253},[2564],{"type":27,"value":2565},"        nll_loss[pad_mask] ",{"type":22,"tag":176,"props":2567,"children":2568},{"style":247},[2569],{"type":27,"value":431},{"type":22,"tag":176,"props":2571,"children":2572},{"style":749},[2573],{"type":27,"value":2574}," 0.0\n",{"type":22,"tag":176,"props":2576,"children":2578},{"class":178,"line":2577},139,[2579,2584,2588],{"type":22,"tag":176,"props":2580,"children":2581},{"style":253},[2582],{"type":27,"value":2583},"        smooth_loss[pad_mask] ",{"type":22,"tag":176,"props":2585,"children":2586},{"style":247},[2587],{"type":27,"value":431},{"type":22,"tag":176,"props":2589,"children":2590},{"style":749},[2591],{"type":27,"value":2574},{"type":22,"tag":176,"props":2593,"children":2595},{"class":178,"line":2594},140,[2596,2601,2605,2610,2615,2619,2623,2628,2632,2637,2642,2646,2650,2654],{"type":22,"tag":176,"props":2597,"children":2598},{"style":253},[2599],{"type":27,"value":2600},"        loss ",{"type":22,"tag":176,"props":2602,"children":2603},{"style":247},[2604],{"type":27,"value":431},{"type":22,"tag":176,"props":2606,"children":2607},{"style":253},[2608],{"type":27,"value":2609}," (",{"type":22,"tag":176,"props":2611,"children":2612},{"style":749},[2613],{"type":27,"value":2614},"1.0",{"type":22,"tag":176,"props":2616,"children":2617},{"style":247},[2618],{"type":27,"value":2380},{"type":22,"tag":176,"props":2620,"children":2621},{"style":749},[2622],{"type":27,"value":2443},{"type":22,"tag":176,"props":2624,"children":2625},{"style":253},[2626],{"type":27,"value":2627},".smoothing) ",{"type":22,"tag":176,"props":2629,"children":2630},{"style":247},[2631],{"type":27,"value":1227},{"type":22,"tag":176,"props":2633,"children":2634},{"style":253},[2635],{"type":27,"value":2636}," nll_loss ",{"type":22,"tag":176,"props":2638,"children":2639},{"style":247},[2640],{"type":27,"value":2641},"+",{"type":22,"tag":176,"props":2643,"children":2644},{"style":749},[2645],{"type":27,"value":2443},{"type":22,"tag":176,"props":2647,"children":2648},{"style":253},[2649],{"type":27,"value":2263},{"type":22,"tag":176,"props":2651,"children":2652},{"style":247},[2653],{"type":27,"value":1227},{"type":22,"tag":176,"props":2655,"children":2656},{"style":253},[2657],{"type":27,"value":2658}," smooth_loss\n",{"type":22,"tag":176,"props":2660,"children":2662},{"class":178,"line":2661},141,[2663,2668],{"type":22,"tag":176,"props":2664,"children":2665},{"style":247},[2666],{"type":27,"value":2667},"        return",{"type":22,"tag":176,"props":2669,"children":2670},{"style":253},[2671],{"type":27,"value":2672}," loss.mean()\n",{"type":22,"tag":176,"props":2674,"children":2676},{"class":178,"line":2675},142,[2677],{"type":22,"tag":176,"props":2678,"children":2679},{"emptyLinePlaceholder":5},[2680],{"type":27,"value":390},{"type":22,"tag":176,"props":2682,"children":2684},{"class":178,"line":2683},143,[2685,2690,2694,2699,2704,2708,2712],{"type":22,"tag":176,"props":2686,"children":2687},{"style":253},[2688],{"type":27,"value":2689},"label_smoothing_loss_fn ",{"type":22,"tag":176,"props":2691,"children":2692},{"style":247},[2693],{"type":27,"value":431},{"type":22,"tag":176,"props":2695,"children":2696},{"style":253},[2697],{"type":27,"value":2698}," LabelSmoothingCrossEntropy(",{"type":22,"tag":176,"props":2700,"children":2701},{"style":602},[2702],{"type":27,"value":2703},"smoothing",{"type":22,"tag":176,"props":2705,"children":2706},{"style":247},[2707],{"type":27,"value":431},{"type":22,"tag":176,"props":2709,"children":2710},{"style":749},[2711],{"type":27,"value":1498},{"type":22,"tag":176,"props":2713,"children":2714},{"style":253},[2715],{"type":27,"value":466},{"type":22,"tag":176,"props":2717,"children":2719},{"class":178,"line":2718},144,[2720],{"type":22,"tag":176,"props":2721,"children":2722},{"emptyLinePlaceholder":5},[2723],{"type":27,"value":390},{"type":22,"tag":176,"props":2725,"children":2727},{"class":178,"line":2726},145,[2728],{"type":22,"tag":176,"props":2729,"children":2730},{"style":397},[2731],{"type":27,"value":400},{"type":22,"tag":176,"props":2733,"children":2735},{"class":178,"line":2734},146,[2736],{"type":22,"tag":176,"props":2737,"children":2738},{"style":397},[2739],{"type":27,"value":2740},"# 10. Improved distillation loss function\n",{"type":22,"tag":176,"props":2742,"children":2744},{"class":178,"line":2743},147,[2745],{"type":22,"tag":176,"props":2746,"children":2747},{"style":397},[2748],{"type":27,"value":400},{"type":22,"tag":176,"props":2750,"children":2752},{"class":178,"line":2751},148,[2753,2757,2762,2767,2771,2776,2781,2785,2790],{"type":22,"tag":176,"props":2754,"children":2755},{"style":247},[2756],{"type":27,"value":906},{"type":22,"tag":176,"props":2758,"children":2759},{"style":183},[2760],{"type":27,"value":2761}," distillation_loss",{"type":22,"tag":176,"props":2763,"children":2764},{"style":253},[2765],{"type":27,"value":2766},"(student_outputs, teacher_outputs, labels, temperature",{"type":22,"tag":176,"props":2768,"children":2769},{"style":247},[2770],{"type":27,"value":431},{"type":22,"tag":176,"props":2772,"children":2773},{"style":749},[2774],{"type":27,"value":2775},"3.0",{"type":22,"tag":176,"props":2777,"children":2778},{"style":253},[2779],{"type":27,"value":2780},", alpha",{"type":22,"tag":176,"props":2782,"children":2783},{"style":247},[2784],{"type":27,"value":431},{"type":22,"tag":176,"props":2786,"children":2787},{"style":749},[2788],{"type":27,"value":2789},"0.7",{"type":22,"tag":176,"props":2791,"children":2792},{"style":253},[2793],{"type":27,"value":2158},{"type":22,"tag":176,"props":2795,"children":2797},{"class":178,"line":2796},149,[2798,2803,2807],{"type":22,"tag":176,"props":2799,"children":2800},{"style":253},[2801],{"type":27,"value":2802},"    student_logits ",{"type":22,"tag":176,"props":2804,"children":2805},{"style":247},[2806],{"type":27,"value":431},{"type":22,"tag":176,"props":2808,"children":2809},{"style":253},[2810],{"type":27,"value":2811}," student_outputs.logits\n",{"type":22,"tag":176,"props":2813,"children":2815},{"class":178,"line":2814},150,[2816,2821,2825],{"type":22,"tag":176,"props":2817,"children":2818},{"style":253},[2819],{"type":27,"value":2820},"    teacher_logits ",{"type":22,"tag":176,"props":2822,"children":2823},{"style":247},[2824],{"type":27,"value":431},{"type":22,"tag":176,"props":2826,"children":2827},{"style":253},[2828],{"type":27,"value":2829}," teacher_outputs.logits.detach()\n",{"type":22,"tag":176,"props":2831,"children":2833},{"class":178,"line":2832},151,[2834,2839,2843],{"type":22,"tag":176,"props":2835,"children":2836},{"style":253},[2837],{"type":27,"value":2838},"    labels ",{"type":22,"tag":176,"props":2840,"children":2841},{"style":247},[2842],{"type":27,"value":431},{"type":22,"tag":176,"props":2844,"children":2845},{"style":253},[2846],{"type":27,"value":2847}," labels.to(student_logits.device)\n",{"type":22,"tag":176,"props":2849,"children":2851},{"class":178,"line":2850},152,[2852],{"type":22,"tag":176,"props":2853,"children":2854},{"emptyLinePlaceholder":5},[2855],{"type":27,"value":390},{"type":22,"tag":176,"props":2857,"children":2859},{"class":178,"line":2858},153,[2860],{"type":22,"tag":176,"props":2861,"children":2862},{"style":397},[2863],{"type":27,"value":2864},"    # Hard loss from label smoothing\n",{"type":22,"tag":176,"props":2866,"children":2868},{"class":178,"line":2867},154,[2869,2874,2878],{"type":22,"tag":176,"props":2870,"children":2871},{"style":253},[2872],{"type":27,"value":2873},"    hard_loss ",{"type":22,"tag":176,"props":2875,"children":2876},{"style":247},[2877],{"type":27,"value":431},{"type":22,"tag":176,"props":2879,"children":2880},{"style":253},[2881],{"type":27,"value":2882}," label_smoothing_loss_fn(\n",{"type":22,"tag":176,"props":2884,"children":2886},{"class":178,"line":2885},155,[2887,2892,2897,2901,2906,2910,2914],{"type":22,"tag":176,"props":2888,"children":2889},{"style":253},[2890],{"type":27,"value":2891},"        student_logits.view(",{"type":22,"tag":176,"props":2893,"children":2894},{"style":247},[2895],{"type":27,"value":2896},"-",{"type":22,"tag":176,"props":2898,"children":2899},{"style":749},[2900],{"type":27,"value":2059},{"type":22,"tag":176,"props":2902,"children":2903},{"style":253},[2904],{"type":27,"value":2905},", student_logits.size(",{"type":22,"tag":176,"props":2907,"children":2908},{"style":247},[2909],{"type":27,"value":2896},{"type":22,"tag":176,"props":2911,"children":2912},{"style":749},[2913],{"type":27,"value":2059},{"type":22,"tag":176,"props":2915,"children":2916},{"style":253},[2917],{"type":27,"value":2918},")),\n",{"type":22,"tag":176,"props":2920,"children":2922},{"class":178,"line":2921},156,[2923,2928,2932,2936],{"type":22,"tag":176,"props":2924,"children":2925},{"style":253},[2926],{"type":27,"value":2927},"        labels.view(",{"type":22,"tag":176,"props":2929,"children":2930},{"style":247},[2931],{"type":27,"value":2896},{"type":22,"tag":176,"props":2933,"children":2934},{"style":749},[2935],{"type":27,"value":2059},{"type":22,"tag":176,"props":2937,"children":2938},{"style":253},[2939],{"type":27,"value":466},{"type":22,"tag":176,"props":2941,"children":2943},{"class":178,"line":2942},157,[2944],{"type":22,"tag":176,"props":2945,"children":2946},{"style":253},[2947],{"type":27,"value":1365},{"type":22,"tag":176,"props":2949,"children":2951},{"class":178,"line":2950},158,[2952],{"type":22,"tag":176,"props":2953,"children":2954},{"style":397},[2955],{"type":27,"value":2956},"    # Soft loss from teacher logits\n",{"type":22,"tag":176,"props":2958,"children":2960},{"class":178,"line":2959},159,[2961,2966,2970,2975,2980,2984,2989],{"type":22,"tag":176,"props":2962,"children":2963},{"style":253},[2964],{"type":27,"value":2965},"    soft_loss ",{"type":22,"tag":176,"props":2967,"children":2968},{"style":247},[2969],{"type":27,"value":431},{"type":22,"tag":176,"props":2971,"children":2972},{"style":253},[2973],{"type":27,"value":2974}," nn.KLDivLoss(",{"type":22,"tag":176,"props":2976,"children":2977},{"style":602},[2978],{"type":27,"value":2979},"reduction",{"type":22,"tag":176,"props":2981,"children":2982},{"style":247},[2983],{"type":27,"value":431},{"type":22,"tag":176,"props":2985,"children":2986},{"style":189},[2987],{"type":27,"value":2988},"'batchmean'",{"type":22,"tag":176,"props":2990,"children":2991},{"style":253},[2992],{"type":27,"value":2993},")(\n",{"type":22,"tag":176,"props":2995,"children":2997},{"class":178,"line":2996},160,[2998,3003,3008,3013,3017,3021,3025],{"type":22,"tag":176,"props":2999,"children":3000},{"style":253},[3001],{"type":27,"value":3002},"        nn.functional.log_softmax(student_logits ",{"type":22,"tag":176,"props":3004,"children":3005},{"style":247},[3006],{"type":27,"value":3007},"/",{"type":22,"tag":176,"props":3009,"children":3010},{"style":253},[3011],{"type":27,"value":3012}," temperature, ",{"type":22,"tag":176,"props":3014,"children":3015},{"style":602},[3016],{"type":27,"value":2299},{"type":22,"tag":176,"props":3018,"children":3019},{"style":247},[3020],{"type":27,"value":2304},{"type":22,"tag":176,"props":3022,"children":3023},{"style":749},[3024],{"type":27,"value":2059},{"type":22,"tag":176,"props":3026,"children":3027},{"style":253},[3028],{"type":27,"value":3029},"),\n",{"type":22,"tag":176,"props":3031,"children":3033},{"class":178,"line":3032},161,[3034,3039,3043,3047,3051,3055,3059],{"type":22,"tag":176,"props":3035,"children":3036},{"style":253},[3037],{"type":27,"value":3038},"        nn.functional.softmax(teacher_logits ",{"type":22,"tag":176,"props":3040,"children":3041},{"style":247},[3042],{"type":27,"value":3007},{"type":22,"tag":176,"props":3044,"children":3045},{"style":253},[3046],{"type":27,"value":3012},{"type":22,"tag":176,"props":3048,"children":3049},{"style":602},[3050],{"type":27,"value":2299},{"type":22,"tag":176,"props":3052,"children":3053},{"style":247},[3054],{"type":27,"value":2304},{"type":22,"tag":176,"props":3056,"children":3057},{"style":749},[3058],{"type":27,"value":2059},{"type":22,"tag":176,"props":3060,"children":3061},{"style":253},[3062],{"type":27,"value":466},{"type":22,"tag":176,"props":3064,"children":3066},{"class":178,"line":3065},162,[3067,3072,3076,3081,3086,3091],{"type":22,"tag":176,"props":3068,"children":3069},{"style":253},[3070],{"type":27,"value":3071},"    ) ",{"type":22,"tag":176,"props":3073,"children":3074},{"style":247},[3075],{"type":27,"value":1227},{"type":22,"tag":176,"props":3077,"children":3078},{"style":253},[3079],{"type":27,"value":3080}," (temperature ",{"type":22,"tag":176,"props":3082,"children":3083},{"style":247},[3084],{"type":27,"value":3085},"**",{"type":22,"tag":176,"props":3087,"children":3088},{"style":749},[3089],{"type":27,"value":3090}," 2",{"type":22,"tag":176,"props":3092,"children":3093},{"style":253},[3094],{"type":27,"value":466},{"type":22,"tag":176,"props":3096,"children":3098},{"class":178,"line":3097},163,[3099],{"type":22,"tag":176,"props":3100,"children":3101},{"emptyLinePlaceholder":5},[3102],{"type":27,"value":390},{"type":22,"tag":176,"props":3104,"children":3106},{"class":178,"line":3105},164,[3107,3111,3116,3120,3125,3129,3133,3137,3141,3146,3150],{"type":22,"tag":176,"props":3108,"children":3109},{"style":247},[3110],{"type":27,"value":962},{"type":22,"tag":176,"props":3112,"children":3113},{"style":253},[3114],{"type":27,"value":3115}," alpha ",{"type":22,"tag":176,"props":3117,"children":3118},{"style":247},[3119],{"type":27,"value":1227},{"type":22,"tag":176,"props":3121,"children":3122},{"style":253},[3123],{"type":27,"value":3124}," hard_loss ",{"type":22,"tag":176,"props":3126,"children":3127},{"style":247},[3128],{"type":27,"value":2641},{"type":22,"tag":176,"props":3130,"children":3131},{"style":253},[3132],{"type":27,"value":2609},{"type":22,"tag":176,"props":3134,"children":3135},{"style":749},[3136],{"type":27,"value":2059},{"type":22,"tag":176,"props":3138,"children":3139},{"style":247},[3140],{"type":27,"value":2380},{"type":22,"tag":176,"props":3142,"children":3143},{"style":253},[3144],{"type":27,"value":3145}," alpha) ",{"type":22,"tag":176,"props":3147,"children":3148},{"style":247},[3149],{"type":27,"value":1227},{"type":22,"tag":176,"props":3151,"children":3152},{"style":253},[3153],{"type":27,"value":3154}," soft_loss\n",{"type":22,"tag":176,"props":3156,"children":3158},{"class":178,"line":3157},165,[3159],{"type":22,"tag":176,"props":3160,"children":3161},{"emptyLinePlaceholder":5},[3162],{"type":27,"value":390},{"type":22,"tag":176,"props":3164,"children":3166},{"class":178,"line":3165},166,[3167],{"type":22,"tag":176,"props":3168,"children":3169},{"style":397},[3170],{"type":27,"value":400},{"type":22,"tag":176,"props":3172,"children":3174},{"class":178,"line":3173},167,[3175],{"type":22,"tag":176,"props":3176,"children":3177},{"style":397},[3178],{"type":27,"value":3179},"# 11. Enhanced training loop\n",{"type":22,"tag":176,"props":3181,"children":3183},{"class":178,"line":3182},168,[3184],{"type":22,"tag":176,"props":3185,"children":3186},{"style":397},[3187],{"type":27,"value":400},{"type":22,"tag":176,"props":3189,"children":3191},{"class":178,"line":3190},169,[3192,3196,3201,3206,3210,3215,3220,3224,3229,3234,3238,3243],{"type":22,"tag":176,"props":3193,"children":3194},{"style":247},[3195],{"type":27,"value":906},{"type":22,"tag":176,"props":3197,"children":3198},{"style":183},[3199],{"type":27,"value":3200}," train_student",{"type":22,"tag":176,"props":3202,"children":3203},{"style":253},[3204],{"type":27,"value":3205},"(student_model, teacher_model, train_loader, epochs",{"type":22,"tag":176,"props":3207,"children":3208},{"style":247},[3209],{"type":27,"value":431},{"type":22,"tag":176,"props":3211,"children":3212},{"style":749},[3213],{"type":27,"value":3214},"3",{"type":22,"tag":176,"props":3216,"children":3217},{"style":253},[3218],{"type":27,"value":3219},", lr",{"type":22,"tag":176,"props":3221,"children":3222},{"style":247},[3223],{"type":27,"value":431},{"type":22,"tag":176,"props":3225,"children":3226},{"style":749},[3227],{"type":27,"value":3228},"3e-6",{"type":22,"tag":176,"props":3230,"children":3231},{"style":253},[3232],{"type":27,"value":3233},", output_dir",{"type":22,"tag":176,"props":3235,"children":3236},{"style":247},[3237],{"type":27,"value":431},{"type":22,"tag":176,"props":3239,"children":3240},{"style":189},[3241],{"type":27,"value":3242},"\"distilled_model\"",{"type":22,"tag":176,"props":3244,"children":3245},{"style":253},[3246],{"type":27,"value":2158},{"type":22,"tag":176,"props":3248,"children":3250},{"class":178,"line":3249},170,[3251,3256,3260,3265,3270,3274,3279,3284,3288,3293],{"type":22,"tag":176,"props":3252,"children":3253},{"style":253},[3254],{"type":27,"value":3255},"    optimizer ",{"type":22,"tag":176,"props":3257,"children":3258},{"style":247},[3259],{"type":27,"value":431},{"type":22,"tag":176,"props":3261,"children":3262},{"style":253},[3263],{"type":27,"value":3264}," optim.AdamW(student_model.parameters(), ",{"type":22,"tag":176,"props":3266,"children":3267},{"style":602},[3268],{"type":27,"value":3269},"lr",{"type":22,"tag":176,"props":3271,"children":3272},{"style":247},[3273],{"type":27,"value":431},{"type":22,"tag":176,"props":3275,"children":3276},{"style":253},[3277],{"type":27,"value":3278},"lr, ",{"type":22,"tag":176,"props":3280,"children":3281},{"style":602},[3282],{"type":27,"value":3283},"weight_decay",{"type":22,"tag":176,"props":3285,"children":3286},{"style":247},[3287],{"type":27,"value":431},{"type":22,"tag":176,"props":3289,"children":3290},{"style":749},[3291],{"type":27,"value":3292},"0.01",{"type":22,"tag":176,"props":3294,"children":3295},{"style":253},[3296],{"type":27,"value":466},{"type":22,"tag":176,"props":3298,"children":3300},{"class":178,"line":3299},171,[3301,3306,3311,3315,3319],{"type":22,"tag":176,"props":3302,"children":3303},{"style":253},[3304],{"type":27,"value":3305},"    os.makedirs(output_dir, ",{"type":22,"tag":176,"props":3307,"children":3308},{"style":602},[3309],{"type":27,"value":3310},"exist_ok",{"type":22,"tag":176,"props":3312,"children":3313},{"style":247},[3314],{"type":27,"value":431},{"type":22,"tag":176,"props":3316,"children":3317},{"style":749},[3318],{"type":27,"value":1290},{"type":22,"tag":176,"props":3320,"children":3321},{"style":253},[3322],{"type":27,"value":466},{"type":22,"tag":176,"props":3324,"children":3326},{"class":178,"line":3325},172,[3327],{"type":22,"tag":176,"props":3328,"children":3329},{"emptyLinePlaceholder":5},[3330],{"type":27,"value":390},{"type":22,"tag":176,"props":3332,"children":3334},{"class":178,"line":3333},173,[3335,3339,3344,3348,3353],{"type":22,"tag":176,"props":3336,"children":3337},{"style":247},[3338],{"type":27,"value":1045},{"type":22,"tag":176,"props":3340,"children":3341},{"style":253},[3342],{"type":27,"value":3343}," epoch ",{"type":22,"tag":176,"props":3345,"children":3346},{"style":247},[3347],{"type":27,"value":1055},{"type":22,"tag":176,"props":3349,"children":3350},{"style":749},[3351],{"type":27,"value":3352}," range",{"type":22,"tag":176,"props":3354,"children":3355},{"style":253},[3356],{"type":27,"value":3357},"(epochs):\n",{"type":22,"tag":176,"props":3359,"children":3361},{"class":178,"line":3360},174,[3362],{"type":22,"tag":176,"props":3363,"children":3364},{"style":253},[3365],{"type":27,"value":3366},"        student_model.train()\n",{"type":22,"tag":176,"props":3368,"children":3370},{"class":178,"line":3369},175,[3371,3376,3380],{"type":22,"tag":176,"props":3372,"children":3373},{"style":253},[3374],{"type":27,"value":3375},"        total_loss ",{"type":22,"tag":176,"props":3377,"children":3378},{"style":247},[3379],{"type":27,"value":431},{"type":22,"tag":176,"props":3381,"children":3382},{"style":749},[3383],{"type":27,"value":2574},{"type":22,"tag":176,"props":3385,"children":3387},{"class":178,"line":3386},176,[3388,3393,3398,3402,3407],{"type":22,"tag":176,"props":3389,"children":3390},{"style":247},[3391],{"type":27,"value":3392},"        for",{"type":22,"tag":176,"props":3394,"children":3395},{"style":253},[3396],{"type":27,"value":3397}," batch_idx, batch ",{"type":22,"tag":176,"props":3399,"children":3400},{"style":247},[3401],{"type":27,"value":1055},{"type":22,"tag":176,"props":3403,"children":3404},{"style":749},[3405],{"type":27,"value":3406}," enumerate",{"type":22,"tag":176,"props":3408,"children":3409},{"style":253},[3410],{"type":27,"value":3411},"(train_loader):\n",{"type":22,"tag":176,"props":3413,"children":3415},{"class":178,"line":3414},177,[3416,3421,3425,3430,3434],{"type":22,"tag":176,"props":3417,"children":3418},{"style":253},[3419],{"type":27,"value":3420},"            inputs ",{"type":22,"tag":176,"props":3422,"children":3423},{"style":247},[3424],{"type":27,"value":431},{"type":22,"tag":176,"props":3426,"children":3427},{"style":253},[3428],{"type":27,"value":3429}," batch[",{"type":22,"tag":176,"props":3431,"children":3432},{"style":189},[3433],{"type":27,"value":1750},{"type":22,"tag":176,"props":3435,"children":3436},{"style":253},[3437],{"type":27,"value":3438},"]\n",{"type":22,"tag":176,"props":3440,"children":3442},{"class":178,"line":3441},178,[3443,3448,3452,3456,3460],{"type":22,"tag":176,"props":3444,"children":3445},{"style":253},[3446],{"type":27,"value":3447},"            attention_mask ",{"type":22,"tag":176,"props":3449,"children":3450},{"style":247},[3451],{"type":27,"value":431},{"type":22,"tag":176,"props":3453,"children":3454},{"style":253},[3455],{"type":27,"value":3429},{"type":22,"tag":176,"props":3457,"children":3458},{"style":189},[3459],{"type":27,"value":1808},{"type":22,"tag":176,"props":3461,"children":3462},{"style":253},[3463],{"type":27,"value":3438},{"type":22,"tag":176,"props":3465,"children":3467},{"class":178,"line":3466},179,[3468,3473,3477],{"type":22,"tag":176,"props":3469,"children":3470},{"style":253},[3471],{"type":27,"value":3472},"            labels ",{"type":22,"tag":176,"props":3474,"children":3475},{"style":247},[3476],{"type":27,"value":431},{"type":22,"tag":176,"props":3478,"children":3479},{"style":253},[3480],{"type":27,"value":3481}," inputs.clone()\n",{"type":22,"tag":176,"props":3483,"children":3485},{"class":178,"line":3484},180,[3486,3491,3495,3500,3504,3508],{"type":22,"tag":176,"props":3487,"children":3488},{"style":253},[3489],{"type":27,"value":3490},"            labels[labels ",{"type":22,"tag":176,"props":3492,"children":3493},{"style":247},[3494],{"type":27,"value":2375},{"type":22,"tag":176,"props":3496,"children":3497},{"style":253},[3498],{"type":27,"value":3499}," tokenizer.pad_token_id] ",{"type":22,"tag":176,"props":3501,"children":3502},{"style":247},[3503],{"type":27,"value":431},{"type":22,"tag":176,"props":3505,"children":3506},{"style":247},[3507],{"type":27,"value":2380},{"type":22,"tag":176,"props":3509,"children":3510},{"style":749},[3511],{"type":27,"value":3512},"100\n",{"type":22,"tag":176,"props":3514,"children":3516},{"class":178,"line":3515},181,[3517],{"type":22,"tag":176,"props":3518,"children":3519},{"emptyLinePlaceholder":5},[3520],{"type":27,"value":390},{"type":22,"tag":176,"props":3522,"children":3524},{"class":178,"line":3523},182,[3525],{"type":22,"tag":176,"props":3526,"children":3527},{"style":253},[3528],{"type":27,"value":3529},"            optimizer.zero_grad()\n",{"type":22,"tag":176,"props":3531,"children":3533},{"class":178,"line":3532},183,[3534,3539],{"type":22,"tag":176,"props":3535,"children":3536},{"style":247},[3537],{"type":27,"value":3538},"            with",{"type":22,"tag":176,"props":3540,"children":3541},{"style":253},[3542],{"type":27,"value":2352},{"type":22,"tag":176,"props":3544,"children":3546},{"class":178,"line":3545},184,[3547,3552,3556,3561,3566,3570,3575,3580,3584],{"type":22,"tag":176,"props":3548,"children":3549},{"style":253},[3550],{"type":27,"value":3551},"                teacher_outputs ",{"type":22,"tag":176,"props":3553,"children":3554},{"style":247},[3555],{"type":27,"value":431},{"type":22,"tag":176,"props":3557,"children":3558},{"style":253},[3559],{"type":27,"value":3560}," teacher_model(",{"type":22,"tag":176,"props":3562,"children":3563},{"style":602},[3564],{"type":27,"value":3565},"input_ids",{"type":22,"tag":176,"props":3567,"children":3568},{"style":247},[3569],{"type":27,"value":431},{"type":22,"tag":176,"props":3571,"children":3572},{"style":253},[3573],{"type":27,"value":3574},"inputs, ",{"type":22,"tag":176,"props":3576,"children":3577},{"style":602},[3578],{"type":27,"value":3579},"attention_mask",{"type":22,"tag":176,"props":3581,"children":3582},{"style":247},[3583],{"type":27,"value":431},{"type":22,"tag":176,"props":3585,"children":3586},{"style":253},[3587],{"type":27,"value":3588},"attention_mask)\n",{"type":22,"tag":176,"props":3590,"children":3592},{"class":178,"line":3591},185,[3593,3598,3602,3607,3611,3615,3619,3623,3627],{"type":22,"tag":176,"props":3594,"children":3595},{"style":253},[3596],{"type":27,"value":3597},"            student_outputs ",{"type":22,"tag":176,"props":3599,"children":3600},{"style":247},[3601],{"type":27,"value":431},{"type":22,"tag":176,"props":3603,"children":3604},{"style":253},[3605],{"type":27,"value":3606}," student_model(",{"type":22,"tag":176,"props":3608,"children":3609},{"style":602},[3610],{"type":27,"value":3565},{"type":22,"tag":176,"props":3612,"children":3613},{"style":247},[3614],{"type":27,"value":431},{"type":22,"tag":176,"props":3616,"children":3617},{"style":253},[3618],{"type":27,"value":3574},{"type":22,"tag":176,"props":3620,"children":3621},{"style":602},[3622],{"type":27,"value":3579},{"type":22,"tag":176,"props":3624,"children":3625},{"style":247},[3626],{"type":27,"value":431},{"type":22,"tag":176,"props":3628,"children":3629},{"style":253},[3630],{"type":27,"value":3588},{"type":22,"tag":176,"props":3632,"children":3634},{"class":178,"line":3633},186,[3635],{"type":22,"tag":176,"props":3636,"children":3637},{"emptyLinePlaceholder":5},[3638],{"type":27,"value":390},{"type":22,"tag":176,"props":3640,"children":3642},{"class":178,"line":3641},187,[3643,3648,3652],{"type":22,"tag":176,"props":3644,"children":3645},{"style":253},[3646],{"type":27,"value":3647},"            loss ",{"type":22,"tag":176,"props":3649,"children":3650},{"style":247},[3651],{"type":27,"value":431},{"type":22,"tag":176,"props":3653,"children":3654},{"style":253},[3655],{"type":27,"value":3656}," distillation_loss(student_outputs, teacher_outputs, labels)\n",{"type":22,"tag":176,"props":3658,"children":3660},{"class":178,"line":3659},188,[3661],{"type":22,"tag":176,"props":3662,"children":3663},{"style":253},[3664],{"type":27,"value":3665},"            loss.backward()\n",{"type":22,"tag":176,"props":3667,"children":3669},{"class":178,"line":3668},189,[3670],{"type":22,"tag":176,"props":3671,"children":3672},{"style":253},[3673],{"type":27,"value":3674},"            optimizer.step()\n",{"type":22,"tag":176,"props":3676,"children":3678},{"class":178,"line":3677},190,[3679],{"type":22,"tag":176,"props":3680,"children":3681},{"emptyLinePlaceholder":5},[3682],{"type":27,"value":390},{"type":22,"tag":176,"props":3684,"children":3686},{"class":178,"line":3685},191,[3687,3692,3697],{"type":22,"tag":176,"props":3688,"children":3689},{"style":253},[3690],{"type":27,"value":3691},"            total_loss ",{"type":22,"tag":176,"props":3693,"children":3694},{"style":247},[3695],{"type":27,"value":3696},"+=",{"type":22,"tag":176,"props":3698,"children":3699},{"style":253},[3700],{"type":27,"value":3701}," loss.item()\n",{"type":22,"tag":176,"props":3703,"children":3705},{"class":178,"line":3704},192,[3706],{"type":22,"tag":176,"props":3707,"children":3708},{"style":397},[3709],{"type":27,"value":3710},"            # Print progress occasionally\n",{"type":22,"tag":176,"props":3712,"children":3714},{"class":178,"line":3713},193,[3715,3720,3725,3730,3735,3740,3745,3750,3754,3758,3762],{"type":22,"tag":176,"props":3716,"children":3717},{"style":247},[3718],{"type":27,"value":3719},"            if",{"type":22,"tag":176,"props":3721,"children":3722},{"style":253},[3723],{"type":27,"value":3724}," batch_idx ",{"type":22,"tag":176,"props":3726,"children":3727},{"style":247},[3728],{"type":27,"value":3729},"%",{"type":22,"tag":176,"props":3731,"children":3732},{"style":749},[3733],{"type":27,"value":3734}," 100000",{"type":22,"tag":176,"props":3736,"children":3737},{"style":247},[3738],{"type":27,"value":3739}," ==",{"type":22,"tag":176,"props":3741,"children":3742},{"style":749},[3743],{"type":27,"value":3744}," 0",{"type":22,"tag":176,"props":3746,"children":3747},{"style":247},[3748],{"type":27,"value":3749}," and",{"type":22,"tag":176,"props":3751,"children":3752},{"style":253},[3753],{"type":27,"value":3724},{"type":22,"tag":176,"props":3755,"children":3756},{"style":247},[3757],{"type":27,"value":1148},{"type":22,"tag":176,"props":3759,"children":3760},{"style":749},[3761],{"type":27,"value":3744},{"type":22,"tag":176,"props":3763,"children":3764},{"style":253},[3765],{"type":27,"value":935},{"type":22,"tag":176,"props":3767,"children":3769},{"class":178,"line":3768},194,[3770,3775,3779,3784,3789,3794,3799,3803,3808,3813,3817,3822,3827,3832,3836,3841,3845,3850,3854,3859,3864,3869,3873,3878],{"type":22,"tag":176,"props":3771,"children":3772},{"style":749},[3773],{"type":27,"value":3774},"                print",{"type":22,"tag":176,"props":3776,"children":3777},{"style":253},[3778],{"type":27,"value":2139},{"type":22,"tag":176,"props":3780,"children":3781},{"style":247},[3782],{"type":27,"value":3783},"f",{"type":22,"tag":176,"props":3785,"children":3786},{"style":189},[3787],{"type":27,"value":3788},"\"Epoch ",{"type":22,"tag":176,"props":3790,"children":3791},{"style":749},[3792],{"type":27,"value":3793},"{",{"type":22,"tag":176,"props":3795,"children":3796},{"style":253},[3797],{"type":27,"value":3798},"epoch",{"type":22,"tag":176,"props":3800,"children":3801},{"style":247},[3802],{"type":27,"value":2641},{"type":22,"tag":176,"props":3804,"children":3805},{"style":749},[3806],{"type":27,"value":3807},"1}",{"type":22,"tag":176,"props":3809,"children":3810},{"style":189},[3811],{"type":27,"value":3812}," | Batch ",{"type":22,"tag":176,"props":3814,"children":3815},{"style":749},[3816],{"type":27,"value":3793},{"type":22,"tag":176,"props":3818,"children":3819},{"style":253},[3820],{"type":27,"value":3821},"batch_idx",{"type":22,"tag":176,"props":3823,"children":3824},{"style":749},[3825],{"type":27,"value":3826},"}",{"type":22,"tag":176,"props":3828,"children":3829},{"style":189},[3830],{"type":27,"value":3831}," | Average Loss: ",{"type":22,"tag":176,"props":3833,"children":3834},{"style":749},[3835],{"type":27,"value":3793},{"type":22,"tag":176,"props":3837,"children":3838},{"style":253},[3839],{"type":27,"value":3840},"total_loss ",{"type":22,"tag":176,"props":3842,"children":3843},{"style":247},[3844],{"type":27,"value":3007},{"type":22,"tag":176,"props":3846,"children":3847},{"style":253},[3848],{"type":27,"value":3849}," (batch_idx ",{"type":22,"tag":176,"props":3851,"children":3852},{"style":247},[3853],{"type":27,"value":2641},{"type":22,"tag":176,"props":3855,"children":3856},{"style":749},[3857],{"type":27,"value":3858}," 1",{"type":22,"tag":176,"props":3860,"children":3861},{"style":253},[3862],{"type":27,"value":3863},")",{"type":22,"tag":176,"props":3865,"children":3866},{"style":247},[3867],{"type":27,"value":3868},":.4f",{"type":22,"tag":176,"props":3870,"children":3871},{"style":749},[3872],{"type":27,"value":3826},{"type":22,"tag":176,"props":3874,"children":3875},{"style":189},[3876],{"type":27,"value":3877},"\"",{"type":22,"tag":176,"props":3879,"children":3880},{"style":253},[3881],{"type":27,"value":466},{"type":22,"tag":176,"props":3883,"children":3885},{"class":178,"line":3884},195,[3886],{"type":22,"tag":176,"props":3887,"children":3888},{"emptyLinePlaceholder":5},[3889],{"type":27,"value":390},{"type":22,"tag":176,"props":3891,"children":3893},{"class":178,"line":3892},196,[3894,3899,3903,3907,3911,3915,3919,3923,3927,3932,3936,3940,3944,3948,3953,3957,3961,3965],{"type":22,"tag":176,"props":3895,"children":3896},{"style":749},[3897],{"type":27,"value":3898},"        print",{"type":22,"tag":176,"props":3900,"children":3901},{"style":253},[3902],{"type":27,"value":2139},{"type":22,"tag":176,"props":3904,"children":3905},{"style":247},[3906],{"type":27,"value":3783},{"type":22,"tag":176,"props":3908,"children":3909},{"style":189},[3910],{"type":27,"value":3788},{"type":22,"tag":176,"props":3912,"children":3913},{"style":749},[3914],{"type":27,"value":3793},{"type":22,"tag":176,"props":3916,"children":3917},{"style":253},[3918],{"type":27,"value":3798},{"type":22,"tag":176,"props":3920,"children":3921},{"style":247},[3922],{"type":27,"value":2641},{"type":22,"tag":176,"props":3924,"children":3925},{"style":749},[3926],{"type":27,"value":3807},{"type":22,"tag":176,"props":3928,"children":3929},{"style":189},[3930],{"type":27,"value":3931}," Complete | Average Loss: ",{"type":22,"tag":176,"props":3933,"children":3934},{"style":749},[3935],{"type":27,"value":3793},{"type":22,"tag":176,"props":3937,"children":3938},{"style":253},[3939],{"type":27,"value":3840},{"type":22,"tag":176,"props":3941,"children":3942},{"style":247},[3943],{"type":27,"value":3007},{"type":22,"tag":176,"props":3945,"children":3946},{"style":749},[3947],{"type":27,"value":1138},{"type":22,"tag":176,"props":3949,"children":3950},{"style":253},[3951],{"type":27,"value":3952},"(train_loader)",{"type":22,"tag":176,"props":3954,"children":3955},{"style":247},[3956],{"type":27,"value":3868},{"type":22,"tag":176,"props":3958,"children":3959},{"style":749},[3960],{"type":27,"value":3826},{"type":22,"tag":176,"props":3962,"children":3963},{"style":189},[3964],{"type":27,"value":3877},{"type":22,"tag":176,"props":3966,"children":3967},{"style":253},[3968],{"type":27,"value":466},{"type":22,"tag":176,"props":3970,"children":3972},{"class":178,"line":3971},197,[3973,3978,3982,3987],{"type":22,"tag":176,"props":3974,"children":3975},{"style":749},[3976],{"type":27,"value":3977},"    print",{"type":22,"tag":176,"props":3979,"children":3980},{"style":253},[3981],{"type":27,"value":2139},{"type":22,"tag":176,"props":3983,"children":3984},{"style":189},[3985],{"type":27,"value":3986},"\"Training complete!\"",{"type":22,"tag":176,"props":3988,"children":3989},{"style":253},[3990],{"type":27,"value":466},{"type":22,"tag":176,"props":3992,"children":3994},{"class":178,"line":3993},198,[3995,3999],{"type":22,"tag":176,"props":3996,"children":3997},{"style":247},[3998],{"type":27,"value":962},{"type":22,"tag":176,"props":4000,"children":4001},{"style":253},[4002],{"type":27,"value":4003}," student_model\n",{"type":22,"tag":176,"props":4005,"children":4007},{"class":178,"line":4006},199,[4008],{"type":22,"tag":176,"props":4009,"children":4010},{"emptyLinePlaceholder":5},[4011],{"type":27,"value":390},{"type":22,"tag":176,"props":4013,"children":4015},{"class":178,"line":4014},200,[4016],{"type":22,"tag":176,"props":4017,"children":4018},{"style":397},[4019],{"type":27,"value":400},{"type":22,"tag":176,"props":4021,"children":4023},{"class":178,"line":4022},201,[4024],{"type":22,"tag":176,"props":4025,"children":4026},{"style":397},[4027],{"type":27,"value":4028},"# 12. Model evaluation\n",{"type":22,"tag":176,"props":4030,"children":4032},{"class":178,"line":4031},202,[4033],{"type":22,"tag":176,"props":4034,"children":4035},{"style":397},[4036],{"type":27,"value":400},{"type":22,"tag":176,"props":4038,"children":4040},{"class":178,"line":4039},203,[4041,4045,4050,4055,4059,4063],{"type":22,"tag":176,"props":4042,"children":4043},{"style":247},[4044],{"type":27,"value":906},{"type":22,"tag":176,"props":4046,"children":4047},{"style":183},[4048],{"type":27,"value":4049}," evaluate_model",{"type":22,"tag":176,"props":4051,"children":4052},{"style":253},[4053],{"type":27,"value":4054},"(model, test_loader, num_samples",{"type":22,"tag":176,"props":4056,"children":4057},{"style":247},[4058],{"type":27,"value":431},{"type":22,"tag":176,"props":4060,"children":4061},{"style":749},[4062],{"type":27,"value":3214},{"type":22,"tag":176,"props":4064,"children":4065},{"style":253},[4066],{"type":27,"value":2158},{"type":22,"tag":176,"props":4068,"children":4070},{"class":178,"line":4069},204,[4071],{"type":22,"tag":176,"props":4072,"children":4073},{"style":253},[4074],{"type":27,"value":4075},"    model.eval()\n",{"type":22,"tag":176,"props":4077,"children":4079},{"class":178,"line":4078},205,[4080,4085,4089],{"type":22,"tag":176,"props":4081,"children":4082},{"style":253},[4083],{"type":27,"value":4084},"    results ",{"type":22,"tag":176,"props":4086,"children":4087},{"style":247},[4088],{"type":27,"value":431},{"type":22,"tag":176,"props":4090,"children":4091},{"style":253},[4092],{"type":27,"value":1036},{"type":22,"tag":176,"props":4094,"children":4096},{"class":178,"line":4095},206,[4097,4102],{"type":22,"tag":176,"props":4098,"children":4099},{"style":247},[4100],{"type":27,"value":4101},"    with",{"type":22,"tag":176,"props":4103,"children":4104},{"style":253},[4105],{"type":27,"value":2352},{"type":22,"tag":176,"props":4107,"children":4109},{"class":178,"line":4108},207,[4110,4114,4119,4123,4127],{"type":22,"tag":176,"props":4111,"children":4112},{"style":247},[4113],{"type":27,"value":3392},{"type":22,"tag":176,"props":4115,"children":4116},{"style":253},[4117],{"type":27,"value":4118}," i, batch ",{"type":22,"tag":176,"props":4120,"children":4121},{"style":247},[4122],{"type":27,"value":1055},{"type":22,"tag":176,"props":4124,"children":4125},{"style":749},[4126],{"type":27,"value":3406},{"type":22,"tag":176,"props":4128,"children":4129},{"style":253},[4130],{"type":27,"value":4131},"(test_loader):\n",{"type":22,"tag":176,"props":4133,"children":4135},{"class":178,"line":4134},208,[4136,4140,4145,4150],{"type":22,"tag":176,"props":4137,"children":4138},{"style":247},[4139],{"type":27,"value":3719},{"type":22,"tag":176,"props":4141,"children":4142},{"style":253},[4143],{"type":27,"value":4144}," i ",{"type":22,"tag":176,"props":4146,"children":4147},{"style":247},[4148],{"type":27,"value":4149},">=",{"type":22,"tag":176,"props":4151,"children":4152},{"style":253},[4153],{"type":27,"value":4154}," num_samples:\n",{"type":22,"tag":176,"props":4156,"children":4158},{"class":178,"line":4157},209,[4159],{"type":22,"tag":176,"props":4160,"children":4161},{"style":247},[4162],{"type":27,"value":4163},"                break\n",{"type":22,"tag":176,"props":4165,"children":4167},{"class":178,"line":4166},210,[4168,4172,4176,4180,4184],{"type":22,"tag":176,"props":4169,"children":4170},{"style":253},[4171],{"type":27,"value":3420},{"type":22,"tag":176,"props":4173,"children":4174},{"style":247},[4175],{"type":27,"value":431},{"type":22,"tag":176,"props":4177,"children":4178},{"style":253},[4179],{"type":27,"value":3429},{"type":22,"tag":176,"props":4181,"children":4182},{"style":189},[4183],{"type":27,"value":1750},{"type":22,"tag":176,"props":4185,"children":4186},{"style":253},[4187],{"type":27,"value":3438},{"type":22,"tag":176,"props":4189,"children":4191},{"class":178,"line":4190},211,[4192,4196,4200,4204,4208],{"type":22,"tag":176,"props":4193,"children":4194},{"style":253},[4195],{"type":27,"value":3447},{"type":22,"tag":176,"props":4197,"children":4198},{"style":247},[4199],{"type":27,"value":431},{"type":22,"tag":176,"props":4201,"children":4202},{"style":253},[4203],{"type":27,"value":3429},{"type":22,"tag":176,"props":4205,"children":4206},{"style":189},[4207],{"type":27,"value":1808},{"type":22,"tag":176,"props":4209,"children":4210},{"style":253},[4211],{"type":27,"value":3438},{"type":22,"tag":176,"props":4213,"children":4215},{"class":178,"line":4214},212,[4216,4221,4225],{"type":22,"tag":176,"props":4217,"children":4218},{"style":253},[4219],{"type":27,"value":4220},"            output ",{"type":22,"tag":176,"props":4222,"children":4223},{"style":247},[4224],{"type":27,"value":431},{"type":22,"tag":176,"props":4226,"children":4227},{"style":253},[4228],{"type":27,"value":4229}," model.generate(\n",{"type":22,"tag":176,"props":4231,"children":4233},{"class":178,"line":4232},213,[4234],{"type":22,"tag":176,"props":4235,"children":4236},{"style":253},[4237],{"type":27,"value":4238},"                inputs,\n",{"type":22,"tag":176,"props":4240,"children":4242},{"class":178,"line":4241},214,[4243,4248,4252],{"type":22,"tag":176,"props":4244,"children":4245},{"style":602},[4246],{"type":27,"value":4247},"                attention_mask",{"type":22,"tag":176,"props":4249,"children":4250},{"style":247},[4251],{"type":27,"value":431},{"type":22,"tag":176,"props":4253,"children":4254},{"style":253},[4255],{"type":27,"value":4256},"attention_mask,\n",{"type":22,"tag":176,"props":4258,"children":4260},{"class":178,"line":4259},215,[4261,4266,4270,4275],{"type":22,"tag":176,"props":4262,"children":4263},{"style":602},[4264],{"type":27,"value":4265},"                max_new_tokens",{"type":22,"tag":176,"props":4267,"children":4268},{"style":247},[4269],{"type":27,"value":431},{"type":22,"tag":176,"props":4271,"children":4272},{"style":749},[4273],{"type":27,"value":4274},"50",{"type":22,"tag":176,"props":4276,"children":4277},{"style":253},[4278],{"type":27,"value":619},{"type":22,"tag":176,"props":4280,"children":4282},{"class":178,"line":4281},216,[4283,4288,4292],{"type":22,"tag":176,"props":4284,"children":4285},{"style":602},[4286],{"type":27,"value":4287},"                pad_token_id",{"type":22,"tag":176,"props":4289,"children":4290},{"style":247},[4291],{"type":27,"value":431},{"type":22,"tag":176,"props":4293,"children":4294},{"style":253},[4295],{"type":27,"value":4296},"tokenizer.eos_token_id,\n",{"type":22,"tag":176,"props":4298,"children":4300},{"class":178,"line":4299},217,[4301,4306,4310,4314],{"type":22,"tag":176,"props":4302,"children":4303},{"style":602},[4304],{"type":27,"value":4305},"                do_sample",{"type":22,"tag":176,"props":4307,"children":4308},{"style":247},[4309],{"type":27,"value":431},{"type":22,"tag":176,"props":4311,"children":4312},{"style":749},[4313],{"type":27,"value":1290},{"type":22,"tag":176,"props":4315,"children":4316},{"style":253},[4317],{"type":27,"value":619},{"type":22,"tag":176,"props":4319,"children":4321},{"class":178,"line":4320},218,[4322,4327,4331,4335],{"type":22,"tag":176,"props":4323,"children":4324},{"style":602},[4325],{"type":27,"value":4326},"                temperature",{"type":22,"tag":176,"props":4328,"children":4329},{"style":247},[4330],{"type":27,"value":431},{"type":22,"tag":176,"props":4332,"children":4333},{"style":749},[4334],{"type":27,"value":2789},{"type":22,"tag":176,"props":4336,"children":4337},{"style":253},[4338],{"type":27,"value":619},{"type":22,"tag":176,"props":4340,"children":4342},{"class":178,"line":4341},219,[4343,4348,4352,4356],{"type":22,"tag":176,"props":4344,"children":4345},{"style":602},[4346],{"type":27,"value":4347},"                top_k",{"type":22,"tag":176,"props":4349,"children":4350},{"style":247},[4351],{"type":27,"value":431},{"type":22,"tag":176,"props":4353,"children":4354},{"style":749},[4355],{"type":27,"value":4274},{"type":22,"tag":176,"props":4357,"children":4358},{"style":253},[4359],{"type":27,"value":619},{"type":22,"tag":176,"props":4361,"children":4363},{"class":178,"line":4362},220,[4364,4369,4373],{"type":22,"tag":176,"props":4365,"children":4366},{"style":602},[4367],{"type":27,"value":4368},"                top_p",{"type":22,"tag":176,"props":4370,"children":4371},{"style":247},[4372],{"type":27,"value":431},{"type":22,"tag":176,"props":4374,"children":4375},{"style":749},[4376],{"type":27,"value":4377},"0.9\n",{"type":22,"tag":176,"props":4379,"children":4381},{"class":178,"line":4380},221,[4382],{"type":22,"tag":176,"props":4383,"children":4384},{"style":253},[4385],{"type":27,"value":4386},"            )\n",{"type":22,"tag":176,"props":4388,"children":4390},{"class":178,"line":4389},222,[4391,4396,4400,4405,4410,4415,4420,4424,4428],{"type":22,"tag":176,"props":4392,"children":4393},{"style":253},[4394],{"type":27,"value":4395},"            decoded ",{"type":22,"tag":176,"props":4397,"children":4398},{"style":247},[4399],{"type":27,"value":431},{"type":22,"tag":176,"props":4401,"children":4402},{"style":253},[4403],{"type":27,"value":4404}," tokenizer.decode(output[",{"type":22,"tag":176,"props":4406,"children":4407},{"style":749},[4408],{"type":27,"value":4409},"0",{"type":22,"tag":176,"props":4411,"children":4412},{"style":253},[4413],{"type":27,"value":4414},"], ",{"type":22,"tag":176,"props":4416,"children":4417},{"style":602},[4418],{"type":27,"value":4419},"skip_special_tokens",{"type":22,"tag":176,"props":4421,"children":4422},{"style":247},[4423],{"type":27,"value":431},{"type":22,"tag":176,"props":4425,"children":4426},{"style":749},[4427],{"type":27,"value":1290},{"type":22,"tag":176,"props":4429,"children":4430},{"style":253},[4431],{"type":27,"value":466},{"type":22,"tag":176,"props":4433,"children":4435},{"class":178,"line":4434},223,[4436],{"type":22,"tag":176,"props":4437,"children":4438},{"style":253},[4439],{"type":27,"value":4440},"            results.append(decoded)\n",{"type":22,"tag":176,"props":4442,"children":4444},{"class":178,"line":4443},224,[4445,4449],{"type":22,"tag":176,"props":4446,"children":4447},{"style":247},[4448],{"type":27,"value":962},{"type":22,"tag":176,"props":4450,"children":4451},{"style":253},[4452],{"type":27,"value":4453}," results\n",{"type":22,"tag":176,"props":4455,"children":4457},{"class":178,"line":4456},225,[4458],{"type":22,"tag":176,"props":4459,"children":4460},{"emptyLinePlaceholder":5},[4461],{"type":27,"value":390},{"type":22,"tag":176,"props":4463,"children":4465},{"class":178,"line":4464},226,[4466],{"type":22,"tag":176,"props":4467,"children":4468},{"style":397},[4469],{"type":27,"value":400},{"type":22,"tag":176,"props":4471,"children":4473},{"class":178,"line":4472},227,[4474],{"type":22,"tag":176,"props":4475,"children":4476},{"style":397},[4477],{"type":27,"value":4478},"# 13. Run the training\n",{"type":22,"tag":176,"props":4480,"children":4482},{"class":178,"line":4481},228,[4483],{"type":22,"tag":176,"props":4484,"children":4485},{"style":397},[4486],{"type":27,"value":400},{"type":22,"tag":176,"props":4488,"children":4490},{"class":178,"line":4489},229,[4491,4496,4500],{"type":22,"tag":176,"props":4492,"children":4493},{"style":253},[4494],{"type":27,"value":4495},"output_model_dir ",{"type":22,"tag":176,"props":4497,"children":4498},{"style":247},[4499],{"type":27,"value":431},{"type":22,"tag":176,"props":4501,"children":4502},{"style":189},[4503],{"type":27,"value":4504}," \"distilled_model_output_OpenWeb\"\n",{"type":22,"tag":176,"props":4506,"children":4508},{"class":178,"line":4507},230,[4509,4514,4518],{"type":22,"tag":176,"props":4510,"children":4511},{"style":253},[4512],{"type":27,"value":4513},"trained_model ",{"type":22,"tag":176,"props":4515,"children":4516},{"style":247},[4517],{"type":27,"value":431},{"type":22,"tag":176,"props":4519,"children":4520},{"style":253},[4521],{"type":27,"value":4522}," train_student(\n",{"type":22,"tag":176,"props":4524,"children":4526},{"class":178,"line":4525},231,[4527],{"type":22,"tag":176,"props":4528,"children":4529},{"style":253},[4530],{"type":27,"value":4531},"    student_model,\n",{"type":22,"tag":176,"props":4533,"children":4535},{"class":178,"line":4534},232,[4536],{"type":22,"tag":176,"props":4537,"children":4538},{"style":253},[4539],{"type":27,"value":4540},"    teacher_model,\n",{"type":22,"tag":176,"props":4542,"children":4544},{"class":178,"line":4543},233,[4545],{"type":22,"tag":176,"props":4546,"children":4547},{"style":253},[4548],{"type":27,"value":4549},"    train_loader,\n",{"type":22,"tag":176,"props":4551,"children":4553},{"class":178,"line":4552},234,[4554,4559,4563,4568,4573],{"type":22,"tag":176,"props":4555,"children":4556},{"style":602},[4557],{"type":27,"value":4558},"    epochs",{"type":22,"tag":176,"props":4560,"children":4561},{"style":247},[4562],{"type":27,"value":431},{"type":22,"tag":176,"props":4564,"children":4565},{"style":749},[4566],{"type":27,"value":4567},"2",{"type":22,"tag":176,"props":4569,"children":4570},{"style":253},[4571],{"type":27,"value":4572},",  ",{"type":22,"tag":176,"props":4574,"children":4575},{"style":397},[4576],{"type":27,"value":4577},"# Adjust epochs as needed\n",{"type":22,"tag":176,"props":4579,"children":4581},{"class":178,"line":4580},235,[4582,4587,4591,4595],{"type":22,"tag":176,"props":4583,"children":4584},{"style":602},[4585],{"type":27,"value":4586},"    lr",{"type":22,"tag":176,"props":4588,"children":4589},{"style":247},[4590],{"type":27,"value":431},{"type":22,"tag":176,"props":4592,"children":4593},{"style":749},[4594],{"type":27,"value":3228},{"type":22,"tag":176,"props":4596,"children":4597},{"style":253},[4598],{"type":27,"value":619},{"type":22,"tag":176,"props":4600,"children":4602},{"class":178,"line":4601},236,[4603,4608,4612],{"type":22,"tag":176,"props":4604,"children":4605},{"style":602},[4606],{"type":27,"value":4607},"    output_dir",{"type":22,"tag":176,"props":4609,"children":4610},{"style":247},[4611],{"type":27,"value":431},{"type":22,"tag":176,"props":4613,"children":4614},{"style":253},[4615],{"type":27,"value":4616},"output_model_dir\n",{"type":22,"tag":176,"props":4618,"children":4620},{"class":178,"line":4619},237,[4621],{"type":22,"tag":176,"props":4622,"children":4623},{"style":253},[4624],{"type":27,"value":466},{"type":22,"tag":176,"props":4626,"children":4628},{"class":178,"line":4627},238,[4629],{"type":22,"tag":176,"props":4630,"children":4631},{"emptyLinePlaceholder":5},[4632],{"type":27,"value":390},{"type":22,"tag":176,"props":4634,"children":4636},{"class":178,"line":4635},239,[4637],{"type":22,"tag":176,"props":4638,"children":4639},{"style":397},[4640],{"type":27,"value":400},{"type":22,"tag":176,"props":4642,"children":4644},{"class":178,"line":4643},240,[4645],{"type":22,"tag":176,"props":4646,"children":4647},{"style":397},[4648],{"type":27,"value":4649},"# 14. Save the final model\n",{"type":22,"tag":176,"props":4651,"children":4653},{"class":178,"line":4652},241,[4654],{"type":22,"tag":176,"props":4655,"children":4656},{"style":397},[4657],{"type":27,"value":400},{"type":22,"tag":176,"props":4659,"children":4661},{"class":178,"line":4660},242,[4662,4667,4672],{"type":22,"tag":176,"props":4663,"children":4664},{"style":253},[4665],{"type":27,"value":4666},"torch.save(trained_model.state_dict(), os.path.join(output_model_dir, ",{"type":22,"tag":176,"props":4668,"children":4669},{"style":189},[4670],{"type":27,"value":4671},"\"final_distilled_model.pt\"",{"type":22,"tag":176,"props":4673,"children":4674},{"style":253},[4675],{"type":27,"value":4676},"))\n",{"type":22,"tag":176,"props":4678,"children":4680},{"class":178,"line":4679},243,[4681],{"type":22,"tag":176,"props":4682,"children":4683},{"emptyLinePlaceholder":5},[4684],{"type":27,"value":390},{"type":22,"tag":176,"props":4686,"children":4688},{"class":178,"line":4687},244,[4689],{"type":22,"tag":176,"props":4690,"children":4691},{"style":397},[4692],{"type":27,"value":400},{"type":22,"tag":176,"props":4694,"children":4696},{"class":178,"line":4695},245,[4697],{"type":22,"tag":176,"props":4698,"children":4699},{"style":397},[4700],{"type":27,"value":4701},"# 15. Comparison Evaluation\n",{"type":22,"tag":176,"props":4703,"children":4705},{"class":178,"line":4704},246,[4706],{"type":22,"tag":176,"props":4707,"children":4708},{"style":397},[4709],{"type":27,"value":400},{"type":22,"tag":176,"props":4711,"children":4713},{"class":178,"line":4712},247,[4714,4719,4723,4727,4732,4737],{"type":22,"tag":176,"props":4715,"children":4716},{"style":749},[4717],{"type":27,"value":4718},"print",{"type":22,"tag":176,"props":4720,"children":4721},{"style":253},[4722],{"type":27,"value":2139},{"type":22,"tag":176,"props":4724,"children":4725},{"style":189},[4726],{"type":27,"value":3877},{"type":22,"tag":176,"props":4728,"children":4729},{"style":749},[4730],{"type":27,"value":4731},"\\n",{"type":22,"tag":176,"props":4733,"children":4734},{"style":189},[4735],{"type":27,"value":4736},"Teacher Model Generation Samples:\"",{"type":22,"tag":176,"props":4738,"children":4739},{"style":253},[4740],{"type":27,"value":466},{"type":22,"tag":176,"props":4742,"children":4744},{"class":178,"line":4743},248,[4745,4750,4754],{"type":22,"tag":176,"props":4746,"children":4747},{"style":253},[4748],{"type":27,"value":4749},"teacher_results ",{"type":22,"tag":176,"props":4751,"children":4752},{"style":247},[4753],{"type":27,"value":431},{"type":22,"tag":176,"props":4755,"children":4756},{"style":253},[4757],{"type":27,"value":4758}," evaluate_model(teacher_model, test_loader)\n",{"type":22,"tag":176,"props":4760,"children":4762},{"class":178,"line":4761},249,[4763],{"type":22,"tag":176,"props":4764,"children":4765},{"emptyLinePlaceholder":5},[4766],{"type":27,"value":390},{"type":22,"tag":176,"props":4768,"children":4770},{"class":178,"line":4769},250,[4771,4775,4779,4783,4787,4792],{"type":22,"tag":176,"props":4772,"children":4773},{"style":749},[4774],{"type":27,"value":4718},{"type":22,"tag":176,"props":4776,"children":4777},{"style":253},[4778],{"type":27,"value":2139},{"type":22,"tag":176,"props":4780,"children":4781},{"style":189},[4782],{"type":27,"value":3877},{"type":22,"tag":176,"props":4784,"children":4785},{"style":749},[4786],{"type":27,"value":4731},{"type":22,"tag":176,"props":4788,"children":4789},{"style":189},[4790],{"type":27,"value":4791},"Student Model Generation Samples:\"",{"type":22,"tag":176,"props":4793,"children":4794},{"style":253},[4795],{"type":27,"value":466},{"type":22,"tag":176,"props":4797,"children":4799},{"class":178,"line":4798},251,[4800,4805,4809],{"type":22,"tag":176,"props":4801,"children":4802},{"style":253},[4803],{"type":27,"value":4804},"student_results ",{"type":22,"tag":176,"props":4806,"children":4807},{"style":247},[4808],{"type":27,"value":431},{"type":22,"tag":176,"props":4810,"children":4811},{"style":253},[4812],{"type":27,"value":4813}," evaluate_model(trained_model, test_loader)\n",{"type":22,"tag":176,"props":4815,"children":4817},{"class":178,"line":4816},252,[4818],{"type":22,"tag":176,"props":4819,"children":4820},{"emptyLinePlaceholder":5},[4821],{"type":27,"value":390},{"type":22,"tag":176,"props":4823,"children":4825},{"class":178,"line":4824},253,[4826],{"type":22,"tag":176,"props":4827,"children":4828},{"style":397},[4829],{"type":27,"value":400},{"type":22,"tag":176,"props":4831,"children":4833},{"class":178,"line":4832},254,[4834],{"type":22,"tag":176,"props":4835,"children":4836},{"style":397},[4837],{"type":27,"value":4838},"# 16. Save comparison results\n",{"type":22,"tag":176,"props":4840,"children":4842},{"class":178,"line":4841},255,[4843],{"type":22,"tag":176,"props":4844,"children":4845},{"style":397},[4846],{"type":27,"value":400},{"type":22,"tag":176,"props":4848,"children":4850},{"class":178,"line":4849},256,[4851,4856,4860,4865,4870],{"type":22,"tag":176,"props":4852,"children":4853},{"style":253},[4854],{"type":27,"value":4855},"comparison_file_path ",{"type":22,"tag":176,"props":4857,"children":4858},{"style":247},[4859],{"type":27,"value":431},{"type":22,"tag":176,"props":4861,"children":4862},{"style":253},[4863],{"type":27,"value":4864}," os.path.join(output_model_dir, ",{"type":22,"tag":176,"props":4866,"children":4867},{"style":189},[4868],{"type":27,"value":4869},"\"generation_comparison.txt\"",{"type":22,"tag":176,"props":4871,"children":4872},{"style":253},[4873],{"type":27,"value":466},{"type":22,"tag":176,"props":4875,"children":4877},{"class":178,"line":4876},257,[4878,4883,4888,4893,4898,4902,4907,4911,4916,4921,4925],{"type":22,"tag":176,"props":4879,"children":4880},{"style":247},[4881],{"type":27,"value":4882},"with",{"type":22,"tag":176,"props":4884,"children":4885},{"style":749},[4886],{"type":27,"value":4887}," open",{"type":22,"tag":176,"props":4889,"children":4890},{"style":253},[4891],{"type":27,"value":4892},"(comparison_file_path, ",{"type":22,"tag":176,"props":4894,"children":4895},{"style":189},[4896],{"type":27,"value":4897},"\"w\"",{"type":22,"tag":176,"props":4899,"children":4900},{"style":253},[4901],{"type":27,"value":2487},{"type":22,"tag":176,"props":4903,"children":4904},{"style":602},[4905],{"type":27,"value":4906},"encoding",{"type":22,"tag":176,"props":4908,"children":4909},{"style":247},[4910],{"type":27,"value":431},{"type":22,"tag":176,"props":4912,"children":4913},{"style":189},[4914],{"type":27,"value":4915},"\"utf-8\"",{"type":22,"tag":176,"props":4917,"children":4918},{"style":253},[4919],{"type":27,"value":4920},") ",{"type":22,"tag":176,"props":4922,"children":4923},{"style":247},[4924],{"type":27,"value":287},{"type":22,"tag":176,"props":4926,"children":4927},{"style":253},[4928],{"type":27,"value":4929}," f:\n",{"type":22,"tag":176,"props":4931,"children":4933},{"class":178,"line":4932},258,[4934,4939,4944,4948,4952],{"type":22,"tag":176,"props":4935,"children":4936},{"style":253},[4937],{"type":27,"value":4938},"    f.write(",{"type":22,"tag":176,"props":4940,"children":4941},{"style":189},[4942],{"type":27,"value":4943},"\"=== Teacher Model Generation ===",{"type":22,"tag":176,"props":4945,"children":4946},{"style":749},[4947],{"type":27,"value":4731},{"type":22,"tag":176,"props":4949,"children":4950},{"style":189},[4951],{"type":27,"value":3877},{"type":22,"tag":176,"props":4953,"children":4954},{"style":253},[4955],{"type":27,"value":466},{"type":22,"tag":176,"props":4957,"children":4959},{"class":178,"line":4958},259,[4960,4964,4968,4972,4976],{"type":22,"tag":176,"props":4961,"children":4962},{"style":253},[4963],{"type":27,"value":4938},{"type":22,"tag":176,"props":4965,"children":4966},{"style":189},[4967],{"type":27,"value":3877},{"type":22,"tag":176,"props":4969,"children":4970},{"style":749},[4971],{"type":27,"value":4731},{"type":22,"tag":176,"props":4973,"children":4974},{"style":189},[4975],{"type":27,"value":3877},{"type":22,"tag":176,"props":4977,"children":4978},{"style":253},[4979],{"type":27,"value":4980},".join(teacher_results))\n",{"type":22,"tag":176,"props":4982,"children":4984},{"class":178,"line":4983},260,[4985,4989,4993,4998,5003,5007,5011],{"type":22,"tag":176,"props":4986,"children":4987},{"style":253},[4988],{"type":27,"value":4938},{"type":22,"tag":176,"props":4990,"children":4991},{"style":189},[4992],{"type":27,"value":3877},{"type":22,"tag":176,"props":4994,"children":4995},{"style":749},[4996],{"type":27,"value":4997},"\\n\\n",{"type":22,"tag":176,"props":4999,"children":5000},{"style":189},[5001],{"type":27,"value":5002},"=== Student Model Generation ===",{"type":22,"tag":176,"props":5004,"children":5005},{"style":749},[5006],{"type":27,"value":4731},{"type":22,"tag":176,"props":5008,"children":5009},{"style":189},[5010],{"type":27,"value":3877},{"type":22,"tag":176,"props":5012,"children":5013},{"style":253},[5014],{"type":27,"value":466},{"type":22,"tag":176,"props":5016,"children":5018},{"class":178,"line":5017},261,[5019,5023,5027,5031,5035],{"type":22,"tag":176,"props":5020,"children":5021},{"style":253},[5022],{"type":27,"value":4938},{"type":22,"tag":176,"props":5024,"children":5025},{"style":189},[5026],{"type":27,"value":3877},{"type":22,"tag":176,"props":5028,"children":5029},{"style":749},[5030],{"type":27,"value":4731},{"type":22,"tag":176,"props":5032,"children":5033},{"style":189},[5034],{"type":27,"value":3877},{"type":22,"tag":176,"props":5036,"children":5037},{"style":253},[5038],{"type":27,"value":5039},".join(student_results))\n",{"type":22,"tag":176,"props":5041,"children":5043},{"class":178,"line":5042},262,[5044],{"type":22,"tag":176,"props":5045,"children":5046},{"emptyLinePlaceholder":5},[5047],{"type":27,"value":390},{"type":22,"tag":176,"props":5049,"children":5051},{"class":178,"line":5050},263,[5052,5056,5060,5064,5068,5072,5077,5081,5086,5090,5094],{"type":22,"tag":176,"props":5053,"children":5054},{"style":749},[5055],{"type":27,"value":4718},{"type":22,"tag":176,"props":5057,"children":5058},{"style":253},[5059],{"type":27,"value":2139},{"type":22,"tag":176,"props":5061,"children":5062},{"style":247},[5063],{"type":27,"value":3783},{"type":22,"tag":176,"props":5065,"children":5066},{"style":189},[5067],{"type":27,"value":3877},{"type":22,"tag":176,"props":5069,"children":5070},{"style":749},[5071],{"type":27,"value":4731},{"type":22,"tag":176,"props":5073,"children":5074},{"style":189},[5075],{"type":27,"value":5076},"Training and evaluation complete! Comparison saved to ",{"type":22,"tag":176,"props":5078,"children":5079},{"style":749},[5080],{"type":27,"value":3793},{"type":22,"tag":176,"props":5082,"children":5083},{"style":253},[5084],{"type":27,"value":5085},"comparison_file_path",{"type":22,"tag":176,"props":5087,"children":5088},{"style":749},[5089],{"type":27,"value":3826},{"type":22,"tag":176,"props":5091,"children":5092},{"style":189},[5093],{"type":27,"value":3877},{"type":22,"tag":176,"props":5095,"children":5096},{"style":253},[5097],{"type":27,"value":466},{"type":22,"tag":176,"props":5099,"children":5101},{"class":178,"line":5100},264,[5102,5106,5110,5114,5119,5123,5128,5132,5136],{"type":22,"tag":176,"props":5103,"children":5104},{"style":749},[5105],{"type":27,"value":4718},{"type":22,"tag":176,"props":5107,"children":5108},{"style":253},[5109],{"type":27,"value":2139},{"type":22,"tag":176,"props":5111,"children":5112},{"style":247},[5113],{"type":27,"value":3783},{"type":22,"tag":176,"props":5115,"children":5116},{"style":189},[5117],{"type":27,"value":5118},"\"Model files saved in ",{"type":22,"tag":176,"props":5120,"children":5121},{"style":749},[5122],{"type":27,"value":3793},{"type":22,"tag":176,"props":5124,"children":5125},{"style":253},[5126],{"type":27,"value":5127},"output_model_dir",{"type":22,"tag":176,"props":5129,"children":5130},{"style":749},[5131],{"type":27,"value":3826},{"type":22,"tag":176,"props":5133,"children":5134},{"style":189},[5135],{"type":27,"value":3877},{"type":22,"tag":176,"props":5137,"children":5138},{"style":253},[5139],{"type":27,"value":466},{"type":22,"tag":107,"props":5141,"children":5143},{"id":5142},"explanation-of-key-steps",[5144],{"type":27,"value":5145},"Explanation of Key Steps",{"type":22,"tag":5147,"props":5148,"children":5150},"h3",{"id":5149},"_1-device-setup",[5151],{"type":27,"value":5152},"1. Device Setup",{"type":22,"tag":23,"props":5154,"children":5155},{},[5156,5158,5164],{"type":27,"value":5157},"We detect whether a GPU is available using ",{"type":22,"tag":30,"props":5159,"children":5161},{"className":5160},[],[5162],{"type":27,"value":5163},"torch.cuda.is_available()",{"type":27,"value":5165},":",{"type":22,"tag":166,"props":5167,"children":5169},{"className":235,"code":5168,"language":237,"meta":13,"style":13},"device = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\n",[5170],{"type":22,"tag":30,"props":5171,"children":5172},{"__ignoreMap":13},[5173],{"type":22,"tag":176,"props":5174,"children":5175},{"class":178,"line":179},[5176,5180,5184,5188,5192,5196,5200,5204,5208],{"type":22,"tag":176,"props":5177,"children":5178},{"style":253},[5179],{"type":27,"value":426},{"type":22,"tag":176,"props":5181,"children":5182},{"style":247},[5183],{"type":27,"value":431},{"type":22,"tag":176,"props":5185,"children":5186},{"style":253},[5187],{"type":27,"value":436},{"type":22,"tag":176,"props":5189,"children":5190},{"style":189},[5191],{"type":27,"value":441},{"type":22,"tag":176,"props":5193,"children":5194},{"style":247},[5195],{"type":27,"value":446},{"type":22,"tag":176,"props":5197,"children":5198},{"style":253},[5199],{"type":27,"value":451},{"type":22,"tag":176,"props":5201,"children":5202},{"style":247},[5203],{"type":27,"value":456},{"type":22,"tag":176,"props":5205,"children":5206},{"style":189},[5207],{"type":27,"value":461},{"type":22,"tag":176,"props":5209,"children":5210},{"style":253},[5211],{"type":27,"value":466},{"type":22,"tag":23,"props":5213,"children":5214},{},[5215],{"type":27,"value":5216},"This ensures our model will train on GPU if available, otherwise on CPU.",{"type":22,"tag":5147,"props":5218,"children":5220},{"id":5219},"_2-choosing-stable-base-models",[5221],{"type":27,"value":5222},"2. Choosing Stable Base Models",{"type":22,"tag":23,"props":5224,"children":5225},{},[5226],{"type":27,"value":5227},"We define the teacher and student models:",{"type":22,"tag":166,"props":5229,"children":5231},{"className":235,"code":5230,"language":237,"meta":13,"style":13},"teacher_model_name = \"gpt2\"\nstudent_model_name = \"distilgpt2\"\n",[5232],{"type":22,"tag":30,"props":5233,"children":5234},{"__ignoreMap":13},[5235,5250],{"type":22,"tag":176,"props":5236,"children":5237},{"class":178,"line":179},[5238,5242,5246],{"type":22,"tag":176,"props":5239,"children":5240},{"style":253},[5241],{"type":27,"value":508},{"type":22,"tag":176,"props":5243,"children":5244},{"style":247},[5245],{"type":27,"value":431},{"type":22,"tag":176,"props":5247,"children":5248},{"style":189},[5249],{"type":27,"value":517},{"type":22,"tag":176,"props":5251,"children":5252},{"class":178,"line":259},[5253,5257,5261],{"type":22,"tag":176,"props":5254,"children":5255},{"style":253},[5256],{"type":27,"value":526},{"type":22,"tag":176,"props":5258,"children":5259},{"style":247},[5260],{"type":27,"value":431},{"type":22,"tag":176,"props":5262,"children":5263},{"style":189},[5264],{"type":27,"value":535},{"type":22,"tag":23,"props":5266,"children":5267},{},[5268],{"type":27,"value":5269},"Feel free to switch them to other models (like GPT-Neo or GPT-J) if you wish, as long as they match a causal language modeling architecture.",{"type":22,"tag":5147,"props":5271,"children":5273},{"id":5272},"_3-loading-models-in-fp32-adjusting-dropout",[5274],{"type":27,"value":5275},"3. Loading Models in FP32 & Adjusting Dropout",{"type":22,"tag":23,"props":5277,"children":5278},{},[5279],{"type":27,"value":5280},"We load both teacher and student in FP32 for more stable training. We also increase the dropout for the student model to reduce overfitting:",{"type":22,"tag":166,"props":5282,"children":5284},{"className":235,"code":5283,"language":237,"meta":13,"style":13},"teacher_model = AutoModelForCausalLM.from_pretrained(\n    teacher_model_name, \n    device_map=\"auto\", \n    torch_dtype=torch.float32\n).eval()\n\nstudent_model = AutoModelForCausalLM.from_pretrained(\n    student_model_name, \n    device_map=\"auto\", \n    torch_dtype=torch.float32\n)\n# Increase dropout\nstudent_model.config.attn_pdrop = 0.1\n...\n",[5285],{"type":22,"tag":30,"props":5286,"children":5287},{"__ignoreMap":13},[5288,5303,5311,5331,5346,5353,5360,5375,5383,5402,5417,5424,5432,5447],{"type":22,"tag":176,"props":5289,"children":5290},{"class":178,"line":179},[5291,5295,5299],{"type":22,"tag":176,"props":5292,"children":5293},{"style":253},[5294],{"type":27,"value":577},{"type":22,"tag":176,"props":5296,"children":5297},{"style":247},[5298],{"type":27,"value":431},{"type":22,"tag":176,"props":5300,"children":5301},{"style":253},[5302],{"type":27,"value":586},{"type":22,"tag":176,"props":5304,"children":5305},{"class":178,"line":259},[5306],{"type":22,"tag":176,"props":5307,"children":5308},{"style":253},[5309],{"type":27,"value":5310},"    teacher_model_name, \n",{"type":22,"tag":176,"props":5312,"children":5313},{"class":178,"line":272},[5314,5318,5322,5326],{"type":22,"tag":176,"props":5315,"children":5316},{"style":602},[5317],{"type":27,"value":605},{"type":22,"tag":176,"props":5319,"children":5320},{"style":247},[5321],{"type":27,"value":431},{"type":22,"tag":176,"props":5323,"children":5324},{"style":189},[5325],{"type":27,"value":614},{"type":22,"tag":176,"props":5327,"children":5328},{"style":253},[5329],{"type":27,"value":5330},", \n",{"type":22,"tag":176,"props":5332,"children":5333},{"class":178,"line":295},[5334,5338,5342],{"type":22,"tag":176,"props":5335,"children":5336},{"style":602},[5337],{"type":27,"value":628},{"type":22,"tag":176,"props":5339,"children":5340},{"style":247},[5341],{"type":27,"value":431},{"type":22,"tag":176,"props":5343,"children":5344},{"style":253},[5345],{"type":27,"value":637},{"type":22,"tag":176,"props":5347,"children":5348},{"class":178,"line":317},[5349],{"type":22,"tag":176,"props":5350,"children":5351},{"style":253},[5352],{"type":27,"value":646},{"type":22,"tag":176,"props":5354,"children":5355},{"class":178,"line":340},[5356],{"type":22,"tag":176,"props":5357,"children":5358},{"emptyLinePlaceholder":5},[5359],{"type":27,"value":390},{"type":22,"tag":176,"props":5361,"children":5362},{"class":178,"line":362},[5363,5367,5371],{"type":22,"tag":176,"props":5364,"children":5365},{"style":253},[5366],{"type":27,"value":663},{"type":22,"tag":176,"props":5368,"children":5369},{"style":247},[5370],{"type":27,"value":431},{"type":22,"tag":176,"props":5372,"children":5373},{"style":253},[5374],{"type":27,"value":586},{"type":22,"tag":176,"props":5376,"children":5377},{"class":178,"line":384},[5378],{"type":22,"tag":176,"props":5379,"children":5380},{"style":253},[5381],{"type":27,"value":5382},"    student_model_name, \n",{"type":22,"tag":176,"props":5384,"children":5385},{"class":178,"line":393},[5386,5390,5394,5398],{"type":22,"tag":176,"props":5387,"children":5388},{"style":602},[5389],{"type":27,"value":605},{"type":22,"tag":176,"props":5391,"children":5392},{"style":247},[5393],{"type":27,"value":431},{"type":22,"tag":176,"props":5395,"children":5396},{"style":189},[5397],{"type":27,"value":614},{"type":22,"tag":176,"props":5399,"children":5400},{"style":253},[5401],{"type":27,"value":5330},{"type":22,"tag":176,"props":5403,"children":5404},{"class":178,"line":403},[5405,5409,5413],{"type":22,"tag":176,"props":5406,"children":5407},{"style":602},[5408],{"type":27,"value":628},{"type":22,"tag":176,"props":5410,"children":5411},{"style":247},[5412],{"type":27,"value":431},{"type":22,"tag":176,"props":5414,"children":5415},{"style":253},[5416],{"type":27,"value":637},{"type":22,"tag":176,"props":5418,"children":5419},{"class":178,"line":412},[5420],{"type":22,"tag":176,"props":5421,"children":5422},{"style":253},[5423],{"type":27,"value":466},{"type":22,"tag":176,"props":5425,"children":5426},{"class":178,"line":420},[5427],{"type":22,"tag":176,"props":5428,"children":5429},{"style":397},[5430],{"type":27,"value":5431},"# Increase dropout\n",{"type":22,"tag":176,"props":5433,"children":5434},{"class":178,"line":469},[5435,5439,5443],{"type":22,"tag":176,"props":5436,"children":5437},{"style":253},[5438],{"type":27,"value":742},{"type":22,"tag":176,"props":5440,"children":5441},{"style":247},[5442],{"type":27,"value":431},{"type":22,"tag":176,"props":5444,"children":5445},{"style":749},[5446],{"type":27,"value":752},{"type":22,"tag":176,"props":5448,"children":5449},{"class":178,"line":477},[5450],{"type":22,"tag":176,"props":5451,"children":5452},{"style":749},[5453],{"type":27,"value":5454},"...\n",{"type":22,"tag":5147,"props":5456,"children":5458},{"id":5457},"_4-loading-the-tokenizer",[5459],{"type":27,"value":5460},"4. Loading the Tokenizer",{"type":22,"tag":23,"props":5462,"children":5463},{},[5464],{"type":27,"value":5465},"We use the same tokenizer as our teacher model for consistency:",{"type":22,"tag":166,"props":5467,"children":5469},{"className":235,"code":5468,"language":237,"meta":13,"style":13},"tokenizer = AutoTokenizer.from_pretrained(teacher_model_name)\ntokenizer.pad_token = tokenizer.eos_token\n",[5470],{"type":22,"tag":30,"props":5471,"children":5472},{"__ignoreMap":13},[5473,5488],{"type":22,"tag":176,"props":5474,"children":5475},{"class":178,"line":179},[5476,5480,5484],{"type":22,"tag":176,"props":5477,"children":5478},{"style":253},[5479],{"type":27,"value":837},{"type":22,"tag":176,"props":5481,"children":5482},{"style":247},[5483],{"type":27,"value":431},{"type":22,"tag":176,"props":5485,"children":5486},{"style":253},[5487],{"type":27,"value":846},{"type":22,"tag":176,"props":5489,"children":5490},{"class":178,"line":259},[5491,5495,5499],{"type":22,"tag":176,"props":5492,"children":5493},{"style":253},[5494],{"type":27,"value":855},{"type":22,"tag":176,"props":5496,"children":5497},{"style":247},[5498],{"type":27,"value":431},{"type":22,"tag":176,"props":5500,"children":5501},{"style":253},[5502],{"type":27,"value":864},{"type":22,"tag":23,"props":5504,"children":5505},{},[5506,5508,5514,5516,5522],{"type":27,"value":5507},"We set ",{"type":22,"tag":30,"props":5509,"children":5511},{"className":5510},[],[5512],{"type":27,"value":5513},"pad_token",{"type":27,"value":5515}," to ",{"type":22,"tag":30,"props":5517,"children":5519},{"className":5518},[],[5520],{"type":27,"value":5521},"eos_token",{"type":27,"value":5523}," to ensure all sequences are padded consistently.",{"type":22,"tag":5147,"props":5525,"children":5527},{"id":5526},"_5-data-augmentation",[5528],{"type":27,"value":5529},"5. Data Augmentation",{"type":22,"tag":23,"props":5531,"children":5532},{},[5533],{"type":27,"value":5534},"Here, you can optionally include text augmentation techniques (synonym replacements, random insertions, etc.). Currently, this function returns the original text.",{"type":22,"tag":5147,"props":5536,"children":5538},{"id":5537},"_6-improved-data-preprocessing",[5539],{"type":27,"value":5540},"6. Improved Data Preprocessing",{"type":22,"tag":23,"props":5542,"children":5543},{},[5544],{"type":27,"value":5545},"We perform minimal text cleaning and tokenization:",{"type":22,"tag":166,"props":5547,"children":5549},{"className":235,"code":5548,"language":237,"meta":13,"style":13},"def tokenize_function(examples):\n    ...\n    tokenized = tokenizer(\n        processed_texts, \n        truncation=True, \n        max_length=128, \n        padding=\"max_length\", \n        return_tensors=\"pt\"\n    )\n    ...\n",[5550],{"type":22,"tag":30,"props":5551,"children":5552},{"__ignoreMap":13},[5553,5568,5576,5591,5599,5618,5637,5656,5671,5678],{"type":22,"tag":176,"props":5554,"children":5555},{"class":178,"line":179},[5556,5560,5564],{"type":22,"tag":176,"props":5557,"children":5558},{"style":247},[5559],{"type":27,"value":906},{"type":22,"tag":176,"props":5561,"children":5562},{"style":183},[5563],{"type":27,"value":1013},{"type":22,"tag":176,"props":5565,"children":5566},{"style":253},[5567],{"type":27,"value":1018},{"type":22,"tag":176,"props":5569,"children":5570},{"class":178,"line":259},[5571],{"type":22,"tag":176,"props":5572,"children":5573},{"style":749},[5574],{"type":27,"value":5575},"    ...\n",{"type":22,"tag":176,"props":5577,"children":5578},{"class":178,"line":272},[5579,5583,5587],{"type":22,"tag":176,"props":5580,"children":5581},{"style":253},[5582],{"type":27,"value":1254},{"type":22,"tag":176,"props":5584,"children":5585},{"style":247},[5586],{"type":27,"value":431},{"type":22,"tag":176,"props":5588,"children":5589},{"style":253},[5590],{"type":27,"value":1263},{"type":22,"tag":176,"props":5592,"children":5593},{"class":178,"line":295},[5594],{"type":22,"tag":176,"props":5595,"children":5596},{"style":253},[5597],{"type":27,"value":5598},"        processed_texts, \n",{"type":22,"tag":176,"props":5600,"children":5601},{"class":178,"line":317},[5602,5606,5610,5614],{"type":22,"tag":176,"props":5603,"children":5604},{"style":602},[5605],{"type":27,"value":1281},{"type":22,"tag":176,"props":5607,"children":5608},{"style":247},[5609],{"type":27,"value":431},{"type":22,"tag":176,"props":5611,"children":5612},{"style":749},[5613],{"type":27,"value":1290},{"type":22,"tag":176,"props":5615,"children":5616},{"style":253},[5617],{"type":27,"value":5330},{"type":22,"tag":176,"props":5619,"children":5620},{"class":178,"line":340},[5621,5625,5629,5633],{"type":22,"tag":176,"props":5622,"children":5623},{"style":602},[5624],{"type":27,"value":1303},{"type":22,"tag":176,"props":5626,"children":5627},{"style":247},[5628],{"type":27,"value":431},{"type":22,"tag":176,"props":5630,"children":5631},{"style":749},[5632],{"type":27,"value":1312},{"type":22,"tag":176,"props":5634,"children":5635},{"style":253},[5636],{"type":27,"value":5330},{"type":22,"tag":176,"props":5638,"children":5639},{"class":178,"line":362},[5640,5644,5648,5652],{"type":22,"tag":176,"props":5641,"children":5642},{"style":602},[5643],{"type":27,"value":1325},{"type":22,"tag":176,"props":5645,"children":5646},{"style":247},[5647],{"type":27,"value":431},{"type":22,"tag":176,"props":5649,"children":5650},{"style":189},[5651],{"type":27,"value":1334},{"type":22,"tag":176,"props":5653,"children":5654},{"style":253},[5655],{"type":27,"value":5330},{"type":22,"tag":176,"props":5657,"children":5658},{"class":178,"line":384},[5659,5663,5667],{"type":22,"tag":176,"props":5660,"children":5661},{"style":602},[5662],{"type":27,"value":1347},{"type":22,"tag":176,"props":5664,"children":5665},{"style":247},[5666],{"type":27,"value":431},{"type":22,"tag":176,"props":5668,"children":5669},{"style":189},[5670],{"type":27,"value":1356},{"type":22,"tag":176,"props":5672,"children":5673},{"class":178,"line":393},[5674],{"type":22,"tag":176,"props":5675,"children":5676},{"style":253},[5677],{"type":27,"value":1365},{"type":22,"tag":176,"props":5679,"children":5680},{"class":178,"line":403},[5681],{"type":22,"tag":176,"props":5682,"children":5683},{"style":749},[5684],{"type":27,"value":5575},{"type":22,"tag":23,"props":5686,"children":5687},{},[5688],{"type":27,"value":5689},"We remove texts that are too short (less than 10 characters). This helps avoid training with trivial examples.",{"type":22,"tag":5147,"props":5691,"children":5693},{"id":5692},"_7-loading-splitting-the-openwebtext-dataset",[5694],{"type":27,"value":5695},"7. Loading & Splitting the OpenWebText Dataset",{"type":22,"tag":166,"props":5697,"children":5699},{"className":235,"code":5698,"language":237,"meta":13,"style":13},"dataset = load_dataset(\"openwebtext\")\ndataset = dataset[\"train\"].train_test_split(test_size=0.1)\n",[5700],{"type":22,"tag":30,"props":5701,"children":5702},{"__ignoreMap":13},[5703,5726],{"type":22,"tag":176,"props":5704,"children":5705},{"class":178,"line":179},[5706,5710,5714,5718,5722],{"type":22,"tag":176,"props":5707,"children":5708},{"style":253},[5709],{"type":27,"value":1439},{"type":22,"tag":176,"props":5711,"children":5712},{"style":247},[5713],{"type":27,"value":431},{"type":22,"tag":176,"props":5715,"children":5716},{"style":253},[5717],{"type":27,"value":1448},{"type":22,"tag":176,"props":5719,"children":5720},{"style":189},[5721],{"type":27,"value":1453},{"type":22,"tag":176,"props":5723,"children":5724},{"style":253},[5725],{"type":27,"value":466},{"type":22,"tag":176,"props":5727,"children":5728},{"class":178,"line":259},[5729,5733,5737,5741,5745,5749,5753,5757,5761],{"type":22,"tag":176,"props":5730,"children":5731},{"style":253},[5732],{"type":27,"value":1439},{"type":22,"tag":176,"props":5734,"children":5735},{"style":247},[5736],{"type":27,"value":431},{"type":22,"tag":176,"props":5738,"children":5739},{"style":253},[5740],{"type":27,"value":1474},{"type":22,"tag":176,"props":5742,"children":5743},{"style":189},[5744],{"type":27,"value":1479},{"type":22,"tag":176,"props":5746,"children":5747},{"style":253},[5748],{"type":27,"value":1484},{"type":22,"tag":176,"props":5750,"children":5751},{"style":602},[5752],{"type":27,"value":1489},{"type":22,"tag":176,"props":5754,"children":5755},{"style":247},[5756],{"type":27,"value":431},{"type":22,"tag":176,"props":5758,"children":5759},{"style":749},[5760],{"type":27,"value":1498},{"type":22,"tag":176,"props":5762,"children":5763},{"style":253},[5764],{"type":27,"value":466},{"type":22,"tag":23,"props":5766,"children":5767},{},[5768,5770,5776],{"type":27,"value":5769},"The dataset is split into training (90%) and testing (10%). We then map our ",{"type":22,"tag":30,"props":5771,"children":5773},{"className":5772},[],[5774],{"type":27,"value":5775},"tokenize_function",{"type":27,"value":5777}," to tokenize the entire dataset.",{"type":22,"tag":5147,"props":5779,"children":5781},{"id":5780},"_8-dataloader-configuration",[5782],{"type":27,"value":5783},"8. DataLoader Configuration",{"type":22,"tag":23,"props":5785,"children":5786},{},[5787,5789,5795],{"type":27,"value":5788},"We create PyTorch DataLoaders for both training and testing, defining a custom ",{"type":22,"tag":30,"props":5790,"children":5792},{"className":5791},[],[5793],{"type":27,"value":5794},"collate_fn",{"type":27,"value":5796}," that moves tensors to the correct device:",{"type":22,"tag":166,"props":5798,"children":5800},{"className":235,"code":5799,"language":237,"meta":13,"style":13},"def collate_fn(batch):\n    ...\ntrain_loader = DataLoader(..., collate_fn=collate_fn)\n",[5801],{"type":22,"tag":30,"props":5802,"children":5803},{"__ignoreMap":13},[5804,5819,5826],{"type":22,"tag":176,"props":5805,"children":5806},{"class":178,"line":179},[5807,5811,5815],{"type":22,"tag":176,"props":5808,"children":5809},{"style":247},[5810],{"type":27,"value":906},{"type":22,"tag":176,"props":5812,"children":5813},{"style":183},[5814],{"type":27,"value":1722},{"type":22,"tag":176,"props":5816,"children":5817},{"style":253},[5818],{"type":27,"value":1727},{"type":22,"tag":176,"props":5820,"children":5821},{"class":178,"line":259},[5822],{"type":22,"tag":176,"props":5823,"children":5824},{"style":749},[5825],{"type":27,"value":5575},{"type":22,"tag":176,"props":5827,"children":5828},{"class":178,"line":272},[5829,5833,5837,5842,5847,5851,5855,5859],{"type":22,"tag":176,"props":5830,"children":5831},{"style":253},[5832],{"type":27,"value":1907},{"type":22,"tag":176,"props":5834,"children":5835},{"style":247},[5836],{"type":27,"value":431},{"type":22,"tag":176,"props":5838,"children":5839},{"style":253},[5840],{"type":27,"value":5841}," DataLoader(",{"type":22,"tag":176,"props":5843,"children":5844},{"style":749},[5845],{"type":27,"value":5846},"...",{"type":22,"tag":176,"props":5848,"children":5849},{"style":253},[5850],{"type":27,"value":2487},{"type":22,"tag":176,"props":5852,"children":5853},{"style":602},[5854],{"type":27,"value":5794},{"type":22,"tag":176,"props":5856,"children":5857},{"style":247},[5858],{"type":27,"value":431},{"type":22,"tag":176,"props":5860,"children":5861},{"style":253},[5862],{"type":27,"value":5863},"collate_fn)\n",{"type":22,"tag":5147,"props":5865,"children":5867},{"id":5866},"_9-label-smoothing",[5868],{"type":27,"value":5869},"9. Label Smoothing",{"type":22,"tag":23,"props":5871,"children":5872},{},[5873,5875,5881],{"type":27,"value":5874},"A custom class ",{"type":22,"tag":30,"props":5876,"children":5878},{"className":5877},[],[5879],{"type":27,"value":5880},"LabelSmoothingCrossEntropy",{"type":27,"value":5882}," is implemented to mitigate overconfidence in predictions. We replace the typical cross-entropy loss with label smoothing:",{"type":22,"tag":166,"props":5884,"children":5886},{"className":235,"code":5885,"language":237,"meta":13,"style":13},"class LabelSmoothingCrossEntropy(nn.Module):\n    ...\nlabel_smoothing_loss_fn = LabelSmoothingCrossEntropy(smoothing=0.1)\n",[5887],{"type":22,"tag":30,"props":5888,"children":5889},{"__ignoreMap":13},[5890,5921,5928],{"type":22,"tag":176,"props":5891,"children":5892},{"class":178,"line":179},[5893,5897,5901,5905,5909,5913,5917],{"type":22,"tag":176,"props":5894,"children":5895},{"style":247},[5896],{"type":27,"value":2129},{"type":22,"tag":176,"props":5898,"children":5899},{"style":183},[5900],{"type":27,"value":2134},{"type":22,"tag":176,"props":5902,"children":5903},{"style":253},[5904],{"type":27,"value":2139},{"type":22,"tag":176,"props":5906,"children":5907},{"style":183},[5908],{"type":27,"value":2144},{"type":22,"tag":176,"props":5910,"children":5911},{"style":253},[5912],{"type":27,"value":105},{"type":22,"tag":176,"props":5914,"children":5915},{"style":183},[5916],{"type":27,"value":2153},{"type":22,"tag":176,"props":5918,"children":5919},{"style":253},[5920],{"type":27,"value":2158},{"type":22,"tag":176,"props":5922,"children":5923},{"class":178,"line":259},[5924],{"type":22,"tag":176,"props":5925,"children":5926},{"style":749},[5927],{"type":27,"value":5575},{"type":22,"tag":176,"props":5929,"children":5930},{"class":178,"line":272},[5931,5935,5939,5943,5947,5951,5955],{"type":22,"tag":176,"props":5932,"children":5933},{"style":253},[5934],{"type":27,"value":2689},{"type":22,"tag":176,"props":5936,"children":5937},{"style":247},[5938],{"type":27,"value":431},{"type":22,"tag":176,"props":5940,"children":5941},{"style":253},[5942],{"type":27,"value":2698},{"type":22,"tag":176,"props":5944,"children":5945},{"style":602},[5946],{"type":27,"value":2703},{"type":22,"tag":176,"props":5948,"children":5949},{"style":247},[5950],{"type":27,"value":431},{"type":22,"tag":176,"props":5952,"children":5953},{"style":749},[5954],{"type":27,"value":1498},{"type":22,"tag":176,"props":5956,"children":5957},{"style":253},[5958],{"type":27,"value":466},{"type":22,"tag":5147,"props":5960,"children":5962},{"id":5961},"_10-improved-distillation-loss-function",[5963],{"type":27,"value":5964},"10. Improved Distillation Loss Function",{"type":22,"tag":23,"props":5966,"children":5967},{},[5968,5970,5976],{"type":27,"value":5969},"The ",{"type":22,"tag":30,"props":5971,"children":5973},{"className":5972},[],[5974],{"type":27,"value":5975},"distillation_loss",{"type":27,"value":5977}," function calculates:",{"type":22,"tag":39,"props":5979,"children":5980},{},[5981,5999],{"type":22,"tag":43,"props":5982,"children":5983},{},[5984,5990,5992,5998],{"type":22,"tag":5985,"props":5986,"children":5987},"strong",{},[5988],{"type":27,"value":5989},"Hard Loss",{"type":27,"value":5991},": computed via label smoothing (",{"type":22,"tag":30,"props":5993,"children":5995},{"className":5994},[],[5996],{"type":27,"value":5997},"label_smoothing_loss_fn",{"type":27,"value":2239},{"type":22,"tag":43,"props":6000,"children":6001},{},[6002,6007,6009,6015],{"type":22,"tag":5985,"props":6003,"children":6004},{},[6005],{"type":27,"value":6006},"Soft Loss",{"type":27,"value":6008},": a Kullback-Leibler divergence between teacher and student logits, scaled by a ",{"type":22,"tag":30,"props":6010,"children":6012},{"className":6011},[],[6013],{"type":27,"value":6014},"temperature",{"type":27,"value":105},{"type":22,"tag":166,"props":6017,"children":6019},{"className":235,"code":6018,"language":237,"meta":13,"style":13},"def distillation_loss(student_outputs, teacher_outputs, labels, temperature=3.0, alpha=0.7):\n    ...\n    return alpha * hard_loss + (1 - alpha) * soft_loss\n",[6020],{"type":22,"tag":30,"props":6021,"children":6022},{"__ignoreMap":13},[6023,6062,6069],{"type":22,"tag":176,"props":6024,"children":6025},{"class":178,"line":179},[6026,6030,6034,6038,6042,6046,6050,6054,6058],{"type":22,"tag":176,"props":6027,"children":6028},{"style":247},[6029],{"type":27,"value":906},{"type":22,"tag":176,"props":6031,"children":6032},{"style":183},[6033],{"type":27,"value":2761},{"type":22,"tag":176,"props":6035,"children":6036},{"style":253},[6037],{"type":27,"value":2766},{"type":22,"tag":176,"props":6039,"children":6040},{"style":247},[6041],{"type":27,"value":431},{"type":22,"tag":176,"props":6043,"children":6044},{"style":749},[6045],{"type":27,"value":2775},{"type":22,"tag":176,"props":6047,"children":6048},{"style":253},[6049],{"type":27,"value":2780},{"type":22,"tag":176,"props":6051,"children":6052},{"style":247},[6053],{"type":27,"value":431},{"type":22,"tag":176,"props":6055,"children":6056},{"style":749},[6057],{"type":27,"value":2789},{"type":22,"tag":176,"props":6059,"children":6060},{"style":253},[6061],{"type":27,"value":2158},{"type":22,"tag":176,"props":6063,"children":6064},{"class":178,"line":259},[6065],{"type":22,"tag":176,"props":6066,"children":6067},{"style":749},[6068],{"type":27,"value":5575},{"type":22,"tag":176,"props":6070,"children":6071},{"class":178,"line":272},[6072,6076,6080,6084,6088,6092,6096,6100,6104,6108,6112],{"type":22,"tag":176,"props":6073,"children":6074},{"style":247},[6075],{"type":27,"value":962},{"type":22,"tag":176,"props":6077,"children":6078},{"style":253},[6079],{"type":27,"value":3115},{"type":22,"tag":176,"props":6081,"children":6082},{"style":247},[6083],{"type":27,"value":1227},{"type":22,"tag":176,"props":6085,"children":6086},{"style":253},[6087],{"type":27,"value":3124},{"type":22,"tag":176,"props":6089,"children":6090},{"style":247},[6091],{"type":27,"value":2641},{"type":22,"tag":176,"props":6093,"children":6094},{"style":253},[6095],{"type":27,"value":2609},{"type":22,"tag":176,"props":6097,"children":6098},{"style":749},[6099],{"type":27,"value":2059},{"type":22,"tag":176,"props":6101,"children":6102},{"style":247},[6103],{"type":27,"value":2380},{"type":22,"tag":176,"props":6105,"children":6106},{"style":253},[6107],{"type":27,"value":3145},{"type":22,"tag":176,"props":6109,"children":6110},{"style":247},[6111],{"type":27,"value":1227},{"type":22,"tag":176,"props":6113,"children":6114},{"style":253},[6115],{"type":27,"value":3154},{"type":22,"tag":23,"props":6117,"children":6118},{},[6119,6121,6126],{"type":27,"value":6120},"The parameter ",{"type":22,"tag":30,"props":6122,"children":6124},{"className":6123},[],[6125],{"type":27,"value":103},{"type":27,"value":6127}," balances between hard and soft losses.",{"type":22,"tag":5147,"props":6129,"children":6131},{"id":6130},"_11-training-loop",[6132],{"type":27,"value":6133},"11. Training Loop",{"type":22,"tag":23,"props":6135,"children":6136},{},[6137,6139,6145],{"type":27,"value":6138},"We define ",{"type":22,"tag":30,"props":6140,"children":6142},{"className":6141},[],[6143],{"type":27,"value":6144},"train_student",{"type":27,"value":6146}," to run through multiple epochs of training:",{"type":22,"tag":166,"props":6148,"children":6150},{"className":235,"code":6149,"language":237,"meta":13,"style":13},"def train_student(student_model, teacher_model, train_loader, epochs=3, lr=3e-6, output_dir=\"distilled_model\"):\n    ...\n",[6151],{"type":22,"tag":30,"props":6152,"children":6153},{"__ignoreMap":13},[6154,6205],{"type":22,"tag":176,"props":6155,"children":6156},{"class":178,"line":179},[6157,6161,6165,6169,6173,6177,6181,6185,6189,6193,6197,6201],{"type":22,"tag":176,"props":6158,"children":6159},{"style":247},[6160],{"type":27,"value":906},{"type":22,"tag":176,"props":6162,"children":6163},{"style":183},[6164],{"type":27,"value":3200},{"type":22,"tag":176,"props":6166,"children":6167},{"style":253},[6168],{"type":27,"value":3205},{"type":22,"tag":176,"props":6170,"children":6171},{"style":247},[6172],{"type":27,"value":431},{"type":22,"tag":176,"props":6174,"children":6175},{"style":749},[6176],{"type":27,"value":3214},{"type":22,"tag":176,"props":6178,"children":6179},{"style":253},[6180],{"type":27,"value":3219},{"type":22,"tag":176,"props":6182,"children":6183},{"style":247},[6184],{"type":27,"value":431},{"type":22,"tag":176,"props":6186,"children":6187},{"style":749},[6188],{"type":27,"value":3228},{"type":22,"tag":176,"props":6190,"children":6191},{"style":253},[6192],{"type":27,"value":3233},{"type":22,"tag":176,"props":6194,"children":6195},{"style":247},[6196],{"type":27,"value":431},{"type":22,"tag":176,"props":6198,"children":6199},{"style":189},[6200],{"type":27,"value":3242},{"type":22,"tag":176,"props":6202,"children":6203},{"style":253},[6204],{"type":27,"value":2158},{"type":22,"tag":176,"props":6206,"children":6207},{"class":178,"line":259},[6208],{"type":22,"tag":176,"props":6209,"children":6210},{"style":749},[6211],{"type":27,"value":5575},{"type":22,"tag":23,"props":6213,"children":6214},{},[6215],{"type":27,"value":6216},"During each batch:",{"type":22,"tag":39,"props":6218,"children":6219},{},[6220,6225,6230],{"type":22,"tag":43,"props":6221,"children":6222},{},[6223],{"type":27,"value":6224},"The teacher model generates logits.",{"type":22,"tag":43,"props":6226,"children":6227},{},[6228],{"type":27,"value":6229},"The student model generates logits.",{"type":22,"tag":43,"props":6231,"children":6232},{},[6233],{"type":27,"value":6234},"We compute the distillation loss and backpropagate.",{"type":22,"tag":5147,"props":6236,"children":6238},{"id":6237},"_12-model-evaluation",[6239],{"type":27,"value":6240},"12. Model Evaluation",{"type":22,"tag":23,"props":6242,"children":6243},{},[6244],{"type":27,"value":6245},"We generate text from both teacher and student models on the test set using:",{"type":22,"tag":166,"props":6247,"children":6249},{"className":235,"code":6248,"language":237,"meta":13,"style":13},"model.generate(...)\n",[6250],{"type":22,"tag":30,"props":6251,"children":6252},{"__ignoreMap":13},[6253],{"type":22,"tag":176,"props":6254,"children":6255},{"class":178,"line":179},[6256,6261,6265],{"type":22,"tag":176,"props":6257,"children":6258},{"style":253},[6259],{"type":27,"value":6260},"model.generate(",{"type":22,"tag":176,"props":6262,"children":6263},{"style":749},[6264],{"type":27,"value":5846},{"type":22,"tag":176,"props":6266,"children":6267},{"style":253},[6268],{"type":27,"value":466},{"type":22,"tag":23,"props":6270,"children":6271},{},[6272],{"type":27,"value":6273},"We collect a few samples to compare their outputs.",{"type":22,"tag":5147,"props":6275,"children":6277},{"id":6276},"_13-running-the-training",[6278],{"type":27,"value":6279},"13. Running the Training",{"type":22,"tag":23,"props":6281,"children":6282},{},[6283,6285,6291],{"type":27,"value":6284},"Here, we call ",{"type":22,"tag":30,"props":6286,"children":6288},{"className":6287},[],[6289],{"type":27,"value":6290},"train_student(...)",{"type":27,"value":6292}," with the desired parameters:",{"type":22,"tag":166,"props":6294,"children":6296},{"className":235,"code":6295,"language":237,"meta":13,"style":13},"trained_model = train_student(\n    student_model,\n    teacher_model,\n    train_loader,\n    epochs=2, \n    lr=3e-6,\n    output_dir=output_model_dir\n)\n",[6297],{"type":22,"tag":30,"props":6298,"children":6299},{"__ignoreMap":13},[6300,6315,6322,6329,6336,6355,6374,6389],{"type":22,"tag":176,"props":6301,"children":6302},{"class":178,"line":179},[6303,6307,6311],{"type":22,"tag":176,"props":6304,"children":6305},{"style":253},[6306],{"type":27,"value":4513},{"type":22,"tag":176,"props":6308,"children":6309},{"style":247},[6310],{"type":27,"value":431},{"type":22,"tag":176,"props":6312,"children":6313},{"style":253},[6314],{"type":27,"value":4522},{"type":22,"tag":176,"props":6316,"children":6317},{"class":178,"line":259},[6318],{"type":22,"tag":176,"props":6319,"children":6320},{"style":253},[6321],{"type":27,"value":4531},{"type":22,"tag":176,"props":6323,"children":6324},{"class":178,"line":272},[6325],{"type":22,"tag":176,"props":6326,"children":6327},{"style":253},[6328],{"type":27,"value":4540},{"type":22,"tag":176,"props":6330,"children":6331},{"class":178,"line":295},[6332],{"type":22,"tag":176,"props":6333,"children":6334},{"style":253},[6335],{"type":27,"value":4549},{"type":22,"tag":176,"props":6337,"children":6338},{"class":178,"line":317},[6339,6343,6347,6351],{"type":22,"tag":176,"props":6340,"children":6341},{"style":602},[6342],{"type":27,"value":4558},{"type":22,"tag":176,"props":6344,"children":6345},{"style":247},[6346],{"type":27,"value":431},{"type":22,"tag":176,"props":6348,"children":6349},{"style":749},[6350],{"type":27,"value":4567},{"type":22,"tag":176,"props":6352,"children":6353},{"style":253},[6354],{"type":27,"value":5330},{"type":22,"tag":176,"props":6356,"children":6357},{"class":178,"line":340},[6358,6362,6366,6370],{"type":22,"tag":176,"props":6359,"children":6360},{"style":602},[6361],{"type":27,"value":4586},{"type":22,"tag":176,"props":6363,"children":6364},{"style":247},[6365],{"type":27,"value":431},{"type":22,"tag":176,"props":6367,"children":6368},{"style":749},[6369],{"type":27,"value":3228},{"type":22,"tag":176,"props":6371,"children":6372},{"style":253},[6373],{"type":27,"value":619},{"type":22,"tag":176,"props":6375,"children":6376},{"class":178,"line":362},[6377,6381,6385],{"type":22,"tag":176,"props":6378,"children":6379},{"style":602},[6380],{"type":27,"value":4607},{"type":22,"tag":176,"props":6382,"children":6383},{"style":247},[6384],{"type":27,"value":431},{"type":22,"tag":176,"props":6386,"children":6387},{"style":253},[6388],{"type":27,"value":4616},{"type":22,"tag":176,"props":6390,"children":6391},{"class":178,"line":384},[6392],{"type":22,"tag":176,"props":6393,"children":6394},{"style":253},[6395],{"type":27,"value":466},{"type":22,"tag":23,"props":6397,"children":6398},{},[6399],{"type":27,"value":6400},"Adjust epochs or learning rate as needed.",{"type":22,"tag":5147,"props":6402,"children":6404},{"id":6403},"_14-saving-the-final-model",[6405],{"type":27,"value":6406},"14. Saving the Final Model",{"type":22,"tag":23,"props":6408,"children":6409},{},[6410],{"type":27,"value":6411},"We save the student model's final state dictionary:",{"type":22,"tag":166,"props":6413,"children":6415},{"className":235,"code":6414,"language":237,"meta":13,"style":13},"torch.save(trained_model.state_dict(), os.path.join(output_model_dir, \"final_distilled_model.pt\"))\n",[6416],{"type":22,"tag":30,"props":6417,"children":6418},{"__ignoreMap":13},[6419],{"type":22,"tag":176,"props":6420,"children":6421},{"class":178,"line":179},[6422,6426,6430],{"type":22,"tag":176,"props":6423,"children":6424},{"style":253},[6425],{"type":27,"value":4666},{"type":22,"tag":176,"props":6427,"children":6428},{"style":189},[6429],{"type":27,"value":4671},{"type":22,"tag":176,"props":6431,"children":6432},{"style":253},[6433],{"type":27,"value":4676},{"type":22,"tag":5147,"props":6435,"children":6437},{"id":6436},"_15-16-comparison-and-saving-outputs",[6438],{"type":27,"value":6439},"15-16. Comparison and Saving Outputs",{"type":22,"tag":23,"props":6441,"children":6442},{},[6443],{"type":27,"value":6444},"We generate a few samples from both teacher and student and write them to a text file to visually compare performance.",{"type":22,"tag":107,"props":6446,"children":6448},{"id":6447},"conclusion",[6449],{"type":27,"value":6450},"Conclusion",{"type":22,"tag":23,"props":6452,"children":6453},{},[6454],{"type":27,"value":6455},"You have now completed a step-by-step guide for distilling a GPT model (GPT2) into a smaller student (DistilGPT2). This approach balances teacher-derived knowledge (soft labels) with the original ground truth (hard labels) to produce a more compact yet capable model.",{"type":22,"tag":23,"props":6457,"children":6458},{},[6459],{"type":27,"value":6460},"Feel free to modify:",{"type":22,"tag":114,"props":6462,"children":6463},{},[6464,6469,6474,6479],{"type":22,"tag":43,"props":6465,"children":6466},{},[6467],{"type":27,"value":6468},"The data augmentation logic.",{"type":22,"tag":43,"props":6470,"children":6471},{},[6472],{"type":27,"value":6473},"The temperature and alpha parameters in the distillation loss.",{"type":22,"tag":43,"props":6475,"children":6476},{},[6477],{"type":27,"value":6478},"The dropout rates.",{"type":22,"tag":43,"props":6480,"children":6481},{},[6482],{"type":27,"value":6483},"Other hyperparameters (batch size, learning rate, epochs, etc.).",{"type":22,"tag":23,"props":6485,"children":6486},{},[6487],{"type":27,"value":6488},"Experiment with these settings to find the best trade-off between performance and model size. Good luck distilling!",{"type":22,"tag":6490,"props":6491,"children":6492},"style",{},[6493],{"type":27,"value":6494},"html .default .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .shiki span {color: var(--shiki-default);background: var(--shiki-default-bg);font-style: var(--shiki-default-font-style);font-weight: var(--shiki-default-font-weight);text-decoration: var(--shiki-default-text-decoration);}html .dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}html.dark .shiki span {color: var(--shiki-dark);background: var(--shiki-dark-bg);font-style: var(--shiki-dark-font-style);font-weight: var(--shiki-dark-font-weight);text-decoration: var(--shiki-dark-text-decoration);}",{"title":13,"searchDepth":259,"depth":259,"links":6496},[6497,6498,6499,6516],{"id":109,"depth":259,"text":112},{"id":210,"depth":259,"text":213},{"id":5142,"depth":259,"text":5145,"children":6500},[6501,6502,6503,6504,6505,6506,6507,6508,6509,6510,6511,6512,6513,6514,6515],{"id":5149,"depth":272,"text":5152},{"id":5219,"depth":272,"text":5222},{"id":5272,"depth":272,"text":5275},{"id":5457,"depth":272,"text":5460},{"id":5526,"depth":272,"text":5529},{"id":5537,"depth":272,"text":5540},{"id":5692,"depth":272,"text":5695},{"id":5780,"depth":272,"text":5783},{"id":5866,"depth":272,"text":5869},{"id":5961,"depth":272,"text":5964},{"id":6130,"depth":272,"text":6133},{"id":6237,"depth":272,"text":6240},{"id":6276,"depth":272,"text":6279},{"id":6403,"depth":272,"text":6406},{"id":6436,"depth":272,"text":6439},{"id":6447,"depth":259,"text":6450},"markdown","content:4.tutorial-LLMs:1.Distilling GPT with PyTorch and Transformers.md","content","4.tutorial-LLMs/1.Distilling GPT with PyTorch and Transformers.md","4.tutorial-LLMs/1.Distilling GPT with PyTorch and Transformers","md","default",["ShallowRef",6525],["ShallowReactive",6526],{"/tutorial-llms/distilling-gpt-with-pytorch-and-transformers":6527},[6528,6539],{"_path":6529,"_dir":6530,"_draft":6,"_partial":6,"_locale":13,"title":6531,"description":6532,"icon":6533,"image":6534,"lastModified":6535,"_type":6517,"_id":6536,"_source":6519,"_file":6537,"_stem":6538,"_extension":6522},"/tutorial-isaaclab/enable-fluid","tutorial-isaaclab","Enabling fluid simulation","A guide to enable fluid simulation in Isaac Lab for reinforcement learning training.","material-symbols:water-drop-outline","/fluid.png","Nov 17, 2024","content:3.tutorial-isaaclab:4.enable-fluid.md","3.tutorial-isaaclab/4.enable-fluid.md","3.tutorial-isaaclab/4.enable-fluid",{"_path":6540,"_dir":6541,"_draft":6,"_partial":6,"_locale":13,"title":6542,"description":6543,"icon":6544,"lastModified":6535,"_type":6517,"_id":6545,"_source":6519,"_file":6546,"_stem":6547,"_extension":6522},"/published-research/real-time-dexterous","published-research","Real-time Dexterous Telemanipulation","Real-time Dexterous Telemanipulation with an End-Effect-Oriented Learning-based Approach","lucide:bot","content:5.published-research:1.real-time-dexterous.md","5.published-research/1.real-time-dexterous.md","5.published-research/1.real-time-dexterous",["ShallowRef",6549],{},[6551,6555,6562,6578,6583,6597,6611,6618,6621],{"title":6552,"_path":6553,"icon":6554},"Cyber Nachos","/cybernachos","lucide:hand",{"title":6556,"_path":6557,"children":6558},"Published Products","/published",[6559],{"title":6560,"_path":6561,"icon":16},"Cyber Nachos GPT","/published/cybernachos-gpt",{"title":6563,"_path":6564,"children":6565},"Tutorial Isaac Lab","/tutorial-isaaclab",[6566,6569,6573,6577],{"title":6567,"_path":6568,"icon":6544},"Introduction","/tutorial-isaaclab/introduction",{"title":6570,"_path":6571,"icon":6572},"Installation Guide","/tutorial-isaaclab/installation","lucide:download",{"title":6574,"_path":6575,"icon":6576},"Getting Started","/tutorial-isaaclab/getting-started","lucide:flag",{"title":6531,"_path":6529,"icon":6533},{"title":6579,"_path":6580,"children":6581},"Tutorial LLMs","/tutorial-llms",[6582],{"title":14,"_path":11,"icon":16},{"title":6584,"_path":6585,"children":6586},"Published Research Papers","/published-research",[6587,6588,6591,6594],{"title":6542,"_path":6540,"icon":6544},{"title":6589,"_path":6590,"icon":16},"Hallucination Prevention in LLMs","/published-research/hallucination",{"title":6592,"_path":6593,"icon":16},"AI Anchor Framework","/published-research/ai-anchor",{"title":6595,"_path":6596,"icon":16},"AI as the Cognitive Engine of Productivity","/published-research/ai-productivity",{"title":6598,"_path":6599,"children":6600},"Robotics Overview","/robotics-overview",[6601,6605,6608],{"title":6602,"_path":6603,"icon":6604},"Robotics Dataset Comparison","/robotics-overview/robotics-datasets","lucide:database",{"title":6606,"_path":6607,"icon":6544},"General-Purpose Robot Models Analysis","/robotics-overview/robotics-models",{"title":6609,"_path":6610,"icon":6544},"Wheel-Based Humanoid Robots","/robotics-overview/wheel-based-robots",{"title":6612,"_path":6613,"children":6614},"Posts","/posts",[6615],{"title":6616,"_path":6617,"icon":6544},"Robotic Sociology: Human-Robot Interaction and the Emergence of Machine Social Structures","/posts/robotic-sociology",{"title":6619,"_path":6620},"Promptrobot","/promptrobot",{"title":6622,"_path":6623},"Terms of Service & User Agreement","/terms",["Map"],{"_priority":6626,"env":6630,"name":6631,"url":6632},{"name":6627,"env":6628,"url":6629},-10,-15,-3,"production","shadcn-docs-nuxt-starter","https://cybernachos.github.io",["Set"],["ShallowReactive",6635],{"XFVaCZk9MC":6636},null,1750604158421]</script>
<script>window.__NUXT__={};window.__NUXT__.config={public:{mdc:{components:{prose:true,map:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"}},headings:{anchorLinks:{h1:false,h2:true,h3:true,h4:true,h5:false,h6:false}}},content:{locales:[],defaultLocale:"",integrity:1750604138074,experimental:{stripQueryParameters:false,advanceQuery:false,clientDB:false},respectPathCase:false,api:{baseURL:"/api/_content"},navigation:{fields:["icon","navBadges","navTruncate","badges","toc","sidebar","collapse","editLink","prevNext","breadcrumb","fullpage","layout"]},tags:{p:"prose-p",a:"prose-a",blockquote:"prose-blockquote","code-inline":"prose-code-inline",code:"ProseCodeInline",em:"prose-em",h1:"prose-h1",h2:"prose-h2",h3:"prose-h3",h4:"prose-h4",h5:"prose-h5",h6:"prose-h6",hr:"prose-hr",img:"prose-img",ul:"prose-ul",ol:"prose-ol",li:"prose-li",strong:"prose-strong",table:"prose-table",thead:"prose-thead",tbody:"prose-tbody",td:"prose-td",th:"prose-th",tr:"prose-tr"},highlight:{theme:{default:"github-light",dark:"github-dark"},preload:["json","js","ts","html","css","vue","diff","shell","markdown","mdc","yaml","bash","ini","dotenv"]},wsUrl:"",documentDriven:{page:true,navigation:true,surround:true,globals:{},layoutFallbacks:["theme"],injectPage:true},host:"",trailingSlash:false,search:{indexed:true,ignoredTags:["script","style","pre"],filterQuery:{_draft:false,_partial:false},options:{fields:["title","content","titles"],storeFields:["title","content","titles"],searchOptions:{prefix:true,fuzzy:.2,boost:{title:4,content:2,titles:1}}}},contentHead:true,anchorLinks:{depth:4,exclude:[1]}},"nuxt-scripts":{version:"",defaultScriptOptions:{trigger:"onNuxtReady"}}},app:{baseURL:"/",buildId:"24ab5227-b949-4975-8094-887b2c84ea55",buildAssetsDir:"/_nuxt/",cdnURL:""}}</script></body></html>